--- SUITE A: SMOKE TESTS ---
Running basic tests to ensure the API is online and responsive...
# Test A.1: Basic ADDITION request
{
  "success": true,
  "question": {
    "text": "Logan buys an apple for 48p and a banana for 27p. What is the total cost?",
    "options": [
      {
        "text": "0.375",
        "value": 0.38,
        "index": 0
      },
      {
        "text": "75p",
        "value": 0.75,
        "index": 1
      },
      {
        "text": "2.75",
        "value": 2.75,
        "index": 2
      },
      {
        "text": "1.75",
        "value": 1.75,
        "index": 3
      }
    ],
    "correctIndex": 1,
    "format": "DIRECT_CALCULATION",
    "difficulty": {
      "year": 1,
      "subLevel": 1,
      "displayName": "1.1",
      "cognitiveLoad": 10
    },
    "cognitiveLoad": 10,
    "curriculumTags": [
      "1N1a",
      "1N1b"
    ],
    "scenario": {
      "id": "shop-002-realistic-general",
      "theme": "SHOPPING",
      "setting": {
        "location": "local shop",
        "timeContext": "after school",
        "atmosphere": "friendly"
      },
      "characters": [
        {
          "name": "Logan",
          "role": "student"
        }
      ],
      "items": [
        {
          "name": "apple",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.2,
            "max": 0.5,
            "typical": 0.35,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "banana",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.15,
            "max": 0.4,
            "typical": 0.25,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sandwich",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 2.5,
            "max": 6,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "drink",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.8,
            "max": 2.5,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "cake",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 1.5,
            "max": 4,
            "typical": 2.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "biscuit",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.8,
            "max": 2,
            "typical": 1.2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sweet",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.1,
            "max": 1,
            "typical": 0.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "chocolate",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.6,
            "max": 3,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "pen",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.5,
            "max": 2,
            "typical": 1,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "pencil",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.2,
            "max": 1,
            "typical": 0.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "ruler",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.8,
            "max": 2.5,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "notebook",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 1,
            "max": 4,
            "typical": 2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "eraser",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.3,
            "max": 1.5,
            "typical": 0.75,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "book",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 3,
            "max": 15,
            "typical": 8,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "comic",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2,
            "max": 5,
            "typical": 3,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "magazine",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2.5,
            "max": 6,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "toy",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 5,
            "max": 25,
            "typical": 12,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "game",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 8,
            "max": 60,
            "typical": 25,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "puzzle",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 5,
            "max": 20,
            "typical": 12,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sticker",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 0.2,
            "max": 2,
            "typical": 0.8,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "badge",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 0.5,
            "max": 3,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "poster",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2,
            "max": 8,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "card",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 0.5,
            "max": 4,
            "typical": 2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        }
      ],
      "culturalElements": [
        {
          "type": "currency",
          "value": "£",
          "explanation": "British pounds"
        },
        {
          "type": "location",
          "value": "UK local shop",
          "explanation": "Typical British corner shop"
        }
      ],
      "realWorldConnection": "Everyday shopping with realistic UK prices",
      "yearAppropriate": [
        1,
        2,
        3,
        4,
        5,
        6
      ],
      "templates": [
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "MULTI_STEP"
          ],
          "modelCompatibility": [
            "ADDITION"
          ],
          "operandCount": 3,
          "template": "{character} buys {article1} {item1} for {price1}, {article2} {item2} for {price2}, and {article3} {item3} for {price3}. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item1",
              "type": "item"
            },
            {
              "key": "item2",
              "type": "item"
            },
            {
              "key": "item3",
              "type": "item"
            },
            {
              "key": "price1",
              "type": "value"
            },
            {
              "key": "price2",
              "type": "value"
            },
            {
              "key": "price3",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "MULTI_STEP"
          ],
          "modelCompatibility": [
            "ADDITION"
          ],
          "operandCount": 2,
          "template": "{character} buys {article1} {item1} for {price1} and {article2} {item2} for {price2}. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item1",
              "type": "item"
            },
            {
              "key": "item2",
              "type": "item"
            },
            {
              "key": "price1",
              "type": "value"
            },
            {
              "key": "price2",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "SUBTRACTION",
            "CHANGE_CALCULATION"
          ],
          "template": "{character} buys {article} {item} for {price} and pays with {payment}. How much change does {character} get?",
          "answerTemplate": "{character} receives {result} in change",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "payment",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "MULTIPLICATION"
          ],
          "template": "{character} buys {quantity} {item} at {price} each. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "quantity",
              "type": "value"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "DIVISION"
          ],
          "template": "{character} has {total} to spend equally on {quantity} {item}. How much can {character} spend on each one?",
          "answerTemplate": "{character} can spend {result} on each {item}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "total",
              "type": "value"
            },
            {
              "key": "quantity",
              "type": "value"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "COMPARISON",
            "ESTIMATION",
            "MULTI_STEP"
          ],
          "template": "{character} goes to the shop and buys {items}. How much does {character} spend in total?",
          "answerTemplate": "{character} spends {result} in total",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "ESTIMATION"
          ],
          "template": "Estimate: If {character} buys {items}, about how much will it cost?",
          "answerTemplate": "It will cost approximately {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "VALIDATION"
          ],
          "template": "{character} calculated that {items} costs {amount}. Is this correct?",
          "answerTemplate": "{validation_result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "amount",
              "type": "value"
            },
            {
              "key": "validation_result",
              "type": "boolean"
            }
          ]
        }
      ]
    },
    "distractors": [
      {
        "value": 1.75,
        "displayText": "1.75",
        "strategy": "CLOSE_VALUE",
        "reasoning": "Off by 1"
      },
      {
        "value": 2.75,
        "displayText": "2.75",
        "strategy": "CLOSE_VALUE",
        "reasoning": "Off by 2"
      },
      {
        "value": 0.38,
        "displayText": "0.375",
        "reasoning": "Half the correct value"
      }
    ],
    "enhancementStatus": {
      "level": "partial",
      "requestedFormat": "DIRECT_CALCULATION",
      "actualFormat": "DIRECT_CALCULATION",
      "featuresActive": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "featuresPending": [],
      "isFullyEnhanced": true
    },
    "mathOutput": {
      "operation": "ADDITION",
      "operand_1": 0.48,
      "operand_2": 0.27,
      "result": 0.75
    },
    "generationTime": 1,
    "questionId": "q_1759232460912_fs6vxoqx8",
    "generationSetup": {
      "controller_used": "DIRECT_CALCULATIONController",
      "format_requested": "DIRECT_CALCULATION",
      "format_actual": "DIRECT_CALCULATION",
      "scenario_theme": "SHOPPING",
      "scenario_id": "shop-002-realistic-general",
      "scenario_selection_method": "default",
      "distractor_strategies": [
        "CLOSE_VALUE",
        "CLOSE_VALUE",
        null
      ],
      "distractor_count": 3,
      "theme_variety": false,
      "format_variety": false,
      "enhancement_level": "partial",
      "features_active": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "features_pending": [],
      "generation_time_ms": 1
    }
  },
  "metadata": {
    "format": "DIRECT_CALCULATION",
    "cognitive_load": 10,
    "curriculum_alignment": [
      "1N1a",
      "1N1b"
    ],
    "difficulty": "1.1",
    "scenario_theme": "SHOPPING",
    "distractor_strategies": [
      "CLOSE_VALUE",
      "CLOSE_VALUE",
      null
    ],
    "generation_time_ms": 1,
    "api_version": "2.0",
    "enhancement_status": "partial",
    "format_requested": "DIRECT_CALCULATION",
    "format_used": "DIRECT_CALCULATION",
    "features_active": [
      "enhanced_distractors",
      "rich_scenarios",
      "cognitive_load",
      "advanced_formats"
    ],
    "features_pending": []
  },
  "context": {
    "id": "shop-002-realistic-general",
    "theme": "SHOPPING",
    "setting": {
      "location": "local shop",
      "timeContext": "after school",
      "atmosphere": "friendly"
    },
    "characters": [
      {
        "name": "Logan",
        "role": "student"
      }
    ],
    "items": [
      {
        "name": "apple",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.2,
          "max": 0.5,
          "typical": 0.35,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "banana",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.15,
          "max": 0.4,
          "typical": 0.25,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sandwich",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 2.5,
          "max": 6,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "drink",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.8,
          "max": 2.5,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "cake",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 1.5,
          "max": 4,
          "typical": 2.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "biscuit",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.8,
          "max": 2,
          "typical": 1.2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sweet",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.1,
          "max": 1,
          "typical": 0.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "chocolate",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.6,
          "max": 3,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "pen",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.5,
          "max": 2,
          "typical": 1,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "pencil",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.2,
          "max": 1,
          "typical": 0.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "ruler",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.8,
          "max": 2.5,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "notebook",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 1,
          "max": 4,
          "typical": 2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "eraser",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.3,
          "max": 1.5,
          "typical": 0.75,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "book",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 3,
          "max": 15,
          "typical": 8,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "comic",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2,
          "max": 5,
          "typical": 3,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "magazine",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2.5,
          "max": 6,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "toy",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 5,
          "max": 25,
          "typical": 12,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "game",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 8,
          "max": 60,
          "typical": 25,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "puzzle",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 5,
          "max": 20,
          "typical": 12,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sticker",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 0.2,
          "max": 2,
          "typical": 0.8,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "badge",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 0.5,
          "max": 3,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "poster",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2,
          "max": 8,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "card",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 0.5,
          "max": 4,
          "typical": 2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      }
    ],
    "culturalElements": [
      {
        "type": "currency",
        "value": "£",
        "explanation": "British pounds"
      },
      {
        "type": "location",
        "value": "UK local shop",
        "explanation": "Typical British corner shop"
      }
    ],
    "realWorldConnection": "Everyday shopping with realistic UK prices",
    "yearAppropriate": [
      1,
      2,
      3,
      4,
      5,
      6
    ],
    "templates": [
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "MULTI_STEP"
        ],
        "modelCompatibility": [
          "ADDITION"
        ],
        "operandCount": 3,
        "template": "{character} buys {article1} {item1} for {price1}, {article2} {item2} for {price2}, and {article3} {item3} for {price3}. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item1",
            "type": "item"
          },
          {
            "key": "item2",
            "type": "item"
          },
          {
            "key": "item3",
            "type": "item"
          },
          {
            "key": "price1",
            "type": "value"
          },
          {
            "key": "price2",
            "type": "value"
          },
          {
            "key": "price3",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "MULTI_STEP"
        ],
        "modelCompatibility": [
          "ADDITION"
        ],
        "operandCount": 2,
        "template": "{character} buys {article1} {item1} for {price1} and {article2} {item2} for {price2}. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item1",
            "type": "item"
          },
          {
            "key": "item2",
            "type": "item"
          },
          {
            "key": "price1",
            "type": "value"
          },
          {
            "key": "price2",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "SUBTRACTION",
          "CHANGE_CALCULATION"
        ],
        "template": "{character} buys {article} {item} for {price} and pays with {payment}. How much change does {character} get?",
        "answerTemplate": "{character} receives {result} in change",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "payment",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "MULTIPLICATION"
        ],
        "template": "{character} buys {quantity} {item} at {price} each. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "quantity",
            "type": "value"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "DIVISION"
        ],
        "template": "{character} has {total} to spend equally on {quantity} {item}. How much can {character} spend on each one?",
        "answerTemplate": "{character} can spend {result} on each {item}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "total",
            "type": "value"
          },
          {
            "key": "quantity",
            "type": "value"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "COMPARISON",
          "ESTIMATION",
          "MULTI_STEP"
        ],
        "template": "{character} goes to the shop and buys {items}. How much does {character} spend in total?",
        "answerTemplate": "{character} spends {result} in total",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "ESTIMATION"
        ],
        "template": "Estimate: If {character} buys {items}, about how much will it cost?",
        "answerTemplate": "It will cost approximately {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "VALIDATION"
        ],
        "template": "{character} calculated that {items} costs {amount}. Is this correct?",
        "answerTemplate": "{validation_result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "amount",
            "type": "value"
          },
          {
            "key": "validation_result",
            "type": "boolean"
          }
        ]
      }
    ]
  }
}
# Test A.2: Basic SUBTRACTION request
{
  "success": true,
  "question": {
    "text": "Logan buys an apple for 22p and pays with £2. How much change does Logan get?",
    "options": [
      {
        "text": "6",
        "value": 6,
        "index": 0
      },
      {
        "text": "£1.78",
        "value": 1.78,
        "index": 1
      },
      {
        "text": "0.78",
        "value": 0.78,
        "index": 2
      },
      {
        "text": "2.78",
        "value": 2.7800000000000002,
        "index": 3
      }
    ],
    "correctIndex": 1,
    "format": "DIRECT_CALCULATION",
    "difficulty": {
      "year": 1,
      "subLevel": 2,
      "displayName": "1.2",
      "cognitiveLoad": 15
    },
    "cognitiveLoad": 15,
    "curriculumTags": [
      "1N1c",
      "1N1d"
    ],
    "scenario": {
      "id": "shop-002-realistic-general",
      "theme": "SHOPPING",
      "setting": {
        "location": "local shop",
        "timeContext": "after school",
        "atmosphere": "friendly"
      },
      "characters": [
        {
          "name": "Logan",
          "role": "student"
        }
      ],
      "items": [
        {
          "name": "apple",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.2,
            "max": 0.5,
            "typical": 0.35,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "banana",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.15,
            "max": 0.4,
            "typical": 0.25,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sandwich",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 2.5,
            "max": 6,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "drink",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.8,
            "max": 2.5,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "cake",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 1.5,
            "max": 4,
            "typical": 2.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "biscuit",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.8,
            "max": 2,
            "typical": 1.2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sweet",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.1,
            "max": 1,
            "typical": 0.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "chocolate",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.6,
            "max": 3,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "pen",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.5,
            "max": 2,
            "typical": 1,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "pencil",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.2,
            "max": 1,
            "typical": 0.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "ruler",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.8,
            "max": 2.5,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "notebook",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 1,
            "max": 4,
            "typical": 2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "eraser",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.3,
            "max": 1.5,
            "typical": 0.75,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "book",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 3,
            "max": 15,
            "typical": 8,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "comic",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2,
            "max": 5,
            "typical": 3,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "magazine",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2.5,
            "max": 6,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "toy",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 5,
            "max": 25,
            "typical": 12,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "game",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 8,
            "max": 60,
            "typical": 25,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "puzzle",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 5,
            "max": 20,
            "typical": 12,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sticker",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 0.2,
            "max": 2,
            "typical": 0.8,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "badge",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 0.5,
            "max": 3,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "poster",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2,
            "max": 8,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "card",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 0.5,
            "max": 4,
            "typical": 2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        }
      ],
      "culturalElements": [
        {
          "type": "currency",
          "value": "£",
          "explanation": "British pounds"
        },
        {
          "type": "location",
          "value": "UK local shop",
          "explanation": "Typical British corner shop"
        }
      ],
      "realWorldConnection": "Everyday shopping with realistic UK prices",
      "yearAppropriate": [
        1,
        2,
        3,
        4,
        5,
        6
      ],
      "templates": [
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "MULTI_STEP"
          ],
          "modelCompatibility": [
            "ADDITION"
          ],
          "operandCount": 3,
          "template": "{character} buys {article1} {item1} for {price1}, {article2} {item2} for {price2}, and {article3} {item3} for {price3}. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item1",
              "type": "item"
            },
            {
              "key": "item2",
              "type": "item"
            },
            {
              "key": "item3",
              "type": "item"
            },
            {
              "key": "price1",
              "type": "value"
            },
            {
              "key": "price2",
              "type": "value"
            },
            {
              "key": "price3",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "MULTI_STEP"
          ],
          "modelCompatibility": [
            "ADDITION"
          ],
          "operandCount": 2,
          "template": "{character} buys {article1} {item1} for {price1} and {article2} {item2} for {price2}. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item1",
              "type": "item"
            },
            {
              "key": "item2",
              "type": "item"
            },
            {
              "key": "price1",
              "type": "value"
            },
            {
              "key": "price2",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "SUBTRACTION",
            "CHANGE_CALCULATION"
          ],
          "template": "{character} buys {article} {item} for {price} and pays with {payment}. How much change does {character} get?",
          "answerTemplate": "{character} receives {result} in change",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "payment",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "MULTIPLICATION"
          ],
          "template": "{character} buys {quantity} {item} at {price} each. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "quantity",
              "type": "value"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "DIVISION"
          ],
          "template": "{character} has {total} to spend equally on {quantity} {item}. How much can {character} spend on each one?",
          "answerTemplate": "{character} can spend {result} on each {item}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "total",
              "type": "value"
            },
            {
              "key": "quantity",
              "type": "value"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "COMPARISON",
            "ESTIMATION",
            "MULTI_STEP"
          ],
          "template": "{character} goes to the shop and buys {items}. How much does {character} spend in total?",
          "answerTemplate": "{character} spends {result} in total",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "ESTIMATION"
          ],
          "template": "Estimate: If {character} buys {items}, about how much will it cost?",
          "answerTemplate": "It will cost approximately {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "VALIDATION"
          ],
          "template": "{character} calculated that {items} costs {amount}. Is this correct?",
          "answerTemplate": "{validation_result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "amount",
              "type": "value"
            },
            {
              "key": "validation_result",
              "type": "boolean"
            }
          ]
        }
      ]
    },
    "distractors": [
      {
        "value": 6,
        "displayText": "6",
        "strategy": "WRONG_OPERATION",
        "reasoning": "Added instead of subtracting"
      },
      {
        "value": 2.7800000000000002,
        "displayText": "2.78",
        "strategy": "CLOSE_VALUE",
        "reasoning": "Off by 1"
      },
      {
        "value": 0.78,
        "displayText": "0.78",
        "strategy": "CLOSE_VALUE",
        "reasoning": "Off by 1"
      }
    ],
    "enhancementStatus": {
      "level": "partial",
      "requestedFormat": "DIRECT_CALCULATION",
      "actualFormat": "DIRECT_CALCULATION",
      "featuresActive": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "featuresPending": [],
      "isFullyEnhanced": true
    },
    "mathOutput": {
      "operation": "SUBTRACTION",
      "subtrahend": 0.22,
      "minuend": 2,
      "result": 1.78
    },
    "generationTime": 0,
    "questionId": "q_1759232460959_p6dn9jisp",
    "generationSetup": {
      "controller_used": "DIRECT_CALCULATIONController",
      "format_requested": "DIRECT_CALCULATION",
      "format_actual": "DIRECT_CALCULATION",
      "scenario_theme": "SHOPPING",
      "scenario_id": "shop-002-realistic-general",
      "scenario_selection_method": "default",
      "distractor_strategies": [
        "WRONG_OPERATION",
        "CLOSE_VALUE",
        "CLOSE_VALUE"
      ],
      "distractor_count": 3,
      "theme_variety": false,
      "format_variety": false,
      "enhancement_level": "partial",
      "features_active": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "features_pending": [],
      "generation_time_ms": 0
    }
  },
  "metadata": {
    "format": "DIRECT_CALCULATION",
    "cognitive_load": 15,
    "curriculum_alignment": [
      "1N1c",
      "1N1d"
    ],
    "difficulty": "1.2",
    "scenario_theme": "SHOPPING",
    "distractor_strategies": [
      "WRONG_OPERATION",
      "CLOSE_VALUE",
      "CLOSE_VALUE"
    ],
    "generation_time_ms": 1,
    "api_version": "2.0",
    "enhancement_status": "partial",
    "format_requested": "DIRECT_CALCULATION",
    "format_used": "DIRECT_CALCULATION",
    "features_active": [
      "enhanced_distractors",
      "rich_scenarios",
      "cognitive_load",
      "advanced_formats"
    ],
    "features_pending": []
  },
  "context": {
    "id": "shop-002-realistic-general",
    "theme": "SHOPPING",
    "setting": {
      "location": "local shop",
      "timeContext": "after school",
      "atmosphere": "friendly"
    },
    "characters": [
      {
        "name": "Logan",
        "role": "student"
      }
    ],
    "items": [
      {
        "name": "apple",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.2,
          "max": 0.5,
          "typical": 0.35,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "banana",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.15,
          "max": 0.4,
          "typical": 0.25,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sandwich",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 2.5,
          "max": 6,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "drink",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.8,
          "max": 2.5,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "cake",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 1.5,
          "max": 4,
          "typical": 2.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "biscuit",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.8,
          "max": 2,
          "typical": 1.2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sweet",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.1,
          "max": 1,
          "typical": 0.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "chocolate",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.6,
          "max": 3,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "pen",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.5,
          "max": 2,
          "typical": 1,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "pencil",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.2,
          "max": 1,
          "typical": 0.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "ruler",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.8,
          "max": 2.5,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "notebook",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 1,
          "max": 4,
          "typical": 2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "eraser",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.3,
          "max": 1.5,
          "typical": 0.75,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "book",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 3,
          "max": 15,
          "typical": 8,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "comic",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2,
          "max": 5,
          "typical": 3,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "magazine",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2.5,
          "max": 6,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "toy",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 5,
          "max": 25,
          "typical": 12,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "game",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 8,
          "max": 60,
          "typical": 25,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "puzzle",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 5,
          "max": 20,
          "typical": 12,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sticker",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 0.2,
          "max": 2,
          "typical": 0.8,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "badge",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 0.5,
          "max": 3,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "poster",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2,
          "max": 8,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "card",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 0.5,
          "max": 4,
          "typical": 2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      }
    ],
    "culturalElements": [
      {
        "type": "currency",
        "value": "£",
        "explanation": "British pounds"
      },
      {
        "type": "location",
        "value": "UK local shop",
        "explanation": "Typical British corner shop"
      }
    ],
    "realWorldConnection": "Everyday shopping with realistic UK prices",
    "yearAppropriate": [
      1,
      2,
      3,
      4,
      5,
      6
    ],
    "templates": [
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "MULTI_STEP"
        ],
        "modelCompatibility": [
          "ADDITION"
        ],
        "operandCount": 3,
        "template": "{character} buys {article1} {item1} for {price1}, {article2} {item2} for {price2}, and {article3} {item3} for {price3}. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item1",
            "type": "item"
          },
          {
            "key": "item2",
            "type": "item"
          },
          {
            "key": "item3",
            "type": "item"
          },
          {
            "key": "price1",
            "type": "value"
          },
          {
            "key": "price2",
            "type": "value"
          },
          {
            "key": "price3",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "MULTI_STEP"
        ],
        "modelCompatibility": [
          "ADDITION"
        ],
        "operandCount": 2,
        "template": "{character} buys {article1} {item1} for {price1} and {article2} {item2} for {price2}. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item1",
            "type": "item"
          },
          {
            "key": "item2",
            "type": "item"
          },
          {
            "key": "price1",
            "type": "value"
          },
          {
            "key": "price2",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "SUBTRACTION",
          "CHANGE_CALCULATION"
        ],
        "template": "{character} buys {article} {item} for {price} and pays with {payment}. How much change does {character} get?",
        "answerTemplate": "{character} receives {result} in change",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "payment",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "MULTIPLICATION"
        ],
        "template": "{character} buys {quantity} {item} at {price} each. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "quantity",
            "type": "value"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "DIVISION"
        ],
        "template": "{character} has {total} to spend equally on {quantity} {item}. How much can {character} spend on each one?",
        "answerTemplate": "{character} can spend {result} on each {item}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "total",
            "type": "value"
          },
          {
            "key": "quantity",
            "type": "value"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "COMPARISON",
          "ESTIMATION",
          "MULTI_STEP"
        ],
        "template": "{character} goes to the shop and buys {items}. How much does {character} spend in total?",
        "answerTemplate": "{character} spends {result} in total",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "ESTIMATION"
        ],
        "template": "Estimate: If {character} buys {items}, about how much will it cost?",
        "answerTemplate": "It will cost approximately {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "VALIDATION"
        ],
        "template": "{character} calculated that {items} costs {amount}. Is this correct?",
        "answerTemplate": "{validation_result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "amount",
            "type": "value"
          },
          {
            "key": "validation_result",
            "type": "boolean"
          }
        ]
      }
    ]
  }
}

--- SUITE B: MODEL COVERAGE TESTS ---
Testing every mathematical model to ensure basic generation and catch crashes...
# Test B.1: ADDITION model
{
  "success": true,
  "question": {
    "text": "Logan buys an apple for 50p, a banana for 25p, and a sandwich for £5.48. What is the total cost?",
    "options": [
      {
        "text": "0.25",
        "value": 0.25,
        "index": 0
      },
      {
        "text": "0.13",
        "value": 0.13,
        "index": 1
      },
      {
        "text": "£6.23",
        "value": 6.23,
        "index": 2
      },
      {
        "text": "0.75",
        "value": 0.75,
        "index": 3
      }
    ],
    "correctIndex": 2,
    "format": "DIRECT_CALCULATION",
    "difficulty": {
      "year": 4,
      "subLevel": 1,
      "displayName": "4.1",
      "cognitiveLoad": 40
    },
    "cognitiveLoad": 40,
    "curriculumTags": [
      "4N1a",
      "4N1b"
    ],
    "scenario": {
      "id": "shop-002-realistic-general",
      "theme": "SHOPPING",
      "setting": {
        "location": "local shop",
        "timeContext": "after school",
        "atmosphere": "friendly"
      },
      "characters": [
        {
          "name": "Logan",
          "role": "student"
        }
      ],
      "items": [
        {
          "name": "apple",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.2,
            "max": 0.5,
            "typical": 0.35,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "banana",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.15,
            "max": 0.4,
            "typical": 0.25,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sandwich",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 2.5,
            "max": 6,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "drink",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.8,
            "max": 2.5,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "cake",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 1.5,
            "max": 4,
            "typical": 2.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "biscuit",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.8,
            "max": 2,
            "typical": 1.2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sweet",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.1,
            "max": 1,
            "typical": 0.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "chocolate",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.6,
            "max": 3,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "pen",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.5,
            "max": 2,
            "typical": 1,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "pencil",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.2,
            "max": 1,
            "typical": 0.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "ruler",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.8,
            "max": 2.5,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "notebook",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 1,
            "max": 4,
            "typical": 2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "eraser",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.3,
            "max": 1.5,
            "typical": 0.75,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "book",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 3,
            "max": 15,
            "typical": 8,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "comic",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2,
            "max": 5,
            "typical": 3,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "magazine",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2.5,
            "max": 6,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "toy",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 5,
            "max": 25,
            "typical": 12,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "game",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 8,
            "max": 60,
            "typical": 25,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "puzzle",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 5,
            "max": 20,
            "typical": 12,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sticker",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 0.2,
            "max": 2,
            "typical": 0.8,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "badge",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 0.5,
            "max": 3,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "poster",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2,
            "max": 8,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "card",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 0.5,
            "max": 4,
            "typical": 2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        }
      ],
      "culturalElements": [
        {
          "type": "currency",
          "value": "£",
          "explanation": "British pounds"
        },
        {
          "type": "location",
          "value": "UK local shop",
          "explanation": "Typical British corner shop"
        }
      ],
      "realWorldConnection": "Everyday shopping with realistic UK prices",
      "yearAppropriate": [
        1,
        2,
        3,
        4,
        5,
        6
      ],
      "templates": [
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "MULTI_STEP"
          ],
          "modelCompatibility": [
            "ADDITION"
          ],
          "operandCount": 3,
          "template": "{character} buys {article1} {item1} for {price1}, {article2} {item2} for {price2}, and {article3} {item3} for {price3}. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item1",
              "type": "item"
            },
            {
              "key": "item2",
              "type": "item"
            },
            {
              "key": "item3",
              "type": "item"
            },
            {
              "key": "price1",
              "type": "value"
            },
            {
              "key": "price2",
              "type": "value"
            },
            {
              "key": "price3",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "MULTI_STEP"
          ],
          "modelCompatibility": [
            "ADDITION"
          ],
          "operandCount": 2,
          "template": "{character} buys {article1} {item1} for {price1} and {article2} {item2} for {price2}. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item1",
              "type": "item"
            },
            {
              "key": "item2",
              "type": "item"
            },
            {
              "key": "price1",
              "type": "value"
            },
            {
              "key": "price2",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "SUBTRACTION",
            "CHANGE_CALCULATION"
          ],
          "template": "{character} buys {article} {item} for {price} and pays with {payment}. How much change does {character} get?",
          "answerTemplate": "{character} receives {result} in change",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "payment",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "MULTIPLICATION"
          ],
          "template": "{character} buys {quantity} {item} at {price} each. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "quantity",
              "type": "value"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "DIVISION"
          ],
          "template": "{character} has {total} to spend equally on {quantity} {item}. How much can {character} spend on each one?",
          "answerTemplate": "{character} can spend {result} on each {item}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "total",
              "type": "value"
            },
            {
              "key": "quantity",
              "type": "value"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "COMPARISON",
            "ESTIMATION",
            "MULTI_STEP"
          ],
          "template": "{character} goes to the shop and buys {items}. How much does {character} spend in total?",
          "answerTemplate": "{character} spends {result} in total",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "ESTIMATION"
          ],
          "template": "Estimate: If {character} buys {items}, about how much will it cost?",
          "answerTemplate": "It will cost approximately {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "VALIDATION"
          ],
          "template": "{character} calculated that {items} costs {amount}. Is this correct?",
          "answerTemplate": "{validation_result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "amount",
              "type": "value"
            },
            {
              "key": "validation_result",
              "type": "boolean"
            }
          ]
        }
      ]
    },
    "distractors": [
      {
        "value": 0.25,
        "displayText": "0.25",
        "strategy": "WRONG_OPERATION",
        "reasoning": "Subtracted instead of adding"
      },
      {
        "value": 0.13,
        "displayText": "0.13",
        "strategy": "WRONG_OPERATION",
        "reasoning": "Multiplied instead of adding"
      },
      {
        "value": 0.75,
        "displayText": "0.75",
        "strategy": "PARTIAL_CALCULATION",
        "reasoning": "Stopped calculation early"
      }
    ],
    "enhancementStatus": {
      "level": "partial",
      "requestedFormat": "DIRECT_CALCULATION",
      "actualFormat": "DIRECT_CALCULATION",
      "featuresActive": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "featuresPending": [],
      "isFullyEnhanced": true
    },
    "mathOutput": {
      "operation": "ADDITION",
      "operand_1": 0.5,
      "operand_2": 0.25,
      "operand_3": 5.48,
      "result": 6.23
    },
    "generationTime": 0,
    "questionId": "q_1759232461001_19vy7rqj3",
    "generationSetup": {
      "controller_used": "DIRECT_CALCULATIONController",
      "format_requested": "DIRECT_CALCULATION",
      "format_actual": "DIRECT_CALCULATION",
      "scenario_theme": "SHOPPING",
      "scenario_id": "shop-002-realistic-general",
      "scenario_selection_method": "default",
      "distractor_strategies": [
        "WRONG_OPERATION",
        "WRONG_OPERATION",
        "PARTIAL_CALCULATION"
      ],
      "distractor_count": 3,
      "theme_variety": false,
      "format_variety": false,
      "enhancement_level": "partial",
      "features_active": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "features_pending": [],
      "generation_time_ms": 0
    }
  },
  "metadata": {
    "format": "DIRECT_CALCULATION",
    "cognitive_load": 40,
    "curriculum_alignment": [
      "4N1a",
      "4N1b"
    ],
    "difficulty": "4.1",
    "scenario_theme": "SHOPPING",
    "distractor_strategies": [
      "WRONG_OPERATION",
      "WRONG_OPERATION",
      "PARTIAL_CALCULATION"
    ],
    "generation_time_ms": 0,
    "api_version": "2.0",
    "enhancement_status": "partial",
    "format_requested": "DIRECT_CALCULATION",
    "format_used": "DIRECT_CALCULATION",
    "features_active": [
      "enhanced_distractors",
      "rich_scenarios",
      "cognitive_load",
      "advanced_formats"
    ],
    "features_pending": []
  },
  "context": {
    "id": "shop-002-realistic-general",
    "theme": "SHOPPING",
    "setting": {
      "location": "local shop",
      "timeContext": "after school",
      "atmosphere": "friendly"
    },
    "characters": [
      {
        "name": "Logan",
        "role": "student"
      }
    ],
    "items": [
      {
        "name": "apple",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.2,
          "max": 0.5,
          "typical": 0.35,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "banana",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.15,
          "max": 0.4,
          "typical": 0.25,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sandwich",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 2.5,
          "max": 6,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "drink",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.8,
          "max": 2.5,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "cake",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 1.5,
          "max": 4,
          "typical": 2.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "biscuit",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.8,
          "max": 2,
          "typical": 1.2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sweet",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.1,
          "max": 1,
          "typical": 0.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "chocolate",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.6,
          "max": 3,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "pen",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.5,
          "max": 2,
          "typical": 1,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "pencil",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.2,
          "max": 1,
          "typical": 0.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "ruler",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.8,
          "max": 2.5,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "notebook",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 1,
          "max": 4,
          "typical": 2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "eraser",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.3,
          "max": 1.5,
          "typical": 0.75,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "book",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 3,
          "max": 15,
          "typical": 8,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "comic",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2,
          "max": 5,
          "typical": 3,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "magazine",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2.5,
          "max": 6,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "toy",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 5,
          "max": 25,
          "typical": 12,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "game",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 8,
          "max": 60,
          "typical": 25,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "puzzle",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 5,
          "max": 20,
          "typical": 12,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sticker",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 0.2,
          "max": 2,
          "typical": 0.8,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "badge",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 0.5,
          "max": 3,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "poster",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2,
          "max": 8,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "card",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 0.5,
          "max": 4,
          "typical": 2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      }
    ],
    "culturalElements": [
      {
        "type": "currency",
        "value": "£",
        "explanation": "British pounds"
      },
      {
        "type": "location",
        "value": "UK local shop",
        "explanation": "Typical British corner shop"
      }
    ],
    "realWorldConnection": "Everyday shopping with realistic UK prices",
    "yearAppropriate": [
      1,
      2,
      3,
      4,
      5,
      6
    ],
    "templates": [
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "MULTI_STEP"
        ],
        "modelCompatibility": [
          "ADDITION"
        ],
        "operandCount": 3,
        "template": "{character} buys {article1} {item1} for {price1}, {article2} {item2} for {price2}, and {article3} {item3} for {price3}. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item1",
            "type": "item"
          },
          {
            "key": "item2",
            "type": "item"
          },
          {
            "key": "item3",
            "type": "item"
          },
          {
            "key": "price1",
            "type": "value"
          },
          {
            "key": "price2",
            "type": "value"
          },
          {
            "key": "price3",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "MULTI_STEP"
        ],
        "modelCompatibility": [
          "ADDITION"
        ],
        "operandCount": 2,
        "template": "{character} buys {article1} {item1} for {price1} and {article2} {item2} for {price2}. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item1",
            "type": "item"
          },
          {
            "key": "item2",
            "type": "item"
          },
          {
            "key": "price1",
            "type": "value"
          },
          {
            "key": "price2",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "SUBTRACTION",
          "CHANGE_CALCULATION"
        ],
        "template": "{character} buys {article} {item} for {price} and pays with {payment}. How much change does {character} get?",
        "answerTemplate": "{character} receives {result} in change",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "payment",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "MULTIPLICATION"
        ],
        "template": "{character} buys {quantity} {item} at {price} each. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "quantity",
            "type": "value"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "DIVISION"
        ],
        "template": "{character} has {total} to spend equally on {quantity} {item}. How much can {character} spend on each one?",
        "answerTemplate": "{character} can spend {result} on each {item}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "total",
            "type": "value"
          },
          {
            "key": "quantity",
            "type": "value"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "COMPARISON",
          "ESTIMATION",
          "MULTI_STEP"
        ],
        "template": "{character} goes to the shop and buys {items}. How much does {character} spend in total?",
        "answerTemplate": "{character} spends {result} in total",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "ESTIMATION"
        ],
        "template": "Estimate: If {character} buys {items}, about how much will it cost?",
        "answerTemplate": "It will cost approximately {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "VALIDATION"
        ],
        "template": "{character} calculated that {items} costs {amount}. Is this correct?",
        "answerTemplate": "{validation_result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "amount",
            "type": "value"
          },
          {
            "key": "validation_result",
            "type": "boolean"
          }
        ]
      }
    ]
  }
}
# Test B.2: SUBTRACTION model
{
  "success": true,
  "question": {
    "text": "Logan buys an apple for 44p and pays with £2. How much change does Logan get?",
    "options": [
      {
        "text": "2.56",
        "value": 2.56,
        "index": 0
      },
      {
        "text": "£1.56",
        "value": 1.56,
        "index": 1
      },
      {
        "text": "0.56",
        "value": 0.56,
        "index": 2
      },
      {
        "text": "187",
        "value": 187,
        "index": 3
      }
    ],
    "correctIndex": 1,
    "format": "DIRECT_CALCULATION",
    "difficulty": {
      "year": 4,
      "subLevel": 1,
      "displayName": "4.1",
      "cognitiveLoad": 40
    },
    "cognitiveLoad": 40,
    "curriculumTags": [
      "4N1c",
      "4N1d"
    ],
    "scenario": {
      "id": "shop-002-realistic-general",
      "theme": "SHOPPING",
      "setting": {
        "location": "local shop",
        "timeContext": "after school",
        "atmosphere": "friendly"
      },
      "characters": [
        {
          "name": "Logan",
          "role": "student"
        }
      ],
      "items": [
        {
          "name": "apple",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.2,
            "max": 0.5,
            "typical": 0.35,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "banana",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.15,
            "max": 0.4,
            "typical": 0.25,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sandwich",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 2.5,
            "max": 6,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "drink",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.8,
            "max": 2.5,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "cake",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 1.5,
            "max": 4,
            "typical": 2.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "biscuit",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.8,
            "max": 2,
            "typical": 1.2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sweet",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.1,
            "max": 1,
            "typical": 0.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "chocolate",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.6,
            "max": 3,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "pen",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.5,
            "max": 2,
            "typical": 1,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "pencil",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.2,
            "max": 1,
            "typical": 0.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "ruler",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.8,
            "max": 2.5,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "notebook",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 1,
            "max": 4,
            "typical": 2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "eraser",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.3,
            "max": 1.5,
            "typical": 0.75,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "book",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 3,
            "max": 15,
            "typical": 8,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "comic",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2,
            "max": 5,
            "typical": 3,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "magazine",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2.5,
            "max": 6,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "toy",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 5,
            "max": 25,
            "typical": 12,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "game",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 8,
            "max": 60,
            "typical": 25,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "puzzle",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 5,
            "max": 20,
            "typical": 12,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sticker",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 0.2,
            "max": 2,
            "typical": 0.8,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "badge",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 0.5,
            "max": 3,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "poster",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2,
            "max": 8,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "card",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 0.5,
            "max": 4,
            "typical": 2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        }
      ],
      "culturalElements": [
        {
          "type": "currency",
          "value": "£",
          "explanation": "British pounds"
        },
        {
          "type": "location",
          "value": "UK local shop",
          "explanation": "Typical British corner shop"
        }
      ],
      "realWorldConnection": "Everyday shopping with realistic UK prices",
      "yearAppropriate": [
        1,
        2,
        3,
        4,
        5,
        6
      ],
      "templates": [
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "MULTI_STEP"
          ],
          "modelCompatibility": [
            "ADDITION"
          ],
          "operandCount": 3,
          "template": "{character} buys {article1} {item1} for {price1}, {article2} {item2} for {price2}, and {article3} {item3} for {price3}. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item1",
              "type": "item"
            },
            {
              "key": "item2",
              "type": "item"
            },
            {
              "key": "item3",
              "type": "item"
            },
            {
              "key": "price1",
              "type": "value"
            },
            {
              "key": "price2",
              "type": "value"
            },
            {
              "key": "price3",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "MULTI_STEP"
          ],
          "modelCompatibility": [
            "ADDITION"
          ],
          "operandCount": 2,
          "template": "{character} buys {article1} {item1} for {price1} and {article2} {item2} for {price2}. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item1",
              "type": "item"
            },
            {
              "key": "item2",
              "type": "item"
            },
            {
              "key": "price1",
              "type": "value"
            },
            {
              "key": "price2",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "SUBTRACTION",
            "CHANGE_CALCULATION"
          ],
          "template": "{character} buys {article} {item} for {price} and pays with {payment}. How much change does {character} get?",
          "answerTemplate": "{character} receives {result} in change",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "payment",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "MULTIPLICATION"
          ],
          "template": "{character} buys {quantity} {item} at {price} each. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "quantity",
              "type": "value"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "DIVISION"
          ],
          "template": "{character} has {total} to spend equally on {quantity} {item}. How much can {character} spend on each one?",
          "answerTemplate": "{character} can spend {result} on each {item}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "total",
              "type": "value"
            },
            {
              "key": "quantity",
              "type": "value"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "COMPARISON",
            "ESTIMATION",
            "MULTI_STEP"
          ],
          "template": "{character} goes to the shop and buys {items}. How much does {character} spend in total?",
          "answerTemplate": "{character} spends {result} in total",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "ESTIMATION"
          ],
          "template": "Estimate: If {character} buys {items}, about how much will it cost?",
          "answerTemplate": "It will cost approximately {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "VALIDATION"
          ],
          "template": "{character} calculated that {items} costs {amount}. Is this correct?",
          "answerTemplate": "{validation_result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "amount",
              "type": "value"
            },
            {
              "key": "validation_result",
              "type": "boolean"
            }
          ]
        }
      ]
    },
    "distractors": [
      {
        "value": 187,
        "displayText": "187",
        "strategy": "WRONG_OPERATION",
        "reasoning": "Added instead of subtracting"
      },
      {
        "value": 2.56,
        "displayText": "2.56",
        "strategy": "CLOSE_VALUE",
        "reasoning": "Off by 1"
      },
      {
        "value": 0.56,
        "displayText": "0.56",
        "strategy": "CLOSE_VALUE",
        "reasoning": "Off by 1"
      }
    ],
    "enhancementStatus": {
      "level": "partial",
      "requestedFormat": "DIRECT_CALCULATION",
      "actualFormat": "DIRECT_CALCULATION",
      "featuresActive": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "featuresPending": [],
      "isFullyEnhanced": true
    },
    "mathOutput": {
      "operation": "SUBTRACTION",
      "subtrahend": 0.44,
      "minuend": 2,
      "result": 1.56
    },
    "generationTime": 1,
    "questionId": "q_1759232461046_dsbaj75f9",
    "generationSetup": {
      "controller_used": "DIRECT_CALCULATIONController",
      "format_requested": "DIRECT_CALCULATION",
      "format_actual": "DIRECT_CALCULATION",
      "scenario_theme": "SHOPPING",
      "scenario_id": "shop-002-realistic-general",
      "scenario_selection_method": "default",
      "distractor_strategies": [
        "WRONG_OPERATION",
        "CLOSE_VALUE",
        "CLOSE_VALUE"
      ],
      "distractor_count": 3,
      "theme_variety": false,
      "format_variety": false,
      "enhancement_level": "partial",
      "features_active": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "features_pending": [],
      "generation_time_ms": 1
    }
  },
  "metadata": {
    "format": "DIRECT_CALCULATION",
    "cognitive_load": 40,
    "curriculum_alignment": [
      "4N1c",
      "4N1d"
    ],
    "difficulty": "4.1",
    "scenario_theme": "SHOPPING",
    "distractor_strategies": [
      "WRONG_OPERATION",
      "CLOSE_VALUE",
      "CLOSE_VALUE"
    ],
    "generation_time_ms": 1,
    "api_version": "2.0",
    "enhancement_status": "partial",
    "format_requested": "DIRECT_CALCULATION",
    "format_used": "DIRECT_CALCULATION",
    "features_active": [
      "enhanced_distractors",
      "rich_scenarios",
      "cognitive_load",
      "advanced_formats"
    ],
    "features_pending": []
  },
  "context": {
    "id": "shop-002-realistic-general",
    "theme": "SHOPPING",
    "setting": {
      "location": "local shop",
      "timeContext": "after school",
      "atmosphere": "friendly"
    },
    "characters": [
      {
        "name": "Logan",
        "role": "student"
      }
    ],
    "items": [
      {
        "name": "apple",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.2,
          "max": 0.5,
          "typical": 0.35,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "banana",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.15,
          "max": 0.4,
          "typical": 0.25,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sandwich",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 2.5,
          "max": 6,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "drink",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.8,
          "max": 2.5,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "cake",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 1.5,
          "max": 4,
          "typical": 2.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "biscuit",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.8,
          "max": 2,
          "typical": 1.2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sweet",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.1,
          "max": 1,
          "typical": 0.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "chocolate",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.6,
          "max": 3,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "pen",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.5,
          "max": 2,
          "typical": 1,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "pencil",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.2,
          "max": 1,
          "typical": 0.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "ruler",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.8,
          "max": 2.5,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "notebook",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 1,
          "max": 4,
          "typical": 2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "eraser",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.3,
          "max": 1.5,
          "typical": 0.75,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "book",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 3,
          "max": 15,
          "typical": 8,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "comic",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2,
          "max": 5,
          "typical": 3,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "magazine",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2.5,
          "max": 6,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "toy",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 5,
          "max": 25,
          "typical": 12,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "game",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 8,
          "max": 60,
          "typical": 25,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "puzzle",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 5,
          "max": 20,
          "typical": 12,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sticker",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 0.2,
          "max": 2,
          "typical": 0.8,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "badge",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 0.5,
          "max": 3,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "poster",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2,
          "max": 8,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "card",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 0.5,
          "max": 4,
          "typical": 2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      }
    ],
    "culturalElements": [
      {
        "type": "currency",
        "value": "£",
        "explanation": "British pounds"
      },
      {
        "type": "location",
        "value": "UK local shop",
        "explanation": "Typical British corner shop"
      }
    ],
    "realWorldConnection": "Everyday shopping with realistic UK prices",
    "yearAppropriate": [
      1,
      2,
      3,
      4,
      5,
      6
    ],
    "templates": [
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "MULTI_STEP"
        ],
        "modelCompatibility": [
          "ADDITION"
        ],
        "operandCount": 3,
        "template": "{character} buys {article1} {item1} for {price1}, {article2} {item2} for {price2}, and {article3} {item3} for {price3}. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item1",
            "type": "item"
          },
          {
            "key": "item2",
            "type": "item"
          },
          {
            "key": "item3",
            "type": "item"
          },
          {
            "key": "price1",
            "type": "value"
          },
          {
            "key": "price2",
            "type": "value"
          },
          {
            "key": "price3",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "MULTI_STEP"
        ],
        "modelCompatibility": [
          "ADDITION"
        ],
        "operandCount": 2,
        "template": "{character} buys {article1} {item1} for {price1} and {article2} {item2} for {price2}. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item1",
            "type": "item"
          },
          {
            "key": "item2",
            "type": "item"
          },
          {
            "key": "price1",
            "type": "value"
          },
          {
            "key": "price2",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "SUBTRACTION",
          "CHANGE_CALCULATION"
        ],
        "template": "{character} buys {article} {item} for {price} and pays with {payment}. How much change does {character} get?",
        "answerTemplate": "{character} receives {result} in change",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "payment",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "MULTIPLICATION"
        ],
        "template": "{character} buys {quantity} {item} at {price} each. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "quantity",
            "type": "value"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "DIVISION"
        ],
        "template": "{character} has {total} to spend equally on {quantity} {item}. How much can {character} spend on each one?",
        "answerTemplate": "{character} can spend {result} on each {item}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "total",
            "type": "value"
          },
          {
            "key": "quantity",
            "type": "value"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "COMPARISON",
          "ESTIMATION",
          "MULTI_STEP"
        ],
        "template": "{character} goes to the shop and buys {items}. How much does {character} spend in total?",
        "answerTemplate": "{character} spends {result} in total",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "ESTIMATION"
        ],
        "template": "Estimate: If {character} buys {items}, about how much will it cost?",
        "answerTemplate": "It will cost approximately {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "VALIDATION"
        ],
        "template": "{character} calculated that {items} costs {amount}. Is this correct?",
        "answerTemplate": "{validation_result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "amount",
            "type": "value"
          },
          {
            "key": "validation_result",
            "type": "boolean"
          }
        ]
      }
    ]
  }
}
# Test B.3: MULTIPLICATION model
{
  "success": true,
  "question": {
    "text": "Logan is working on this equation: 18 × 1 = ?. What number should replace the ? to make this equation true?",
    "options": [
      {
        "text": "18",
        "value": 18,
        "index": 0
      },
      {
        "text": "23",
        "value": 23,
        "index": 1
      },
      {
        "text": "20",
        "value": 20,
        "index": 2
      },
      {
        "text": "20",
        "value": 20,
        "index": 3
      }
    ],
    "correctIndex": 0,
    "questionContent": {
      "fullText": "Logan is working on this equation: 18 × 1 = ?. What number should replace the ? to make this equation true?"
    },
    "format": "MISSING_VALUE",
    "difficulty": {
      "year": 4,
      "subLevel": 1,
      "displayName": "4.1",
      "cognitiveLoad": 40
    },
    "cognitiveLoad": 40,
    "curriculumTags": [
      "4N1a"
    ],
    "scenario": {
      "id": "shop-002-realistic-general",
      "theme": "SHOPPING",
      "setting": {
        "location": "local shop",
        "timeContext": "after school",
        "atmosphere": "friendly"
      },
      "characters": [
        {
          "name": "Logan",
          "role": "student"
        }
      ],
      "items": [
        {
          "name": "apple",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.2,
            "max": 0.5,
            "typical": 0.35,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "banana",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.15,
            "max": 0.4,
            "typical": 0.25,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sandwich",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 2.5,
            "max": 6,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "drink",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.8,
            "max": 2.5,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "cake",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 1.5,
            "max": 4,
            "typical": 2.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "biscuit",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.8,
            "max": 2,
            "typical": 1.2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sweet",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.1,
            "max": 1,
            "typical": 0.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "chocolate",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.6,
            "max": 3,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "pen",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.5,
            "max": 2,
            "typical": 1,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "pencil",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.2,
            "max": 1,
            "typical": 0.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "ruler",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.8,
            "max": 2.5,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "notebook",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 1,
            "max": 4,
            "typical": 2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "eraser",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.3,
            "max": 1.5,
            "typical": 0.75,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "book",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 3,
            "max": 15,
            "typical": 8,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "comic",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2,
            "max": 5,
            "typical": 3,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "magazine",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2.5,
            "max": 6,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "toy",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 5,
            "max": 25,
            "typical": 12,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "game",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 8,
            "max": 60,
            "typical": 25,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "puzzle",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 5,
            "max": 20,
            "typical": 12,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sticker",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 0.2,
            "max": 2,
            "typical": 0.8,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "badge",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 0.5,
            "max": 3,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "poster",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2,
            "max": 8,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "card",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 0.5,
            "max": 4,
            "typical": 2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        }
      ],
      "culturalElements": [
        {
          "type": "currency",
          "value": "£",
          "explanation": "British pounds"
        },
        {
          "type": "location",
          "value": "UK local shop",
          "explanation": "Typical British corner shop"
        }
      ],
      "realWorldConnection": "Everyday shopping with realistic UK prices",
      "yearAppropriate": [
        1,
        2,
        3,
        4,
        5,
        6
      ],
      "templates": [
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "MULTI_STEP"
          ],
          "modelCompatibility": [
            "ADDITION"
          ],
          "operandCount": 3,
          "template": "{character} buys {article1} {item1} for {price1}, {article2} {item2} for {price2}, and {article3} {item3} for {price3}. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item1",
              "type": "item"
            },
            {
              "key": "item2",
              "type": "item"
            },
            {
              "key": "item3",
              "type": "item"
            },
            {
              "key": "price1",
              "type": "value"
            },
            {
              "key": "price2",
              "type": "value"
            },
            {
              "key": "price3",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "MULTI_STEP"
          ],
          "modelCompatibility": [
            "ADDITION"
          ],
          "operandCount": 2,
          "template": "{character} buys {article1} {item1} for {price1} and {article2} {item2} for {price2}. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item1",
              "type": "item"
            },
            {
              "key": "item2",
              "type": "item"
            },
            {
              "key": "price1",
              "type": "value"
            },
            {
              "key": "price2",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "SUBTRACTION",
            "CHANGE_CALCULATION"
          ],
          "template": "{character} buys {article} {item} for {price} and pays with {payment}. How much change does {character} get?",
          "answerTemplate": "{character} receives {result} in change",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "payment",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "MULTIPLICATION"
          ],
          "template": "{character} buys {quantity} {item} at {price} each. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "quantity",
              "type": "value"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "DIVISION"
          ],
          "template": "{character} has {total} to spend equally on {quantity} {item}. How much can {character} spend on each one?",
          "answerTemplate": "{character} can spend {result} on each {item}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "total",
              "type": "value"
            },
            {
              "key": "quantity",
              "type": "value"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "COMPARISON",
            "ESTIMATION",
            "MULTI_STEP"
          ],
          "template": "{character} goes to the shop and buys {items}. How much does {character} spend in total?",
          "answerTemplate": "{character} spends {result} in total",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "ESTIMATION"
          ],
          "template": "Estimate: If {character} buys {items}, about how much will it cost?",
          "answerTemplate": "It will cost approximately {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "VALIDATION"
          ],
          "template": "{character} calculated that {items} costs {amount}. Is this correct?",
          "answerTemplate": "{validation_result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "amount",
              "type": "value"
            },
            {
              "key": "validation_result",
              "type": "boolean"
            }
          ]
        }
      ]
    },
    "distractors": [
      {
        "value": 23,
        "strategy": "WRONG_OPERATION",
        "rationale": "Used wrong operation to solve"
      },
      {
        "value": 20,
        "strategy": "CALCULATION_ERROR",
        "rationale": "Arithmetic calculation error"
      },
      {
        "value": 20,
        "rationale": "Order of operations error"
      }
    ],
    "enhancementStatus": {
      "level": "full",
      "requestedFormat": "MISSING_VALUE",
      "actualFormat": "MISSING_VALUE",
      "featuresActive": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "featuresPending": [],
      "isFullyEnhanced": true
    },
    "mathOutput": {
      "operation": "MULTIPLICATION",
      "multiplicand": 18,
      "multiplier": 1,
      "result": 18,
      "factors": [
        18,
        1
      ],
      "decimal_formatted": {
        "operands": [
          "18",
          "1"
        ],
        "result": "18"
      }
    },
    "generationTime": 1,
    "questionId": "q_1759232461091_vkc14v482",
    "generationSetup": {
      "controller_used": "MISSING_VALUEController",
      "format_requested": "MISSING_VALUE",
      "format_actual": "MISSING_VALUE",
      "scenario_theme": "SHOPPING",
      "scenario_id": "shop-002-realistic-general",
      "scenario_selection_method": "default",
      "distractor_strategies": [
        "WRONG_OPERATION",
        "CALCULATION_ERROR",
        null
      ],
      "distractor_count": 3,
      "theme_variety": false,
      "format_variety": false,
      "enhancement_level": "full",
      "features_active": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "features_pending": [],
      "generation_time_ms": 1
    }
  },
  "metadata": {
    "format": "MISSING_VALUE",
    "cognitive_load": 40,
    "curriculum_alignment": [
      "4N1a"
    ],
    "difficulty": "4.1",
    "scenario_theme": "SHOPPING",
    "distractor_strategies": [
      "WRONG_OPERATION",
      "CALCULATION_ERROR",
      null
    ],
    "generation_time_ms": 1,
    "api_version": "2.0",
    "enhancement_status": "full",
    "format_requested": "MISSING_VALUE",
    "format_used": "MISSING_VALUE",
    "features_active": [
      "enhanced_distractors",
      "rich_scenarios",
      "cognitive_load",
      "advanced_formats"
    ],
    "features_pending": []
  },
  "context": {
    "id": "shop-002-realistic-general",
    "theme": "SHOPPING",
    "setting": {
      "location": "local shop",
      "timeContext": "after school",
      "atmosphere": "friendly"
    },
    "characters": [
      {
        "name": "Logan",
        "role": "student"
      }
    ],
    "items": [
      {
        "name": "apple",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.2,
          "max": 0.5,
          "typical": 0.35,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "banana",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.15,
          "max": 0.4,
          "typical": 0.25,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sandwich",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 2.5,
          "max": 6,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "drink",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.8,
          "max": 2.5,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "cake",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 1.5,
          "max": 4,
          "typical": 2.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "biscuit",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.8,
          "max": 2,
          "typical": 1.2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sweet",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.1,
          "max": 1,
          "typical": 0.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "chocolate",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.6,
          "max": 3,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "pen",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.5,
          "max": 2,
          "typical": 1,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "pencil",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.2,
          "max": 1,
          "typical": 0.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "ruler",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.8,
          "max": 2.5,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "notebook",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 1,
          "max": 4,
          "typical": 2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "eraser",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.3,
          "max": 1.5,
          "typical": 0.75,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "book",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 3,
          "max": 15,
          "typical": 8,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "comic",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2,
          "max": 5,
          "typical": 3,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "magazine",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2.5,
          "max": 6,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "toy",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 5,
          "max": 25,
          "typical": 12,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "game",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 8,
          "max": 60,
          "typical": 25,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "puzzle",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 5,
          "max": 20,
          "typical": 12,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sticker",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 0.2,
          "max": 2,
          "typical": 0.8,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "badge",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 0.5,
          "max": 3,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "poster",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2,
          "max": 8,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "card",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 0.5,
          "max": 4,
          "typical": 2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      }
    ],
    "culturalElements": [
      {
        "type": "currency",
        "value": "£",
        "explanation": "British pounds"
      },
      {
        "type": "location",
        "value": "UK local shop",
        "explanation": "Typical British corner shop"
      }
    ],
    "realWorldConnection": "Everyday shopping with realistic UK prices",
    "yearAppropriate": [
      1,
      2,
      3,
      4,
      5,
      6
    ],
    "templates": [
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "MULTI_STEP"
        ],
        "modelCompatibility": [
          "ADDITION"
        ],
        "operandCount": 3,
        "template": "{character} buys {article1} {item1} for {price1}, {article2} {item2} for {price2}, and {article3} {item3} for {price3}. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item1",
            "type": "item"
          },
          {
            "key": "item2",
            "type": "item"
          },
          {
            "key": "item3",
            "type": "item"
          },
          {
            "key": "price1",
            "type": "value"
          },
          {
            "key": "price2",
            "type": "value"
          },
          {
            "key": "price3",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "MULTI_STEP"
        ],
        "modelCompatibility": [
          "ADDITION"
        ],
        "operandCount": 2,
        "template": "{character} buys {article1} {item1} for {price1} and {article2} {item2} for {price2}. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item1",
            "type": "item"
          },
          {
            "key": "item2",
            "type": "item"
          },
          {
            "key": "price1",
            "type": "value"
          },
          {
            "key": "price2",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "SUBTRACTION",
          "CHANGE_CALCULATION"
        ],
        "template": "{character} buys {article} {item} for {price} and pays with {payment}. How much change does {character} get?",
        "answerTemplate": "{character} receives {result} in change",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "payment",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "MULTIPLICATION"
        ],
        "template": "{character} buys {quantity} {item} at {price} each. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "quantity",
            "type": "value"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "DIVISION"
        ],
        "template": "{character} has {total} to spend equally on {quantity} {item}. How much can {character} spend on each one?",
        "answerTemplate": "{character} can spend {result} on each {item}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "total",
            "type": "value"
          },
          {
            "key": "quantity",
            "type": "value"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "COMPARISON",
          "ESTIMATION",
          "MULTI_STEP"
        ],
        "template": "{character} goes to the shop and buys {items}. How much does {character} spend in total?",
        "answerTemplate": "{character} spends {result} in total",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "ESTIMATION"
        ],
        "template": "Estimate: If {character} buys {items}, about how much will it cost?",
        "answerTemplate": "It will cost approximately {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "VALIDATION"
        ],
        "template": "{character} calculated that {items} costs {amount}. Is this correct?",
        "answerTemplate": "{validation_result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "amount",
            "type": "value"
          },
          {
            "key": "validation_result",
            "type": "boolean"
          }
        ]
      }
    ]
  }
}
# Test B.4: DIVISION model
{
  "success": true,
  "question": {
    "text": "Logan has £1.04 to spend equally on 4 apple. How much can Logan spend on each one?",
    "options": [
      {
        "text": "26p remainder 3",
        "value": 0.26,
        "index": 0
      },
      {
        "text": "83",
        "value": 83,
        "index": 1
      },
      {
        "text": "1.26",
        "value": 1.26,
        "index": 2
      },
      {
        "text": "2.26",
        "value": 2.26,
        "index": 3
      }
    ],
    "correctIndex": 0,
    "format": "DIRECT_CALCULATION",
    "difficulty": {
      "year": 4,
      "subLevel": 1,
      "displayName": "4.1",
      "cognitiveLoad": 40
    },
    "cognitiveLoad": 40,
    "curriculumTags": [
      "4N1a"
    ],
    "scenario": {
      "id": "shop-002-realistic-general",
      "theme": "SHOPPING",
      "setting": {
        "location": "local shop",
        "timeContext": "after school",
        "atmosphere": "friendly"
      },
      "characters": [
        {
          "name": "Logan",
          "role": "student"
        }
      ],
      "items": [
        {
          "name": "apple",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.2,
            "max": 0.5,
            "typical": 0.35,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "banana",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.15,
            "max": 0.4,
            "typical": 0.25,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sandwich",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 2.5,
            "max": 6,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "drink",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.8,
            "max": 2.5,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "cake",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 1.5,
            "max": 4,
            "typical": 2.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "biscuit",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.8,
            "max": 2,
            "typical": 1.2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sweet",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.1,
            "max": 1,
            "typical": 0.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "chocolate",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.6,
            "max": 3,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "pen",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.5,
            "max": 2,
            "typical": 1,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "pencil",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.2,
            "max": 1,
            "typical": 0.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "ruler",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.8,
            "max": 2.5,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "notebook",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 1,
            "max": 4,
            "typical": 2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "eraser",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.3,
            "max": 1.5,
            "typical": 0.75,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "book",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 3,
            "max": 15,
            "typical": 8,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "comic",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2,
            "max": 5,
            "typical": 3,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "magazine",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2.5,
            "max": 6,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "toy",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 5,
            "max": 25,
            "typical": 12,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "game",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 8,
            "max": 60,
            "typical": 25,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "puzzle",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 5,
            "max": 20,
            "typical": 12,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sticker",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 0.2,
            "max": 2,
            "typical": 0.8,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "badge",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 0.5,
            "max": 3,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "poster",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2,
            "max": 8,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "card",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 0.5,
            "max": 4,
            "typical": 2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        }
      ],
      "culturalElements": [
        {
          "type": "currency",
          "value": "£",
          "explanation": "British pounds"
        },
        {
          "type": "location",
          "value": "UK local shop",
          "explanation": "Typical British corner shop"
        }
      ],
      "realWorldConnection": "Everyday shopping with realistic UK prices",
      "yearAppropriate": [
        1,
        2,
        3,
        4,
        5,
        6
      ],
      "templates": [
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "MULTI_STEP"
          ],
          "modelCompatibility": [
            "ADDITION"
          ],
          "operandCount": 3,
          "template": "{character} buys {article1} {item1} for {price1}, {article2} {item2} for {price2}, and {article3} {item3} for {price3}. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item1",
              "type": "item"
            },
            {
              "key": "item2",
              "type": "item"
            },
            {
              "key": "item3",
              "type": "item"
            },
            {
              "key": "price1",
              "type": "value"
            },
            {
              "key": "price2",
              "type": "value"
            },
            {
              "key": "price3",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "MULTI_STEP"
          ],
          "modelCompatibility": [
            "ADDITION"
          ],
          "operandCount": 2,
          "template": "{character} buys {article1} {item1} for {price1} and {article2} {item2} for {price2}. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item1",
              "type": "item"
            },
            {
              "key": "item2",
              "type": "item"
            },
            {
              "key": "price1",
              "type": "value"
            },
            {
              "key": "price2",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "SUBTRACTION",
            "CHANGE_CALCULATION"
          ],
          "template": "{character} buys {article} {item} for {price} and pays with {payment}. How much change does {character} get?",
          "answerTemplate": "{character} receives {result} in change",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "payment",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "MULTIPLICATION"
          ],
          "template": "{character} buys {quantity} {item} at {price} each. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "quantity",
              "type": "value"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "DIVISION"
          ],
          "template": "{character} has {total} to spend equally on {quantity} {item}. How much can {character} spend on each one?",
          "answerTemplate": "{character} can spend {result} on each {item}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "total",
              "type": "value"
            },
            {
              "key": "quantity",
              "type": "value"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "COMPARISON",
            "ESTIMATION",
            "MULTI_STEP"
          ],
          "template": "{character} goes to the shop and buys {items}. How much does {character} spend in total?",
          "answerTemplate": "{character} spends {result} in total",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "ESTIMATION"
          ],
          "template": "Estimate: If {character} buys {items}, about how much will it cost?",
          "answerTemplate": "It will cost approximately {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "VALIDATION"
          ],
          "template": "{character} calculated that {items} costs {amount}. Is this correct?",
          "answerTemplate": "{validation_result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "amount",
              "type": "value"
            },
            {
              "key": "validation_result",
              "type": "boolean"
            }
          ]
        }
      ]
    },
    "distractors": [
      {
        "value": 83,
        "displayText": "83",
        "strategy": "WRONG_OPERATION",
        "reasoning": "Subtracted instead of dividing"
      },
      {
        "value": 1.26,
        "displayText": "1.26",
        "strategy": "CLOSE_VALUE",
        "reasoning": "Off by 1"
      },
      {
        "value": 2.26,
        "displayText": "2.26",
        "strategy": "CLOSE_VALUE",
        "reasoning": "Off by 2"
      }
    ],
    "enhancementStatus": {
      "level": "partial",
      "requestedFormat": "DIRECT_CALCULATION",
      "actualFormat": "DIRECT_CALCULATION",
      "featuresActive": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "featuresPending": [],
      "isFullyEnhanced": true
    },
    "mathOutput": {
      "operation": "DIVISION",
      "divisor": 4,
      "dividend": 1.04,
      "quotient": 0.26,
      "remainder": 0
    },
    "generationTime": 1,
    "questionId": "q_1759232461136_w1xjvg5i6",
    "generationSetup": {
      "controller_used": "DIRECT_CALCULATIONController",
      "format_requested": "DIRECT_CALCULATION",
      "format_actual": "DIRECT_CALCULATION",
      "scenario_theme": "SHOPPING",
      "scenario_id": "shop-002-realistic-general",
      "scenario_selection_method": "default",
      "distractor_strategies": [
        "WRONG_OPERATION",
        "CLOSE_VALUE",
        "CLOSE_VALUE"
      ],
      "distractor_count": 3,
      "theme_variety": false,
      "format_variety": false,
      "enhancement_level": "partial",
      "features_active": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "features_pending": [],
      "generation_time_ms": 1
    }
  },
  "metadata": {
    "format": "DIRECT_CALCULATION",
    "cognitive_load": 40,
    "curriculum_alignment": [
      "4N1a"
    ],
    "difficulty": "4.1",
    "scenario_theme": "SHOPPING",
    "distractor_strategies": [
      "WRONG_OPERATION",
      "CLOSE_VALUE",
      "CLOSE_VALUE"
    ],
    "generation_time_ms": 1,
    "api_version": "2.0",
    "enhancement_status": "partial",
    "format_requested": "DIRECT_CALCULATION",
    "format_used": "DIRECT_CALCULATION",
    "features_active": [
      "enhanced_distractors",
      "rich_scenarios",
      "cognitive_load",
      "advanced_formats"
    ],
    "features_pending": []
  },
  "context": {
    "id": "shop-002-realistic-general",
    "theme": "SHOPPING",
    "setting": {
      "location": "local shop",
      "timeContext": "after school",
      "atmosphere": "friendly"
    },
    "characters": [
      {
        "name": "Logan",
        "role": "student"
      }
    ],
    "items": [
      {
        "name": "apple",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.2,
          "max": 0.5,
          "typical": 0.35,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "banana",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.15,
          "max": 0.4,
          "typical": 0.25,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sandwich",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 2.5,
          "max": 6,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "drink",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.8,
          "max": 2.5,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "cake",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 1.5,
          "max": 4,
          "typical": 2.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "biscuit",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.8,
          "max": 2,
          "typical": 1.2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sweet",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.1,
          "max": 1,
          "typical": 0.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "chocolate",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.6,
          "max": 3,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "pen",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.5,
          "max": 2,
          "typical": 1,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "pencil",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.2,
          "max": 1,
          "typical": 0.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "ruler",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.8,
          "max": 2.5,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "notebook",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 1,
          "max": 4,
          "typical": 2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "eraser",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.3,
          "max": 1.5,
          "typical": 0.75,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "book",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 3,
          "max": 15,
          "typical": 8,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "comic",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2,
          "max": 5,
          "typical": 3,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "magazine",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2.5,
          "max": 6,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "toy",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 5,
          "max": 25,
          "typical": 12,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "game",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 8,
          "max": 60,
          "typical": 25,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "puzzle",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 5,
          "max": 20,
          "typical": 12,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sticker",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 0.2,
          "max": 2,
          "typical": 0.8,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "badge",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 0.5,
          "max": 3,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "poster",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2,
          "max": 8,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "card",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 0.5,
          "max": 4,
          "typical": 2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      }
    ],
    "culturalElements": [
      {
        "type": "currency",
        "value": "£",
        "explanation": "British pounds"
      },
      {
        "type": "location",
        "value": "UK local shop",
        "explanation": "Typical British corner shop"
      }
    ],
    "realWorldConnection": "Everyday shopping with realistic UK prices",
    "yearAppropriate": [
      1,
      2,
      3,
      4,
      5,
      6
    ],
    "templates": [
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "MULTI_STEP"
        ],
        "modelCompatibility": [
          "ADDITION"
        ],
        "operandCount": 3,
        "template": "{character} buys {article1} {item1} for {price1}, {article2} {item2} for {price2}, and {article3} {item3} for {price3}. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item1",
            "type": "item"
          },
          {
            "key": "item2",
            "type": "item"
          },
          {
            "key": "item3",
            "type": "item"
          },
          {
            "key": "price1",
            "type": "value"
          },
          {
            "key": "price2",
            "type": "value"
          },
          {
            "key": "price3",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "MULTI_STEP"
        ],
        "modelCompatibility": [
          "ADDITION"
        ],
        "operandCount": 2,
        "template": "{character} buys {article1} {item1} for {price1} and {article2} {item2} for {price2}. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item1",
            "type": "item"
          },
          {
            "key": "item2",
            "type": "item"
          },
          {
            "key": "price1",
            "type": "value"
          },
          {
            "key": "price2",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "SUBTRACTION",
          "CHANGE_CALCULATION"
        ],
        "template": "{character} buys {article} {item} for {price} and pays with {payment}. How much change does {character} get?",
        "answerTemplate": "{character} receives {result} in change",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "payment",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "MULTIPLICATION"
        ],
        "template": "{character} buys {quantity} {item} at {price} each. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "quantity",
            "type": "value"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "DIVISION"
        ],
        "template": "{character} has {total} to spend equally on {quantity} {item}. How much can {character} spend on each one?",
        "answerTemplate": "{character} can spend {result} on each {item}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "total",
            "type": "value"
          },
          {
            "key": "quantity",
            "type": "value"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "COMPARISON",
          "ESTIMATION",
          "MULTI_STEP"
        ],
        "template": "{character} goes to the shop and buys {items}. How much does {character} spend in total?",
        "answerTemplate": "{character} spends {result} in total",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "ESTIMATION"
        ],
        "template": "Estimate: If {character} buys {items}, about how much will it cost?",
        "answerTemplate": "It will cost approximately {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "VALIDATION"
        ],
        "template": "{character} calculated that {items} costs {amount}. Is this correct?",
        "answerTemplate": "{validation_result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "amount",
            "type": "value"
          },
          {
            "key": "validation_result",
            "type": "boolean"
          }
        ]
      }
    ]
  }
}
# Test B.5: PERCENTAGE model
{
  "success": true,
  "question": {
    "text": "Logan goes to the shop and buys apple, banana, sandwich, drink, cake, biscuit, sweet, chocolate, pen, pencil, ruler, notebook, eraser, book, comic, magazine, toy, game, puzzle, sticker, badge, poster, card. How much does Logan spend in total?",
    "options": [
      {
        "text": "£9.50",
        "value": 9.5,
        "index": 0
      },
      {
        "text": "4.75",
        "value": 4.75,
        "index": 1
      },
      {
        "text": "10.5",
        "value": 10.5,
        "index": 2
      },
      {
        "text": "8.5",
        "value": 8.5,
        "index": 3
      }
    ],
    "correctIndex": 0,
    "format": "DIRECT_CALCULATION",
    "difficulty": {
      "year": 4,
      "subLevel": 1,
      "displayName": "4.1",
      "cognitiveLoad": 40
    },
    "cognitiveLoad": 40,
    "curriculumTags": [
      "4N1a"
    ],
    "scenario": {
      "id": "shop-002-realistic-general",
      "theme": "SHOPPING",
      "setting": {
        "location": "local shop",
        "timeContext": "after school",
        "atmosphere": "friendly"
      },
      "characters": [
        {
          "name": "Logan",
          "role": "student"
        }
      ],
      "items": [
        {
          "name": "apple",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.2,
            "max": 0.5,
            "typical": 0.35,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "banana",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.15,
            "max": 0.4,
            "typical": 0.25,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sandwich",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 2.5,
            "max": 6,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "drink",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.8,
            "max": 2.5,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "cake",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 1.5,
            "max": 4,
            "typical": 2.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "biscuit",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.8,
            "max": 2,
            "typical": 1.2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sweet",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.1,
            "max": 1,
            "typical": 0.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "chocolate",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.6,
            "max": 3,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "pen",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.5,
            "max": 2,
            "typical": 1,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "pencil",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.2,
            "max": 1,
            "typical": 0.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "ruler",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.8,
            "max": 2.5,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "notebook",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 1,
            "max": 4,
            "typical": 2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "eraser",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.3,
            "max": 1.5,
            "typical": 0.75,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "book",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 3,
            "max": 15,
            "typical": 8,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "comic",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2,
            "max": 5,
            "typical": 3,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "magazine",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2.5,
            "max": 6,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "toy",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 5,
            "max": 25,
            "typical": 12,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "game",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 8,
            "max": 60,
            "typical": 25,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "puzzle",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 5,
            "max": 20,
            "typical": 12,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sticker",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 0.2,
            "max": 2,
            "typical": 0.8,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "badge",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 0.5,
            "max": 3,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "poster",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2,
            "max": 8,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "card",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 0.5,
            "max": 4,
            "typical": 2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        }
      ],
      "culturalElements": [
        {
          "type": "currency",
          "value": "£",
          "explanation": "British pounds"
        },
        {
          "type": "location",
          "value": "UK local shop",
          "explanation": "Typical British corner shop"
        }
      ],
      "realWorldConnection": "Everyday shopping with realistic UK prices",
      "yearAppropriate": [
        1,
        2,
        3,
        4,
        5,
        6
      ],
      "templates": [
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "MULTI_STEP"
          ],
          "modelCompatibility": [
            "ADDITION"
          ],
          "operandCount": 3,
          "template": "{character} buys {article1} {item1} for {price1}, {article2} {item2} for {price2}, and {article3} {item3} for {price3}. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item1",
              "type": "item"
            },
            {
              "key": "item2",
              "type": "item"
            },
            {
              "key": "item3",
              "type": "item"
            },
            {
              "key": "price1",
              "type": "value"
            },
            {
              "key": "price2",
              "type": "value"
            },
            {
              "key": "price3",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "MULTI_STEP"
          ],
          "modelCompatibility": [
            "ADDITION"
          ],
          "operandCount": 2,
          "template": "{character} buys {article1} {item1} for {price1} and {article2} {item2} for {price2}. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item1",
              "type": "item"
            },
            {
              "key": "item2",
              "type": "item"
            },
            {
              "key": "price1",
              "type": "value"
            },
            {
              "key": "price2",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "SUBTRACTION",
            "CHANGE_CALCULATION"
          ],
          "template": "{character} buys {article} {item} for {price} and pays with {payment}. How much change does {character} get?",
          "answerTemplate": "{character} receives {result} in change",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "payment",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "MULTIPLICATION"
          ],
          "template": "{character} buys {quantity} {item} at {price} each. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "quantity",
              "type": "value"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "DIVISION"
          ],
          "template": "{character} has {total} to spend equally on {quantity} {item}. How much can {character} spend on each one?",
          "answerTemplate": "{character} can spend {result} on each {item}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "total",
              "type": "value"
            },
            {
              "key": "quantity",
              "type": "value"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "COMPARISON",
            "ESTIMATION",
            "MULTI_STEP"
          ],
          "template": "{character} goes to the shop and buys {items}. How much does {character} spend in total?",
          "answerTemplate": "{character} spends {result} in total",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "ESTIMATION"
          ],
          "template": "Estimate: If {character} buys {items}, about how much will it cost?",
          "answerTemplate": "It will cost approximately {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "VALIDATION"
          ],
          "template": "{character} calculated that {items} costs {amount}. Is this correct?",
          "answerTemplate": "{validation_result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "amount",
              "type": "value"
            },
            {
              "key": "validation_result",
              "type": "boolean"
            }
          ]
        }
      ]
    },
    "distractors": [
      {
        "value": 10.5,
        "displayText": "10.5",
        "strategy": "CLOSE_VALUE",
        "reasoning": "Off by 1"
      },
      {
        "value": 8.5,
        "displayText": "8.5",
        "strategy": "CLOSE_VALUE",
        "reasoning": "Off by 1"
      },
      {
        "value": 4.75,
        "displayText": "4.75",
        "reasoning": "Half the correct value"
      }
    ],
    "enhancementStatus": {
      "level": "partial",
      "requestedFormat": "DIRECT_CALCULATION",
      "actualFormat": "DIRECT_CALCULATION",
      "featuresActive": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "featuresPending": [],
      "isFullyEnhanced": true
    },
    "mathOutput": {
      "operation": "PERCENTAGE",
      "base_value": 19,
      "percentage": 50,
      "result": 9.5
    },
    "generationTime": 1,
    "questionId": "q_1759232461182_27j8cajdf",
    "generationSetup": {
      "controller_used": "DIRECT_CALCULATIONController",
      "format_requested": "DIRECT_CALCULATION",
      "format_actual": "DIRECT_CALCULATION",
      "scenario_theme": "SHOPPING",
      "scenario_id": "shop-002-realistic-general",
      "scenario_selection_method": "default",
      "distractor_strategies": [
        "CLOSE_VALUE",
        "CLOSE_VALUE",
        null
      ],
      "distractor_count": 3,
      "theme_variety": false,
      "format_variety": false,
      "enhancement_level": "partial",
      "features_active": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "features_pending": [],
      "generation_time_ms": 1
    }
  },
  "metadata": {
    "format": "DIRECT_CALCULATION",
    "cognitive_load": 40,
    "curriculum_alignment": [
      "4N1a"
    ],
    "difficulty": "4.1",
    "scenario_theme": "SHOPPING",
    "distractor_strategies": [
      "CLOSE_VALUE",
      "CLOSE_VALUE",
      null
    ],
    "generation_time_ms": 1,
    "api_version": "2.0",
    "enhancement_status": "partial",
    "format_requested": "DIRECT_CALCULATION",
    "format_used": "DIRECT_CALCULATION",
    "features_active": [
      "enhanced_distractors",
      "rich_scenarios",
      "cognitive_load",
      "advanced_formats"
    ],
    "features_pending": []
  },
  "context": {
    "id": "shop-002-realistic-general",
    "theme": "SHOPPING",
    "setting": {
      "location": "local shop",
      "timeContext": "after school",
      "atmosphere": "friendly"
    },
    "characters": [
      {
        "name": "Logan",
        "role": "student"
      }
    ],
    "items": [
      {
        "name": "apple",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.2,
          "max": 0.5,
          "typical": 0.35,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "banana",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.15,
          "max": 0.4,
          "typical": 0.25,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sandwich",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 2.5,
          "max": 6,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "drink",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.8,
          "max": 2.5,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "cake",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 1.5,
          "max": 4,
          "typical": 2.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "biscuit",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.8,
          "max": 2,
          "typical": 1.2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sweet",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.1,
          "max": 1,
          "typical": 0.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "chocolate",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.6,
          "max": 3,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "pen",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.5,
          "max": 2,
          "typical": 1,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "pencil",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.2,
          "max": 1,
          "typical": 0.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "ruler",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.8,
          "max": 2.5,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "notebook",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 1,
          "max": 4,
          "typical": 2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "eraser",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.3,
          "max": 1.5,
          "typical": 0.75,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "book",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 3,
          "max": 15,
          "typical": 8,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "comic",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2,
          "max": 5,
          "typical": 3,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "magazine",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2.5,
          "max": 6,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "toy",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 5,
          "max": 25,
          "typical": 12,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "game",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 8,
          "max": 60,
          "typical": 25,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "puzzle",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 5,
          "max": 20,
          "typical": 12,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sticker",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 0.2,
          "max": 2,
          "typical": 0.8,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "badge",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 0.5,
          "max": 3,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "poster",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2,
          "max": 8,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "card",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 0.5,
          "max": 4,
          "typical": 2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      }
    ],
    "culturalElements": [
      {
        "type": "currency",
        "value": "£",
        "explanation": "British pounds"
      },
      {
        "type": "location",
        "value": "UK local shop",
        "explanation": "Typical British corner shop"
      }
    ],
    "realWorldConnection": "Everyday shopping with realistic UK prices",
    "yearAppropriate": [
      1,
      2,
      3,
      4,
      5,
      6
    ],
    "templates": [
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "MULTI_STEP"
        ],
        "modelCompatibility": [
          "ADDITION"
        ],
        "operandCount": 3,
        "template": "{character} buys {article1} {item1} for {price1}, {article2} {item2} for {price2}, and {article3} {item3} for {price3}. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item1",
            "type": "item"
          },
          {
            "key": "item2",
            "type": "item"
          },
          {
            "key": "item3",
            "type": "item"
          },
          {
            "key": "price1",
            "type": "value"
          },
          {
            "key": "price2",
            "type": "value"
          },
          {
            "key": "price3",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "MULTI_STEP"
        ],
        "modelCompatibility": [
          "ADDITION"
        ],
        "operandCount": 2,
        "template": "{character} buys {article1} {item1} for {price1} and {article2} {item2} for {price2}. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item1",
            "type": "item"
          },
          {
            "key": "item2",
            "type": "item"
          },
          {
            "key": "price1",
            "type": "value"
          },
          {
            "key": "price2",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "SUBTRACTION",
          "CHANGE_CALCULATION"
        ],
        "template": "{character} buys {article} {item} for {price} and pays with {payment}. How much change does {character} get?",
        "answerTemplate": "{character} receives {result} in change",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "payment",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "MULTIPLICATION"
        ],
        "template": "{character} buys {quantity} {item} at {price} each. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "quantity",
            "type": "value"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "DIVISION"
        ],
        "template": "{character} has {total} to spend equally on {quantity} {item}. How much can {character} spend on each one?",
        "answerTemplate": "{character} can spend {result} on each {item}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "total",
            "type": "value"
          },
          {
            "key": "quantity",
            "type": "value"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "COMPARISON",
          "ESTIMATION",
          "MULTI_STEP"
        ],
        "template": "{character} goes to the shop and buys {items}. How much does {character} spend in total?",
        "answerTemplate": "{character} spends {result} in total",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "ESTIMATION"
        ],
        "template": "Estimate: If {character} buys {items}, about how much will it cost?",
        "answerTemplate": "It will cost approximately {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "VALIDATION"
        ],
        "template": "{character} calculated that {items} costs {amount}. Is this correct?",
        "answerTemplate": "{validation_result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "amount",
            "type": "value"
          },
          {
            "key": "validation_result",
            "type": "boolean"
          }
        ]
      }
    ]
  }
}
# Test B.6: FRACTION model
{
  "success": true,
  "question": {
    "text": "What is one third of 6?",
    "options": [
      {
        "text": "3",
        "value": 3,
        "index": 0
      },
      {
        "text": "1",
        "value": 1,
        "index": 1
      },
      {
        "text": "£2.00",
        "value": 2,
        "index": 2
      }
    ],
    "correctIndex": 2,
    "questionContent": {
      "fullText": "What is one third of 6?",
      "templateData": {
        "numerator": 1,
        "denominator": 3,
        "whole_value": 6,
        "fraction_text": "one third",
        "result": 2
      }
    },
    "format": "DIRECT_CALCULATION",
    "difficulty": {
      "year": 4,
      "subLevel": 1,
      "displayName": "4.1",
      "cognitiveLoad": 40
    },
    "cognitiveLoad": 40,
    "curriculumTags": [
      "4N1a"
    ],
    "scenario": {
      "id": "default-4-1759232461243",
      "theme": "SHOPPING",
      "setting": {
        "location": "shop",
        "timeContext": "afternoon",
        "atmosphere": "friendly"
      },
      "characters": [
        {
          "name": "Noah",
          "role": "student"
        }
      ],
      "items": [
        {
          "name": "item",
          "category": "HOUSEHOLD_ITEMS",
          "typicalValue": {
            "min": 1,
            "max": 10,
            "typical": 5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        }
      ],
      "culturalElements": [
        {
          "type": "currency",
          "value": "£",
          "explanation": "British pounds"
        }
      ],
      "realWorldConnection": "Basic shopping calculations",
      "yearAppropriate": [
        4
      ],
      "templates": [
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "template": "{character} buys {article} {item} for {price}. How much does it cost?",
          "answerTemplate": "It costs {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        }
      ]
    },
    "distractors": [
      {
        "value": 3,
        "displayText": "3",
        "strategy": "CLOSE_VALUE",
        "reasoning": "Off by 1"
      },
      {
        "value": 1,
        "displayText": "1",
        "strategy": "CLOSE_VALUE",
        "reasoning": "Off by 1"
      }
    ],
    "enhancementStatus": {
      "level": "partial",
      "requestedFormat": "DIRECT_CALCULATION",
      "actualFormat": "DIRECT_CALCULATION",
      "featuresActive": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "featuresPending": [],
      "isFullyEnhanced": true
    },
    "mathOutput": {
      "operation": "FRACTION",
      "whole_value": 6,
      "numerator": 1,
      "denominator": 3,
      "result": 2
    },
    "generationTime": 1,
    "questionId": "q_1759232461243_0ps7hbr45",
    "generationSetup": {
      "controller_used": "DIRECT_CALCULATIONController",
      "format_requested": "DIRECT_CALCULATION",
      "format_actual": "DIRECT_CALCULATION",
      "scenario_theme": "SHOPPING",
      "scenario_id": "default-4-1759232461243",
      "scenario_selection_method": "default",
      "distractor_strategies": [
        "CLOSE_VALUE",
        "CLOSE_VALUE"
      ],
      "distractor_count": 2,
      "theme_variety": false,
      "format_variety": false,
      "enhancement_level": "partial",
      "features_active": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "features_pending": [],
      "generation_time_ms": 1
    }
  },
  "metadata": {
    "format": "DIRECT_CALCULATION",
    "cognitive_load": 40,
    "curriculum_alignment": [
      "4N1a"
    ],
    "difficulty": "4.1",
    "scenario_theme": "SHOPPING",
    "distractor_strategies": [
      "CLOSE_VALUE",
      "CLOSE_VALUE"
    ],
    "generation_time_ms": 1,
    "api_version": "2.0",
    "enhancement_status": "partial",
    "format_requested": "DIRECT_CALCULATION",
    "format_used": "DIRECT_CALCULATION",
    "features_active": [
      "enhanced_distractors",
      "rich_scenarios",
      "cognitive_load",
      "advanced_formats"
    ],
    "features_pending": []
  },
  "context": {
    "id": "default-4-1759232461243",
    "theme": "SHOPPING",
    "setting": {
      "location": "shop",
      "timeContext": "afternoon",
      "atmosphere": "friendly"
    },
    "characters": [
      {
        "name": "Noah",
        "role": "student"
      }
    ],
    "items": [
      {
        "name": "item",
        "category": "HOUSEHOLD_ITEMS",
        "typicalValue": {
          "min": 1,
          "max": 10,
          "typical": 5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      }
    ],
    "culturalElements": [
      {
        "type": "currency",
        "value": "£",
        "explanation": "British pounds"
      }
    ],
    "realWorldConnection": "Basic shopping calculations",
    "yearAppropriate": [
      4
    ],
    "templates": [
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "template": "{character} buys {article} {item} for {price}. How much does it cost?",
        "answerTemplate": "It costs {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      }
    ]
  }
}
# Test B.7: COUNTING model
{
  "success": true,
  "question": {
    "text": "Amelia buys an item for £5. How much does it cost?",
    "options": [
      {
        "value": 0,
        "text": "0p",
        "isCorrect": true
      }
    ],
    "correctIndex": 0,
    "format": "DIRECT_CALCULATION",
    "difficulty": {
      "year": 4,
      "subLevel": 1,
      "displayName": "4.1",
      "cognitiveLoad": 40
    },
    "cognitiveLoad": 40,
    "curriculumTags": [
      "4N1a"
    ],
    "scenario": {
      "id": "default-4-1759232461304",
      "theme": "SHOPPING",
      "setting": {
        "location": "shop",
        "timeContext": "afternoon",
        "atmosphere": "friendly"
      },
      "characters": [
        {
          "name": "Amelia",
          "role": "student"
        }
      ],
      "items": [
        {
          "name": "item",
          "category": "HOUSEHOLD_ITEMS",
          "typicalValue": {
            "min": 1,
            "max": 10,
            "typical": 5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        }
      ],
      "culturalElements": [
        {
          "type": "currency",
          "value": "£",
          "explanation": "British pounds"
        }
      ],
      "realWorldConnection": "Basic shopping calculations",
      "yearAppropriate": [
        4
      ],
      "templates": [
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "template": "{character} buys {article} {item} for {price}. How much does it cost?",
          "answerTemplate": "It costs {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        }
      ]
    },
    "distractors": [],
    "enhancementStatus": {
      "level": "partial",
      "requestedFormat": "DIRECT_CALCULATION",
      "actualFormat": "DIRECT_CALCULATION",
      "featuresActive": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "featuresPending": [],
      "isFullyEnhanced": true
    },
    "mathOutput": {
      "operation": "COUNTING"
    },
    "generationTime": 2,
    "questionId": "q_1759232461304_b4faqmccq",
    "generationSetup": {
      "controller_used": "DIRECT_CALCULATIONController",
      "format_requested": "DIRECT_CALCULATION",
      "format_actual": "DIRECT_CALCULATION",
      "scenario_theme": "SHOPPING",
      "scenario_id": "default-4-1759232461304",
      "scenario_selection_method": "default",
      "distractor_strategies": [],
      "distractor_count": 0,
      "theme_variety": false,
      "format_variety": false,
      "enhancement_level": "partial",
      "features_active": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "features_pending": [],
      "generation_time_ms": 2
    }
  },
  "metadata": {
    "format": "DIRECT_CALCULATION",
    "cognitive_load": 40,
    "curriculum_alignment": [
      "4N1a"
    ],
    "difficulty": "4.1",
    "scenario_theme": "SHOPPING",
    "distractor_strategies": [],
    "generation_time_ms": 2,
    "api_version": "2.0",
    "enhancement_status": "partial",
    "format_requested": "DIRECT_CALCULATION",
    "format_used": "DIRECT_CALCULATION",
    "features_active": [
      "enhanced_distractors",
      "rich_scenarios",
      "cognitive_load",
      "advanced_formats"
    ],
    "features_pending": []
  },
  "context": {
    "id": "default-4-1759232461304",
    "theme": "SHOPPING",
    "setting": {
      "location": "shop",
      "timeContext": "afternoon",
      "atmosphere": "friendly"
    },
    "characters": [
      {
        "name": "Amelia",
        "role": "student"
      }
    ],
    "items": [
      {
        "name": "item",
        "category": "HOUSEHOLD_ITEMS",
        "typicalValue": {
          "min": 1,
          "max": 10,
          "typical": 5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      }
    ],
    "culturalElements": [
      {
        "type": "currency",
        "value": "£",
        "explanation": "British pounds"
      }
    ],
    "realWorldConnection": "Basic shopping calculations",
    "yearAppropriate": [
      4
    ],
    "templates": [
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "template": "{character} buys {article} {item} for {price}. How much does it cost?",
        "answerTemplate": "It costs {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      }
    ]
  }
}
# Test B.8: TIME_RATE model
{
  "success": true,
  "question": {
    "text": "Michael buys an item for £5. How much does it cost?",
    "options": [
      {
        "value": 0,
        "text": "0p",
        "isCorrect": true
      }
    ],
    "correctIndex": 0,
    "format": "DIRECT_CALCULATION",
    "difficulty": {
      "year": 4,
      "subLevel": 1,
      "displayName": "4.1",
      "cognitiveLoad": 40
    },
    "cognitiveLoad": 40,
    "curriculumTags": [
      "4N1a"
    ],
    "scenario": {
      "id": "default-4-1759232461381",
      "theme": "SHOPPING",
      "setting": {
        "location": "shop",
        "timeContext": "afternoon",
        "atmosphere": "friendly"
      },
      "characters": [
        {
          "name": "Michael",
          "role": "student"
        }
      ],
      "items": [
        {
          "name": "item",
          "category": "HOUSEHOLD_ITEMS",
          "typicalValue": {
            "min": 1,
            "max": 10,
            "typical": 5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        }
      ],
      "culturalElements": [
        {
          "type": "currency",
          "value": "£",
          "explanation": "British pounds"
        }
      ],
      "realWorldConnection": "Basic shopping calculations",
      "yearAppropriate": [
        4
      ],
      "templates": [
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "template": "{character} buys {article} {item} for {price}. How much does it cost?",
          "answerTemplate": "It costs {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        }
      ]
    },
    "distractors": [],
    "enhancementStatus": {
      "level": "partial",
      "requestedFormat": "DIRECT_CALCULATION",
      "actualFormat": "DIRECT_CALCULATION",
      "featuresActive": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "featuresPending": [],
      "isFullyEnhanced": true
    },
    "mathOutput": {
      "operation": "TIME_RATE",
      "rate": {
        "value": 24,
        "period": "week"
      }
    },
    "generationTime": 1,
    "questionId": "q_1759232461381_hder4vsxz",
    "generationSetup": {
      "controller_used": "DIRECT_CALCULATIONController",
      "format_requested": "DIRECT_CALCULATION",
      "format_actual": "DIRECT_CALCULATION",
      "scenario_theme": "SHOPPING",
      "scenario_id": "default-4-1759232461381",
      "scenario_selection_method": "default",
      "distractor_strategies": [],
      "distractor_count": 0,
      "theme_variety": false,
      "format_variety": false,
      "enhancement_level": "partial",
      "features_active": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "features_pending": [],
      "generation_time_ms": 1
    }
  },
  "metadata": {
    "format": "DIRECT_CALCULATION",
    "cognitive_load": 40,
    "curriculum_alignment": [
      "4N1a"
    ],
    "difficulty": "4.1",
    "scenario_theme": "SHOPPING",
    "distractor_strategies": [],
    "generation_time_ms": 1,
    "api_version": "2.0",
    "enhancement_status": "partial",
    "format_requested": "DIRECT_CALCULATION",
    "format_used": "DIRECT_CALCULATION",
    "features_active": [
      "enhanced_distractors",
      "rich_scenarios",
      "cognitive_load",
      "advanced_formats"
    ],
    "features_pending": []
  },
  "context": {
    "id": "default-4-1759232461381",
    "theme": "SHOPPING",
    "setting": {
      "location": "shop",
      "timeContext": "afternoon",
      "atmosphere": "friendly"
    },
    "characters": [
      {
        "name": "Michael",
        "role": "student"
      }
    ],
    "items": [
      {
        "name": "item",
        "category": "HOUSEHOLD_ITEMS",
        "typicalValue": {
          "min": 1,
          "max": 10,
          "typical": 5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      }
    ],
    "culturalElements": [
      {
        "type": "currency",
        "value": "£",
        "explanation": "British pounds"
      }
    ],
    "realWorldConnection": "Basic shopping calculations",
    "yearAppropriate": [
      4
    ],
    "templates": [
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "template": "{character} buys {article} {item} for {price}. How much does it cost?",
        "answerTemplate": "It costs {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      }
    ]
  }
}
# Test B.9: CONVERSION model
{
  "success": true,
  "question": {
    "text": "Olivia buys an item for £5. How much does it cost?",
    "options": [
      {
        "value": 0,
        "text": "0p",
        "isCorrect": true
      }
    ],
    "correctIndex": 0,
    "format": "DIRECT_CALCULATION",
    "difficulty": {
      "year": 4,
      "subLevel": 1,
      "displayName": "4.1",
      "cognitiveLoad": 40
    },
    "cognitiveLoad": 40,
    "curriculumTags": [
      "4N1a"
    ],
    "scenario": {
      "id": "default-4-1759232461433",
      "theme": "SHOPPING",
      "setting": {
        "location": "shop",
        "timeContext": "afternoon",
        "atmosphere": "friendly"
      },
      "characters": [
        {
          "name": "Olivia",
          "role": "student"
        }
      ],
      "items": [
        {
          "name": "item",
          "category": "HOUSEHOLD_ITEMS",
          "typicalValue": {
            "min": 1,
            "max": 10,
            "typical": 5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        }
      ],
      "culturalElements": [
        {
          "type": "currency",
          "value": "£",
          "explanation": "British pounds"
        }
      ],
      "realWorldConnection": "Basic shopping calculations",
      "yearAppropriate": [
        4
      ],
      "templates": [
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "template": "{character} buys {article} {item} for {price}. How much does it cost?",
          "answerTemplate": "It costs {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        }
      ]
    },
    "distractors": [],
    "enhancementStatus": {
      "level": "partial",
      "requestedFormat": "DIRECT_CALCULATION",
      "actualFormat": "DIRECT_CALCULATION",
      "featuresActive": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "featuresPending": [],
      "isFullyEnhanced": true
    },
    "mathOutput": {
      "operation": "CONVERSION",
      "original_value": 71,
      "converted_value": 7100,
      "conversion_factor": 100
    },
    "generationTime": 1,
    "questionId": "q_1759232461433_wzwpqgsim",
    "generationSetup": {
      "controller_used": "DIRECT_CALCULATIONController",
      "format_requested": "DIRECT_CALCULATION",
      "format_actual": "DIRECT_CALCULATION",
      "scenario_theme": "SHOPPING",
      "scenario_id": "default-4-1759232461433",
      "scenario_selection_method": "default",
      "distractor_strategies": [],
      "distractor_count": 0,
      "theme_variety": false,
      "format_variety": false,
      "enhancement_level": "partial",
      "features_active": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "features_pending": [],
      "generation_time_ms": 1
    }
  },
  "metadata": {
    "format": "DIRECT_CALCULATION",
    "cognitive_load": 40,
    "curriculum_alignment": [
      "4N1a"
    ],
    "difficulty": "4.1",
    "scenario_theme": "SHOPPING",
    "distractor_strategies": [],
    "generation_time_ms": 1,
    "api_version": "2.0",
    "enhancement_status": "partial",
    "format_requested": "DIRECT_CALCULATION",
    "format_used": "DIRECT_CALCULATION",
    "features_active": [
      "enhanced_distractors",
      "rich_scenarios",
      "cognitive_load",
      "advanced_formats"
    ],
    "features_pending": []
  },
  "context": {
    "id": "default-4-1759232461433",
    "theme": "SHOPPING",
    "setting": {
      "location": "shop",
      "timeContext": "afternoon",
      "atmosphere": "friendly"
    },
    "characters": [
      {
        "name": "Olivia",
        "role": "student"
      }
    ],
    "items": [
      {
        "name": "item",
        "category": "HOUSEHOLD_ITEMS",
        "typicalValue": {
          "min": 1,
          "max": 10,
          "typical": 5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      }
    ],
    "culturalElements": [
      {
        "type": "currency",
        "value": "£",
        "explanation": "British pounds"
      }
    ],
    "realWorldConnection": "Basic shopping calculations",
    "yearAppropriate": [
      4
    ],
    "templates": [
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "template": "{character} buys {article} {item} for {price}. How much does it cost?",
        "answerTemplate": "It costs {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      }
    ]
  }
}
# Test B.10: COMPARISON model
{
  "success": true,
  "question": {
    "text": "Sarah is comparing options to find the best value.\n\nOption A: £72.00\nOption B: £168.00\n\nWhich option offers better value?",
    "options": [
      {
        "text": "Both options are equally good value",
        "value": -1,
        "index": 0
      },
      {
        "text": "B is better value",
        "value": 1,
        "index": 1
      },
      {
        "text": "A is better value",
        "value": 0,
        "index": 2
      },
      {
        "text": "A saves you £192.00",
        "value": 0,
        "index": 3
      }
    ],
    "correctIndex": 2,
    "questionContent": {
      "fullText": "Sarah is comparing options to find the best value.\n\nOption A: £72.00\nOption B: £168.00\n\nWhich option offers better value?",
      "templateData": {
        "character": "Sarah",
        "optionA": "£72.00",
        "optionB": "£168.00",
        "context": "general",
        "comparisonType": "direct"
      }
    },
    "format": "COMPARISON",
    "difficulty": {
      "year": 4,
      "subLevel": 1,
      "displayName": "4.1",
      "cognitiveLoad": 40
    },
    "cognitiveLoad": 40,
    "curriculumTags": [
      "4N1a"
    ],
    "scenario": {
      "id": "shop-001-bookfair",
      "theme": "SHOPPING",
      "setting": {
        "location": "school book fair",
        "timeContext": "lunch break",
        "atmosphere": "busy"
      },
      "characters": [
        {
          "name": "Sarah",
          "role": "student"
        },
        {
          "name": "Mr. Johnson",
          "role": "teacher"
        }
      ],
      "items": [
        {
          "name": "book",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 3,
            "max": 12,
            "typical": 6.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "bookmark",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.5,
            "max": 2,
            "typical": 1,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        }
      ],
      "culturalElements": [
        {
          "type": "currency",
          "value": "£",
          "explanation": "British pounds"
        },
        {
          "type": "event",
          "value": "book fair",
          "explanation": "School fundraising event"
        }
      ],
      "realWorldConnection": "School fundraising and reading promotion",
      "yearAppropriate": [
        2,
        3,
        4,
        5
      ],
      "templates": [
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "COMPARISON"
          ],
          "modelCompatibility": [
            "ADDITION",
            "COUNTING"
          ],
          "template": "{character} wants to buy books at the book fair. Calculate the total cost.",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        }
      ]
    },
    "distractors": [
      {
        "value": 1,
        "displayText": "B is better value",
        "strategy": "REVERSED_COMPARISON",
        "reasoning": "Selected the option with lower value"
      },
      {
        "value": -1,
        "displayText": "Both options are equally good value",
        "strategy": "WRONG_SELECTION",
        "reasoning": "Failed to calculate the difference correctly"
      },
      {
        "value": 0,
        "displayText": "A saves you £192.00",
        "strategy": "CALCULATION_ERROR",
        "reasoning": "Arithmetic error in calculating the difference"
      }
    ],
    "enhancementStatus": {
      "level": "full",
      "requestedFormat": "COMPARISON",
      "actualFormat": "COMPARISON",
      "featuresActive": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "featuresPending": [],
      "isFullyEnhanced": true
    },
    "mathOutput": {
      "operation": "COMPARISON",
      "option_1_value": 72,
      "option_1_price": 72,
      "option_2_value": 168,
      "option_2_price": 168
    },
    "generationTime": 2,
    "questionId": "q_1759232461478_4skwq2dma",
    "generationSetup": {
      "controller_used": "COMPARISONController",
      "format_requested": "COMPARISON",
      "format_actual": "COMPARISON",
      "scenario_theme": "SHOPPING",
      "scenario_id": "shop-001-bookfair",
      "scenario_selection_method": "default",
      "distractor_strategies": [
        "REVERSED_COMPARISON",
        "WRONG_SELECTION",
        "CALCULATION_ERROR"
      ],
      "distractor_count": 3,
      "theme_variety": false,
      "format_variety": false,
      "enhancement_level": "full",
      "features_active": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "features_pending": [],
      "generation_time_ms": 2
    }
  },
  "metadata": {
    "format": "COMPARISON",
    "cognitive_load": 40,
    "curriculum_alignment": [
      "4N1a"
    ],
    "difficulty": "4.1",
    "scenario_theme": "SHOPPING",
    "distractor_strategies": [
      "REVERSED_COMPARISON",
      "WRONG_SELECTION",
      "CALCULATION_ERROR"
    ],
    "generation_time_ms": 2,
    "api_version": "2.0",
    "enhancement_status": "full",
    "format_requested": "COMPARISON",
    "format_used": "COMPARISON",
    "features_active": [
      "enhanced_distractors",
      "rich_scenarios",
      "cognitive_load",
      "advanced_formats"
    ],
    "features_pending": []
  },
  "context": {
    "id": "shop-001-bookfair",
    "theme": "SHOPPING",
    "setting": {
      "location": "school book fair",
      "timeContext": "lunch break",
      "atmosphere": "busy"
    },
    "characters": [
      {
        "name": "Sarah",
        "role": "student"
      },
      {
        "name": "Mr. Johnson",
        "role": "teacher"
      }
    ],
    "items": [
      {
        "name": "book",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 3,
          "max": 12,
          "typical": 6.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "bookmark",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.5,
          "max": 2,
          "typical": 1,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      }
    ],
    "culturalElements": [
      {
        "type": "currency",
        "value": "£",
        "explanation": "British pounds"
      },
      {
        "type": "event",
        "value": "book fair",
        "explanation": "School fundraising event"
      }
    ],
    "realWorldConnection": "School fundraising and reading promotion",
    "yearAppropriate": [
      2,
      3,
      4,
      5
    ],
    "templates": [
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "COMPARISON"
        ],
        "modelCompatibility": [
          "ADDITION",
          "COUNTING"
        ],
        "template": "{character} wants to buy books at the book fair. Calculate the total cost.",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      }
    ]
  }
}
# Test B.11: MULTI_STEP model
{
  "success": true,
  "question": {
    "text": "Logan goes to the shop and buys apple, banana, sandwich, drink, cake, biscuit, sweet, chocolate, pen, pencil, ruler, notebook, eraser, book, comic, magazine, toy, game, puzzle, sticker, badge, poster, card. How much does Logan spend in total?",
    "options": [
      {
        "text": "£76.00",
        "value": 76,
        "index": 0
      },
      {
        "text": "75",
        "value": 75,
        "index": 1
      },
      {
        "text": "77",
        "value": 77,
        "index": 2
      },
      {
        "text": "38",
        "value": 38,
        "index": 3
      }
    ],
    "correctIndex": 0,
    "format": "DIRECT_CALCULATION",
    "difficulty": {
      "year": 4,
      "subLevel": 1,
      "displayName": "4.1",
      "cognitiveLoad": 40
    },
    "cognitiveLoad": 40,
    "curriculumTags": [
      "4N1a"
    ],
    "scenario": {
      "id": "shop-002-realistic-general",
      "theme": "SHOPPING",
      "setting": {
        "location": "local shop",
        "timeContext": "after school",
        "atmosphere": "friendly"
      },
      "characters": [
        {
          "name": "Logan",
          "role": "student"
        }
      ],
      "items": [
        {
          "name": "apple",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.2,
            "max": 0.5,
            "typical": 0.35,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "banana",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.15,
            "max": 0.4,
            "typical": 0.25,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sandwich",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 2.5,
            "max": 6,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "drink",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.8,
            "max": 2.5,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "cake",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 1.5,
            "max": 4,
            "typical": 2.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "biscuit",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.8,
            "max": 2,
            "typical": 1.2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sweet",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.1,
            "max": 1,
            "typical": 0.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "chocolate",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.6,
            "max": 3,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "pen",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.5,
            "max": 2,
            "typical": 1,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "pencil",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.2,
            "max": 1,
            "typical": 0.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "ruler",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.8,
            "max": 2.5,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "notebook",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 1,
            "max": 4,
            "typical": 2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "eraser",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.3,
            "max": 1.5,
            "typical": 0.75,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "book",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 3,
            "max": 15,
            "typical": 8,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "comic",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2,
            "max": 5,
            "typical": 3,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "magazine",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2.5,
            "max": 6,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "toy",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 5,
            "max": 25,
            "typical": 12,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "game",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 8,
            "max": 60,
            "typical": 25,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "puzzle",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 5,
            "max": 20,
            "typical": 12,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sticker",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 0.2,
            "max": 2,
            "typical": 0.8,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "badge",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 0.5,
            "max": 3,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "poster",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2,
            "max": 8,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "card",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 0.5,
            "max": 4,
            "typical": 2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        }
      ],
      "culturalElements": [
        {
          "type": "currency",
          "value": "£",
          "explanation": "British pounds"
        },
        {
          "type": "location",
          "value": "UK local shop",
          "explanation": "Typical British corner shop"
        }
      ],
      "realWorldConnection": "Everyday shopping with realistic UK prices",
      "yearAppropriate": [
        1,
        2,
        3,
        4,
        5,
        6
      ],
      "templates": [
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "MULTI_STEP"
          ],
          "modelCompatibility": [
            "ADDITION"
          ],
          "operandCount": 3,
          "template": "{character} buys {article1} {item1} for {price1}, {article2} {item2} for {price2}, and {article3} {item3} for {price3}. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item1",
              "type": "item"
            },
            {
              "key": "item2",
              "type": "item"
            },
            {
              "key": "item3",
              "type": "item"
            },
            {
              "key": "price1",
              "type": "value"
            },
            {
              "key": "price2",
              "type": "value"
            },
            {
              "key": "price3",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "MULTI_STEP"
          ],
          "modelCompatibility": [
            "ADDITION"
          ],
          "operandCount": 2,
          "template": "{character} buys {article1} {item1} for {price1} and {article2} {item2} for {price2}. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item1",
              "type": "item"
            },
            {
              "key": "item2",
              "type": "item"
            },
            {
              "key": "price1",
              "type": "value"
            },
            {
              "key": "price2",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "SUBTRACTION",
            "CHANGE_CALCULATION"
          ],
          "template": "{character} buys {article} {item} for {price} and pays with {payment}. How much change does {character} get?",
          "answerTemplate": "{character} receives {result} in change",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "payment",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "MULTIPLICATION"
          ],
          "template": "{character} buys {quantity} {item} at {price} each. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "quantity",
              "type": "value"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "DIVISION"
          ],
          "template": "{character} has {total} to spend equally on {quantity} {item}. How much can {character} spend on each one?",
          "answerTemplate": "{character} can spend {result} on each {item}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "total",
              "type": "value"
            },
            {
              "key": "quantity",
              "type": "value"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "COMPARISON",
            "ESTIMATION",
            "MULTI_STEP"
          ],
          "template": "{character} goes to the shop and buys {items}. How much does {character} spend in total?",
          "answerTemplate": "{character} spends {result} in total",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "ESTIMATION"
          ],
          "template": "Estimate: If {character} buys {items}, about how much will it cost?",
          "answerTemplate": "It will cost approximately {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "VALIDATION"
          ],
          "template": "{character} calculated that {items} costs {amount}. Is this correct?",
          "answerTemplate": "{validation_result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "amount",
              "type": "value"
            },
            {
              "key": "validation_result",
              "type": "boolean"
            }
          ]
        }
      ]
    },
    "distractors": [
      {
        "value": 77,
        "strategy": "CLOSE_VALUE",
        "displayText": "77",
        "reasoning": "Off by one"
      },
      {
        "value": 75,
        "strategy": "CLOSE_VALUE",
        "displayText": "75",
        "reasoning": "Off by one (lower)"
      },
      {
        "value": 38,
        "displayText": "38",
        "reasoning": "Half the correct value"
      }
    ],
    "enhancementStatus": {
      "level": "partial",
      "requestedFormat": "DIRECT_CALCULATION",
      "actualFormat": "DIRECT_CALCULATION",
      "featuresActive": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "featuresPending": [],
      "isFullyEnhanced": true
    },
    "mathOutput": {
      "operation": "MULTI_STEP",
      "step_1_result": 9,
      "step_2_result": 39,
      "step_3_result": 76
    },
    "generationTime": 1,
    "questionId": "q_1759232461524_qpifchhuf",
    "generationSetup": {
      "controller_used": "DIRECT_CALCULATIONController",
      "format_requested": "DIRECT_CALCULATION",
      "format_actual": "DIRECT_CALCULATION",
      "scenario_theme": "SHOPPING",
      "scenario_id": "shop-002-realistic-general",
      "scenario_selection_method": "default",
      "distractor_strategies": [
        "CLOSE_VALUE",
        "CLOSE_VALUE",
        null
      ],
      "distractor_count": 3,
      "theme_variety": false,
      "format_variety": false,
      "enhancement_level": "partial",
      "features_active": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "features_pending": [],
      "generation_time_ms": 1
    }
  },
  "metadata": {
    "format": "DIRECT_CALCULATION",
    "cognitive_load": 40,
    "curriculum_alignment": [
      "4N1a"
    ],
    "difficulty": "4.1",
    "scenario_theme": "SHOPPING",
    "distractor_strategies": [
      "CLOSE_VALUE",
      "CLOSE_VALUE",
      null
    ],
    "generation_time_ms": 1,
    "api_version": "2.0",
    "enhancement_status": "partial",
    "format_requested": "DIRECT_CALCULATION",
    "format_used": "DIRECT_CALCULATION",
    "features_active": [
      "enhanced_distractors",
      "rich_scenarios",
      "cognitive_load",
      "advanced_formats"
    ],
    "features_pending": []
  },
  "context": {
    "id": "shop-002-realistic-general",
    "theme": "SHOPPING",
    "setting": {
      "location": "local shop",
      "timeContext": "after school",
      "atmosphere": "friendly"
    },
    "characters": [
      {
        "name": "Logan",
        "role": "student"
      }
    ],
    "items": [
      {
        "name": "apple",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.2,
          "max": 0.5,
          "typical": 0.35,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "banana",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.15,
          "max": 0.4,
          "typical": 0.25,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sandwich",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 2.5,
          "max": 6,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "drink",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.8,
          "max": 2.5,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "cake",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 1.5,
          "max": 4,
          "typical": 2.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "biscuit",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.8,
          "max": 2,
          "typical": 1.2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sweet",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.1,
          "max": 1,
          "typical": 0.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "chocolate",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.6,
          "max": 3,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "pen",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.5,
          "max": 2,
          "typical": 1,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "pencil",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.2,
          "max": 1,
          "typical": 0.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "ruler",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.8,
          "max": 2.5,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "notebook",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 1,
          "max": 4,
          "typical": 2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "eraser",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.3,
          "max": 1.5,
          "typical": 0.75,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "book",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 3,
          "max": 15,
          "typical": 8,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "comic",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2,
          "max": 5,
          "typical": 3,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "magazine",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2.5,
          "max": 6,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "toy",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 5,
          "max": 25,
          "typical": 12,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "game",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 8,
          "max": 60,
          "typical": 25,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "puzzle",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 5,
          "max": 20,
          "typical": 12,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sticker",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 0.2,
          "max": 2,
          "typical": 0.8,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "badge",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 0.5,
          "max": 3,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "poster",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2,
          "max": 8,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "card",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 0.5,
          "max": 4,
          "typical": 2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      }
    ],
    "culturalElements": [
      {
        "type": "currency",
        "value": "£",
        "explanation": "British pounds"
      },
      {
        "type": "location",
        "value": "UK local shop",
        "explanation": "Typical British corner shop"
      }
    ],
    "realWorldConnection": "Everyday shopping with realistic UK prices",
    "yearAppropriate": [
      1,
      2,
      3,
      4,
      5,
      6
    ],
    "templates": [
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "MULTI_STEP"
        ],
        "modelCompatibility": [
          "ADDITION"
        ],
        "operandCount": 3,
        "template": "{character} buys {article1} {item1} for {price1}, {article2} {item2} for {price2}, and {article3} {item3} for {price3}. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item1",
            "type": "item"
          },
          {
            "key": "item2",
            "type": "item"
          },
          {
            "key": "item3",
            "type": "item"
          },
          {
            "key": "price1",
            "type": "value"
          },
          {
            "key": "price2",
            "type": "value"
          },
          {
            "key": "price3",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "MULTI_STEP"
        ],
        "modelCompatibility": [
          "ADDITION"
        ],
        "operandCount": 2,
        "template": "{character} buys {article1} {item1} for {price1} and {article2} {item2} for {price2}. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item1",
            "type": "item"
          },
          {
            "key": "item2",
            "type": "item"
          },
          {
            "key": "price1",
            "type": "value"
          },
          {
            "key": "price2",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "SUBTRACTION",
          "CHANGE_CALCULATION"
        ],
        "template": "{character} buys {article} {item} for {price} and pays with {payment}. How much change does {character} get?",
        "answerTemplate": "{character} receives {result} in change",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "payment",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "MULTIPLICATION"
        ],
        "template": "{character} buys {quantity} {item} at {price} each. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "quantity",
            "type": "value"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "DIVISION"
        ],
        "template": "{character} has {total} to spend equally on {quantity} {item}. How much can {character} spend on each one?",
        "answerTemplate": "{character} can spend {result} on each {item}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "total",
            "type": "value"
          },
          {
            "key": "quantity",
            "type": "value"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "COMPARISON",
          "ESTIMATION",
          "MULTI_STEP"
        ],
        "template": "{character} goes to the shop and buys {items}. How much does {character} spend in total?",
        "answerTemplate": "{character} spends {result} in total",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "ESTIMATION"
        ],
        "template": "Estimate: If {character} buys {items}, about how much will it cost?",
        "answerTemplate": "It will cost approximately {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "VALIDATION"
        ],
        "template": "{character} calculated that {items} costs {amount}. Is this correct?",
        "answerTemplate": "{validation_result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "amount",
            "type": "value"
          },
          {
            "key": "validation_result",
            "type": "boolean"
          }
        ]
      }
    ]
  }
}
# Test B.12: LINEAR_EQUATION model
{
  "error": "Model LINEAR_EQUATION is currently disabled",
  "status": "broken",
  "reason": "Template generation issues, Under testing phase"
}
# Test B.13: UNIT_RATE model
{
  "success": true,
  "question": {
    "text": "Logan goes to the shop and buys apple, banana, sandwich, drink, cake, biscuit, sweet, chocolate, pen, pencil, ruler, notebook, eraser, book, comic, magazine, toy, game, puzzle, sticker, badge, poster, card. How much does Logan spend in total?",
    "options": [
      {
        "value": 0,
        "text": "0p",
        "isCorrect": true
      }
    ],
    "correctIndex": 0,
    "format": "DIRECT_CALCULATION",
    "difficulty": {
      "year": 4,
      "subLevel": 1,
      "displayName": "4.1",
      "cognitiveLoad": 40
    },
    "cognitiveLoad": 40,
    "curriculumTags": [
      "4N1a"
    ],
    "scenario": {
      "id": "shop-002-realistic-general",
      "theme": "SHOPPING",
      "setting": {
        "location": "local shop",
        "timeContext": "after school",
        "atmosphere": "friendly"
      },
      "characters": [
        {
          "name": "Logan",
          "role": "student"
        }
      ],
      "items": [
        {
          "name": "apple",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.2,
            "max": 0.5,
            "typical": 0.35,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "banana",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.15,
            "max": 0.4,
            "typical": 0.25,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sandwich",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 2.5,
            "max": 6,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "drink",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.8,
            "max": 2.5,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "cake",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 1.5,
            "max": 4,
            "typical": 2.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "biscuit",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.8,
            "max": 2,
            "typical": 1.2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sweet",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.1,
            "max": 1,
            "typical": 0.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "chocolate",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.6,
            "max": 3,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "pen",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.5,
            "max": 2,
            "typical": 1,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "pencil",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.2,
            "max": 1,
            "typical": 0.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "ruler",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.8,
            "max": 2.5,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "notebook",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 1,
            "max": 4,
            "typical": 2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "eraser",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.3,
            "max": 1.5,
            "typical": 0.75,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "book",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 3,
            "max": 15,
            "typical": 8,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "comic",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2,
            "max": 5,
            "typical": 3,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "magazine",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2.5,
            "max": 6,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "toy",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 5,
            "max": 25,
            "typical": 12,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "game",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 8,
            "max": 60,
            "typical": 25,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "puzzle",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 5,
            "max": 20,
            "typical": 12,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sticker",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 0.2,
            "max": 2,
            "typical": 0.8,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "badge",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 0.5,
            "max": 3,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "poster",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2,
            "max": 8,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "card",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 0.5,
            "max": 4,
            "typical": 2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        }
      ],
      "culturalElements": [
        {
          "type": "currency",
          "value": "£",
          "explanation": "British pounds"
        },
        {
          "type": "location",
          "value": "UK local shop",
          "explanation": "Typical British corner shop"
        }
      ],
      "realWorldConnection": "Everyday shopping with realistic UK prices",
      "yearAppropriate": [
        1,
        2,
        3,
        4,
        5,
        6
      ],
      "templates": [
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "MULTI_STEP"
          ],
          "modelCompatibility": [
            "ADDITION"
          ],
          "operandCount": 3,
          "template": "{character} buys {article1} {item1} for {price1}, {article2} {item2} for {price2}, and {article3} {item3} for {price3}. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item1",
              "type": "item"
            },
            {
              "key": "item2",
              "type": "item"
            },
            {
              "key": "item3",
              "type": "item"
            },
            {
              "key": "price1",
              "type": "value"
            },
            {
              "key": "price2",
              "type": "value"
            },
            {
              "key": "price3",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "MULTI_STEP"
          ],
          "modelCompatibility": [
            "ADDITION"
          ],
          "operandCount": 2,
          "template": "{character} buys {article1} {item1} for {price1} and {article2} {item2} for {price2}. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item1",
              "type": "item"
            },
            {
              "key": "item2",
              "type": "item"
            },
            {
              "key": "price1",
              "type": "value"
            },
            {
              "key": "price2",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "SUBTRACTION",
            "CHANGE_CALCULATION"
          ],
          "template": "{character} buys {article} {item} for {price} and pays with {payment}. How much change does {character} get?",
          "answerTemplate": "{character} receives {result} in change",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "payment",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "MULTIPLICATION"
          ],
          "template": "{character} buys {quantity} {item} at {price} each. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "quantity",
              "type": "value"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "DIVISION"
          ],
          "template": "{character} has {total} to spend equally on {quantity} {item}. How much can {character} spend on each one?",
          "answerTemplate": "{character} can spend {result} on each {item}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "total",
              "type": "value"
            },
            {
              "key": "quantity",
              "type": "value"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "COMPARISON",
            "ESTIMATION",
            "MULTI_STEP"
          ],
          "template": "{character} goes to the shop and buys {items}. How much does {character} spend in total?",
          "answerTemplate": "{character} spends {result} in total",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "ESTIMATION"
          ],
          "template": "Estimate: If {character} buys {items}, about how much will it cost?",
          "answerTemplate": "It will cost approximately {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "VALIDATION"
          ],
          "template": "{character} calculated that {items} costs {amount}. Is this correct?",
          "answerTemplate": "{validation_result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "amount",
              "type": "value"
            },
            {
              "key": "validation_result",
              "type": "boolean"
            }
          ]
        }
      ]
    },
    "distractors": [],
    "enhancementStatus": {
      "level": "partial",
      "requestedFormat": "DIRECT_CALCULATION",
      "actualFormat": "DIRECT_CALCULATION",
      "featuresActive": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "featuresPending": [],
      "isFullyEnhanced": true
    },
    "mathOutput": {
      "operation": "UNIT_RATE"
    },
    "generationTime": 1,
    "questionId": "q_1759232461614_ag8w0u72p",
    "generationSetup": {
      "controller_used": "DIRECT_CALCULATIONController",
      "format_requested": "DIRECT_CALCULATION",
      "format_actual": "DIRECT_CALCULATION",
      "scenario_theme": "SHOPPING",
      "scenario_id": "shop-002-realistic-general",
      "scenario_selection_method": "default",
      "distractor_strategies": [],
      "distractor_count": 0,
      "theme_variety": false,
      "format_variety": false,
      "enhancement_level": "partial",
      "features_active": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "features_pending": [],
      "generation_time_ms": 1
    }
  },
  "metadata": {
    "format": "DIRECT_CALCULATION",
    "cognitive_load": 40,
    "curriculum_alignment": [
      "4N1a"
    ],
    "difficulty": "4.1",
    "scenario_theme": "SHOPPING",
    "distractor_strategies": [],
    "generation_time_ms": 1,
    "api_version": "2.0",
    "enhancement_status": "partial",
    "format_requested": "DIRECT_CALCULATION",
    "format_used": "DIRECT_CALCULATION",
    "features_active": [
      "enhanced_distractors",
      "rich_scenarios",
      "cognitive_load",
      "advanced_formats"
    ],
    "features_pending": []
  },
  "context": {
    "id": "shop-002-realistic-general",
    "theme": "SHOPPING",
    "setting": {
      "location": "local shop",
      "timeContext": "after school",
      "atmosphere": "friendly"
    },
    "characters": [
      {
        "name": "Logan",
        "role": "student"
      }
    ],
    "items": [
      {
        "name": "apple",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.2,
          "max": 0.5,
          "typical": 0.35,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "banana",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.15,
          "max": 0.4,
          "typical": 0.25,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sandwich",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 2.5,
          "max": 6,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "drink",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.8,
          "max": 2.5,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "cake",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 1.5,
          "max": 4,
          "typical": 2.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "biscuit",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.8,
          "max": 2,
          "typical": 1.2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sweet",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.1,
          "max": 1,
          "typical": 0.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "chocolate",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.6,
          "max": 3,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "pen",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.5,
          "max": 2,
          "typical": 1,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "pencil",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.2,
          "max": 1,
          "typical": 0.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "ruler",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.8,
          "max": 2.5,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "notebook",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 1,
          "max": 4,
          "typical": 2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "eraser",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.3,
          "max": 1.5,
          "typical": 0.75,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "book",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 3,
          "max": 15,
          "typical": 8,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "comic",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2,
          "max": 5,
          "typical": 3,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "magazine",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2.5,
          "max": 6,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "toy",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 5,
          "max": 25,
          "typical": 12,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "game",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 8,
          "max": 60,
          "typical": 25,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "puzzle",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 5,
          "max": 20,
          "typical": 12,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sticker",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 0.2,
          "max": 2,
          "typical": 0.8,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "badge",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 0.5,
          "max": 3,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "poster",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2,
          "max": 8,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "card",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 0.5,
          "max": 4,
          "typical": 2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      }
    ],
    "culturalElements": [
      {
        "type": "currency",
        "value": "£",
        "explanation": "British pounds"
      },
      {
        "type": "location",
        "value": "UK local shop",
        "explanation": "Typical British corner shop"
      }
    ],
    "realWorldConnection": "Everyday shopping with realistic UK prices",
    "yearAppropriate": [
      1,
      2,
      3,
      4,
      5,
      6
    ],
    "templates": [
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "MULTI_STEP"
        ],
        "modelCompatibility": [
          "ADDITION"
        ],
        "operandCount": 3,
        "template": "{character} buys {article1} {item1} for {price1}, {article2} {item2} for {price2}, and {article3} {item3} for {price3}. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item1",
            "type": "item"
          },
          {
            "key": "item2",
            "type": "item"
          },
          {
            "key": "item3",
            "type": "item"
          },
          {
            "key": "price1",
            "type": "value"
          },
          {
            "key": "price2",
            "type": "value"
          },
          {
            "key": "price3",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "MULTI_STEP"
        ],
        "modelCompatibility": [
          "ADDITION"
        ],
        "operandCount": 2,
        "template": "{character} buys {article1} {item1} for {price1} and {article2} {item2} for {price2}. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item1",
            "type": "item"
          },
          {
            "key": "item2",
            "type": "item"
          },
          {
            "key": "price1",
            "type": "value"
          },
          {
            "key": "price2",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "SUBTRACTION",
          "CHANGE_CALCULATION"
        ],
        "template": "{character} buys {article} {item} for {price} and pays with {payment}. How much change does {character} get?",
        "answerTemplate": "{character} receives {result} in change",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "payment",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "MULTIPLICATION"
        ],
        "template": "{character} buys {quantity} {item} at {price} each. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "quantity",
            "type": "value"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "DIVISION"
        ],
        "template": "{character} has {total} to spend equally on {quantity} {item}. How much can {character} spend on each one?",
        "answerTemplate": "{character} can spend {result} on each {item}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "total",
            "type": "value"
          },
          {
            "key": "quantity",
            "type": "value"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "COMPARISON",
          "ESTIMATION",
          "MULTI_STEP"
        ],
        "template": "{character} goes to the shop and buys {items}. How much does {character} spend in total?",
        "answerTemplate": "{character} spends {result} in total",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "ESTIMATION"
        ],
        "template": "Estimate: If {character} buys {items}, about how much will it cost?",
        "answerTemplate": "It will cost approximately {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "VALIDATION"
        ],
        "template": "{character} calculated that {items} costs {amount}. Is this correct?",
        "answerTemplate": "{validation_result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "amount",
            "type": "value"
          },
          {
            "key": "validation_result",
            "type": "boolean"
          }
        ]
      }
    ]
  }
}
# Test B.14: COIN_RECOGNITION model
{
  "success": true,
  "question": {
    "text": "Logan goes to the shop and buys apple, banana, sandwich, drink, cake, biscuit, sweet, chocolate, pen, pencil, ruler, notebook, eraser, book, comic, magazine, toy, game, puzzle, sticker, badge, poster, card. How much does Logan spend in total?",
    "options": [
      {
        "value": 0,
        "text": "0p",
        "isCorrect": true
      }
    ],
    "correctIndex": 0,
    "format": "DIRECT_CALCULATION",
    "difficulty": {
      "year": 4,
      "subLevel": 1,
      "displayName": "4.1",
      "cognitiveLoad": 40
    },
    "cognitiveLoad": 40,
    "curriculumTags": [
      "4N1a"
    ],
    "scenario": {
      "id": "shop-002-realistic-general",
      "theme": "SHOPPING",
      "setting": {
        "location": "local shop",
        "timeContext": "after school",
        "atmosphere": "friendly"
      },
      "characters": [
        {
          "name": "Logan",
          "role": "student"
        }
      ],
      "items": [
        {
          "name": "apple",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.2,
            "max": 0.5,
            "typical": 0.35,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "banana",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.15,
            "max": 0.4,
            "typical": 0.25,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sandwich",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 2.5,
            "max": 6,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "drink",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.8,
            "max": 2.5,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "cake",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 1.5,
            "max": 4,
            "typical": 2.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "biscuit",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.8,
            "max": 2,
            "typical": 1.2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sweet",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.1,
            "max": 1,
            "typical": 0.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "chocolate",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.6,
            "max": 3,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "pen",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.5,
            "max": 2,
            "typical": 1,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "pencil",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.2,
            "max": 1,
            "typical": 0.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "ruler",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.8,
            "max": 2.5,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "notebook",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 1,
            "max": 4,
            "typical": 2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "eraser",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.3,
            "max": 1.5,
            "typical": 0.75,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "book",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 3,
            "max": 15,
            "typical": 8,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "comic",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2,
            "max": 5,
            "typical": 3,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "magazine",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2.5,
            "max": 6,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "toy",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 5,
            "max": 25,
            "typical": 12,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "game",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 8,
            "max": 60,
            "typical": 25,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "puzzle",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 5,
            "max": 20,
            "typical": 12,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sticker",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 0.2,
            "max": 2,
            "typical": 0.8,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "badge",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 0.5,
            "max": 3,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "poster",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2,
            "max": 8,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "card",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 0.5,
            "max": 4,
            "typical": 2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        }
      ],
      "culturalElements": [
        {
          "type": "currency",
          "value": "£",
          "explanation": "British pounds"
        },
        {
          "type": "location",
          "value": "UK local shop",
          "explanation": "Typical British corner shop"
        }
      ],
      "realWorldConnection": "Everyday shopping with realistic UK prices",
      "yearAppropriate": [
        1,
        2,
        3,
        4,
        5,
        6
      ],
      "templates": [
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "MULTI_STEP"
          ],
          "modelCompatibility": [
            "ADDITION"
          ],
          "operandCount": 3,
          "template": "{character} buys {article1} {item1} for {price1}, {article2} {item2} for {price2}, and {article3} {item3} for {price3}. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item1",
              "type": "item"
            },
            {
              "key": "item2",
              "type": "item"
            },
            {
              "key": "item3",
              "type": "item"
            },
            {
              "key": "price1",
              "type": "value"
            },
            {
              "key": "price2",
              "type": "value"
            },
            {
              "key": "price3",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "MULTI_STEP"
          ],
          "modelCompatibility": [
            "ADDITION"
          ],
          "operandCount": 2,
          "template": "{character} buys {article1} {item1} for {price1} and {article2} {item2} for {price2}. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item1",
              "type": "item"
            },
            {
              "key": "item2",
              "type": "item"
            },
            {
              "key": "price1",
              "type": "value"
            },
            {
              "key": "price2",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "SUBTRACTION",
            "CHANGE_CALCULATION"
          ],
          "template": "{character} buys {article} {item} for {price} and pays with {payment}. How much change does {character} get?",
          "answerTemplate": "{character} receives {result} in change",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "payment",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "MULTIPLICATION"
          ],
          "template": "{character} buys {quantity} {item} at {price} each. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "quantity",
              "type": "value"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "DIVISION"
          ],
          "template": "{character} has {total} to spend equally on {quantity} {item}. How much can {character} spend on each one?",
          "answerTemplate": "{character} can spend {result} on each {item}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "total",
              "type": "value"
            },
            {
              "key": "quantity",
              "type": "value"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "COMPARISON",
            "ESTIMATION",
            "MULTI_STEP"
          ],
          "template": "{character} goes to the shop and buys {items}. How much does {character} spend in total?",
          "answerTemplate": "{character} spends {result} in total",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "ESTIMATION"
          ],
          "template": "Estimate: If {character} buys {items}, about how much will it cost?",
          "answerTemplate": "It will cost approximately {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "VALIDATION"
          ],
          "template": "{character} calculated that {items} costs {amount}. Is this correct?",
          "answerTemplate": "{validation_result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "amount",
              "type": "value"
            },
            {
              "key": "validation_result",
              "type": "boolean"
            }
          ]
        }
      ]
    },
    "distractors": [],
    "enhancementStatus": {
      "level": "partial",
      "requestedFormat": "DIRECT_CALCULATION",
      "actualFormat": "DIRECT_CALCULATION",
      "featuresActive": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "featuresPending": [],
      "isFullyEnhanced": true
    },
    "mathOutput": {
      "operation": "COIN_RECOGNITION",
      "total_value": 2000
    },
    "generationTime": 0,
    "questionId": "q_1759232461675_xzsajcqbx",
    "generationSetup": {
      "controller_used": "DIRECT_CALCULATIONController",
      "format_requested": "DIRECT_CALCULATION",
      "format_actual": "DIRECT_CALCULATION",
      "scenario_theme": "SHOPPING",
      "scenario_id": "shop-002-realistic-general",
      "scenario_selection_method": "default",
      "distractor_strategies": [],
      "distractor_count": 0,
      "theme_variety": false,
      "format_variety": false,
      "enhancement_level": "partial",
      "features_active": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "features_pending": [],
      "generation_time_ms": 0
    }
  },
  "metadata": {
    "format": "DIRECT_CALCULATION",
    "cognitive_load": 40,
    "curriculum_alignment": [
      "4N1a"
    ],
    "difficulty": "4.1",
    "scenario_theme": "SHOPPING",
    "distractor_strategies": [],
    "generation_time_ms": 0,
    "api_version": "2.0",
    "enhancement_status": "partial",
    "format_requested": "DIRECT_CALCULATION",
    "format_used": "DIRECT_CALCULATION",
    "features_active": [
      "enhanced_distractors",
      "rich_scenarios",
      "cognitive_load",
      "advanced_formats"
    ],
    "features_pending": []
  },
  "context": {
    "id": "shop-002-realistic-general",
    "theme": "SHOPPING",
    "setting": {
      "location": "local shop",
      "timeContext": "after school",
      "atmosphere": "friendly"
    },
    "characters": [
      {
        "name": "Logan",
        "role": "student"
      }
    ],
    "items": [
      {
        "name": "apple",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.2,
          "max": 0.5,
          "typical": 0.35,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "banana",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.15,
          "max": 0.4,
          "typical": 0.25,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sandwich",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 2.5,
          "max": 6,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "drink",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.8,
          "max": 2.5,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "cake",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 1.5,
          "max": 4,
          "typical": 2.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "biscuit",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.8,
          "max": 2,
          "typical": 1.2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sweet",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.1,
          "max": 1,
          "typical": 0.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "chocolate",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.6,
          "max": 3,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "pen",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.5,
          "max": 2,
          "typical": 1,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "pencil",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.2,
          "max": 1,
          "typical": 0.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "ruler",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.8,
          "max": 2.5,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "notebook",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 1,
          "max": 4,
          "typical": 2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "eraser",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.3,
          "max": 1.5,
          "typical": 0.75,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "book",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 3,
          "max": 15,
          "typical": 8,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "comic",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2,
          "max": 5,
          "typical": 3,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "magazine",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2.5,
          "max": 6,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "toy",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 5,
          "max": 25,
          "typical": 12,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "game",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 8,
          "max": 60,
          "typical": 25,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "puzzle",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 5,
          "max": 20,
          "typical": 12,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sticker",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 0.2,
          "max": 2,
          "typical": 0.8,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "badge",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 0.5,
          "max": 3,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "poster",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2,
          "max": 8,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "card",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 0.5,
          "max": 4,
          "typical": 2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      }
    ],
    "culturalElements": [
      {
        "type": "currency",
        "value": "£",
        "explanation": "British pounds"
      },
      {
        "type": "location",
        "value": "UK local shop",
        "explanation": "Typical British corner shop"
      }
    ],
    "realWorldConnection": "Everyday shopping with realistic UK prices",
    "yearAppropriate": [
      1,
      2,
      3,
      4,
      5,
      6
    ],
    "templates": [
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "MULTI_STEP"
        ],
        "modelCompatibility": [
          "ADDITION"
        ],
        "operandCount": 3,
        "template": "{character} buys {article1} {item1} for {price1}, {article2} {item2} for {price2}, and {article3} {item3} for {price3}. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item1",
            "type": "item"
          },
          {
            "key": "item2",
            "type": "item"
          },
          {
            "key": "item3",
            "type": "item"
          },
          {
            "key": "price1",
            "type": "value"
          },
          {
            "key": "price2",
            "type": "value"
          },
          {
            "key": "price3",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "MULTI_STEP"
        ],
        "modelCompatibility": [
          "ADDITION"
        ],
        "operandCount": 2,
        "template": "{character} buys {article1} {item1} for {price1} and {article2} {item2} for {price2}. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item1",
            "type": "item"
          },
          {
            "key": "item2",
            "type": "item"
          },
          {
            "key": "price1",
            "type": "value"
          },
          {
            "key": "price2",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "SUBTRACTION",
          "CHANGE_CALCULATION"
        ],
        "template": "{character} buys {article} {item} for {price} and pays with {payment}. How much change does {character} get?",
        "answerTemplate": "{character} receives {result} in change",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "payment",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "MULTIPLICATION"
        ],
        "template": "{character} buys {quantity} {item} at {price} each. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "quantity",
            "type": "value"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "DIVISION"
        ],
        "template": "{character} has {total} to spend equally on {quantity} {item}. How much can {character} spend on each one?",
        "answerTemplate": "{character} can spend {result} on each {item}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "total",
            "type": "value"
          },
          {
            "key": "quantity",
            "type": "value"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "COMPARISON",
          "ESTIMATION",
          "MULTI_STEP"
        ],
        "template": "{character} goes to the shop and buys {items}. How much does {character} spend in total?",
        "answerTemplate": "{character} spends {result} in total",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "ESTIMATION"
        ],
        "template": "Estimate: If {character} buys {items}, about how much will it cost?",
        "answerTemplate": "It will cost approximately {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "VALIDATION"
        ],
        "template": "{character} calculated that {items} costs {amount}. Is this correct?",
        "answerTemplate": "{validation_result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "amount",
            "type": "value"
          },
          {
            "key": "validation_result",
            "type": "boolean"
          }
        ]
      }
    ]
  }
}
# Test B.15: CHANGE_CALCULATION model
{
  "success": true,
  "question": {
    "text": "Logan buys an apple for £5 and pays with undefined. How much change does Logan get?",
    "options": [
      {
        "value": 0,
        "text": "0p",
        "isCorrect": true
      }
    ],
    "correctIndex": 0,
    "format": "DIRECT_CALCULATION",
    "difficulty": {
      "year": 4,
      "subLevel": 1,
      "displayName": "4.1",
      "cognitiveLoad": 40
    },
    "cognitiveLoad": 40,
    "curriculumTags": [
      "4N1a"
    ],
    "scenario": {
      "id": "shop-002-realistic-general",
      "theme": "SHOPPING",
      "setting": {
        "location": "local shop",
        "timeContext": "after school",
        "atmosphere": "friendly"
      },
      "characters": [
        {
          "name": "Logan",
          "role": "student"
        }
      ],
      "items": [
        {
          "name": "apple",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.2,
            "max": 0.5,
            "typical": 0.35,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "banana",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.15,
            "max": 0.4,
            "typical": 0.25,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sandwich",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 2.5,
            "max": 6,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "drink",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.8,
            "max": 2.5,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "cake",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 1.5,
            "max": 4,
            "typical": 2.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "biscuit",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.8,
            "max": 2,
            "typical": 1.2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sweet",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.1,
            "max": 1,
            "typical": 0.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "chocolate",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.6,
            "max": 3,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "pen",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.5,
            "max": 2,
            "typical": 1,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "pencil",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.2,
            "max": 1,
            "typical": 0.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "ruler",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.8,
            "max": 2.5,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "notebook",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 1,
            "max": 4,
            "typical": 2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "eraser",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.3,
            "max": 1.5,
            "typical": 0.75,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "book",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 3,
            "max": 15,
            "typical": 8,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "comic",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2,
            "max": 5,
            "typical": 3,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "magazine",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2.5,
            "max": 6,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "toy",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 5,
            "max": 25,
            "typical": 12,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "game",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 8,
            "max": 60,
            "typical": 25,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "puzzle",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 5,
            "max": 20,
            "typical": 12,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sticker",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 0.2,
            "max": 2,
            "typical": 0.8,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "badge",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 0.5,
            "max": 3,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "poster",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2,
            "max": 8,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "card",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 0.5,
            "max": 4,
            "typical": 2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        }
      ],
      "culturalElements": [
        {
          "type": "currency",
          "value": "£",
          "explanation": "British pounds"
        },
        {
          "type": "location",
          "value": "UK local shop",
          "explanation": "Typical British corner shop"
        }
      ],
      "realWorldConnection": "Everyday shopping with realistic UK prices",
      "yearAppropriate": [
        1,
        2,
        3,
        4,
        5,
        6
      ],
      "templates": [
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "MULTI_STEP"
          ],
          "modelCompatibility": [
            "ADDITION"
          ],
          "operandCount": 3,
          "template": "{character} buys {article1} {item1} for {price1}, {article2} {item2} for {price2}, and {article3} {item3} for {price3}. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item1",
              "type": "item"
            },
            {
              "key": "item2",
              "type": "item"
            },
            {
              "key": "item3",
              "type": "item"
            },
            {
              "key": "price1",
              "type": "value"
            },
            {
              "key": "price2",
              "type": "value"
            },
            {
              "key": "price3",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "MULTI_STEP"
          ],
          "modelCompatibility": [
            "ADDITION"
          ],
          "operandCount": 2,
          "template": "{character} buys {article1} {item1} for {price1} and {article2} {item2} for {price2}. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item1",
              "type": "item"
            },
            {
              "key": "item2",
              "type": "item"
            },
            {
              "key": "price1",
              "type": "value"
            },
            {
              "key": "price2",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "SUBTRACTION",
            "CHANGE_CALCULATION"
          ],
          "template": "{character} buys {article} {item} for {price} and pays with {payment}. How much change does {character} get?",
          "answerTemplate": "{character} receives {result} in change",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "payment",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "MULTIPLICATION"
          ],
          "template": "{character} buys {quantity} {item} at {price} each. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "quantity",
              "type": "value"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "DIVISION"
          ],
          "template": "{character} has {total} to spend equally on {quantity} {item}. How much can {character} spend on each one?",
          "answerTemplate": "{character} can spend {result} on each {item}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "total",
              "type": "value"
            },
            {
              "key": "quantity",
              "type": "value"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "COMPARISON",
            "ESTIMATION",
            "MULTI_STEP"
          ],
          "template": "{character} goes to the shop and buys {items}. How much does {character} spend in total?",
          "answerTemplate": "{character} spends {result} in total",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "ESTIMATION"
          ],
          "template": "Estimate: If {character} buys {items}, about how much will it cost?",
          "answerTemplate": "It will cost approximately {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "VALIDATION"
          ],
          "template": "{character} calculated that {items} costs {amount}. Is this correct?",
          "answerTemplate": "{validation_result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "amount",
              "type": "value"
            },
            {
              "key": "validation_result",
              "type": "boolean"
            }
          ]
        }
      ]
    },
    "distractors": [],
    "enhancementStatus": {
      "level": "partial",
      "requestedFormat": "DIRECT_CALCULATION",
      "actualFormat": "DIRECT_CALCULATION",
      "featuresActive": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "featuresPending": [],
      "isFullyEnhanced": true
    },
    "mathOutput": {
      "operation": "CHANGE_CALCULATION"
    },
    "generationTime": 1,
    "questionId": "q_1759232461717_2adesz21i",
    "generationSetup": {
      "controller_used": "DIRECT_CALCULATIONController",
      "format_requested": "DIRECT_CALCULATION",
      "format_actual": "DIRECT_CALCULATION",
      "scenario_theme": "SHOPPING",
      "scenario_id": "shop-002-realistic-general",
      "scenario_selection_method": "default",
      "distractor_strategies": [],
      "distractor_count": 0,
      "theme_variety": false,
      "format_variety": false,
      "enhancement_level": "partial",
      "features_active": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "features_pending": [],
      "generation_time_ms": 1
    }
  },
  "metadata": {
    "format": "DIRECT_CALCULATION",
    "cognitive_load": 40,
    "curriculum_alignment": [
      "4N1a"
    ],
    "difficulty": "4.1",
    "scenario_theme": "SHOPPING",
    "distractor_strategies": [],
    "generation_time_ms": 2,
    "api_version": "2.0",
    "enhancement_status": "partial",
    "format_requested": "DIRECT_CALCULATION",
    "format_used": "DIRECT_CALCULATION",
    "features_active": [
      "enhanced_distractors",
      "rich_scenarios",
      "cognitive_load",
      "advanced_formats"
    ],
    "features_pending": []
  },
  "context": {
    "id": "shop-002-realistic-general",
    "theme": "SHOPPING",
    "setting": {
      "location": "local shop",
      "timeContext": "after school",
      "atmosphere": "friendly"
    },
    "characters": [
      {
        "name": "Logan",
        "role": "student"
      }
    ],
    "items": [
      {
        "name": "apple",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.2,
          "max": 0.5,
          "typical": 0.35,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "banana",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.15,
          "max": 0.4,
          "typical": 0.25,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sandwich",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 2.5,
          "max": 6,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "drink",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.8,
          "max": 2.5,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "cake",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 1.5,
          "max": 4,
          "typical": 2.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "biscuit",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.8,
          "max": 2,
          "typical": 1.2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sweet",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.1,
          "max": 1,
          "typical": 0.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "chocolate",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.6,
          "max": 3,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "pen",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.5,
          "max": 2,
          "typical": 1,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "pencil",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.2,
          "max": 1,
          "typical": 0.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "ruler",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.8,
          "max": 2.5,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "notebook",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 1,
          "max": 4,
          "typical": 2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "eraser",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.3,
          "max": 1.5,
          "typical": 0.75,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "book",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 3,
          "max": 15,
          "typical": 8,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "comic",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2,
          "max": 5,
          "typical": 3,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "magazine",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2.5,
          "max": 6,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "toy",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 5,
          "max": 25,
          "typical": 12,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "game",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 8,
          "max": 60,
          "typical": 25,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "puzzle",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 5,
          "max": 20,
          "typical": 12,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sticker",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 0.2,
          "max": 2,
          "typical": 0.8,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "badge",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 0.5,
          "max": 3,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "poster",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2,
          "max": 8,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "card",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 0.5,
          "max": 4,
          "typical": 2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      }
    ],
    "culturalElements": [
      {
        "type": "currency",
        "value": "£",
        "explanation": "British pounds"
      },
      {
        "type": "location",
        "value": "UK local shop",
        "explanation": "Typical British corner shop"
      }
    ],
    "realWorldConnection": "Everyday shopping with realistic UK prices",
    "yearAppropriate": [
      1,
      2,
      3,
      4,
      5,
      6
    ],
    "templates": [
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "MULTI_STEP"
        ],
        "modelCompatibility": [
          "ADDITION"
        ],
        "operandCount": 3,
        "template": "{character} buys {article1} {item1} for {price1}, {article2} {item2} for {price2}, and {article3} {item3} for {price3}. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item1",
            "type": "item"
          },
          {
            "key": "item2",
            "type": "item"
          },
          {
            "key": "item3",
            "type": "item"
          },
          {
            "key": "price1",
            "type": "value"
          },
          {
            "key": "price2",
            "type": "value"
          },
          {
            "key": "price3",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "MULTI_STEP"
        ],
        "modelCompatibility": [
          "ADDITION"
        ],
        "operandCount": 2,
        "template": "{character} buys {article1} {item1} for {price1} and {article2} {item2} for {price2}. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item1",
            "type": "item"
          },
          {
            "key": "item2",
            "type": "item"
          },
          {
            "key": "price1",
            "type": "value"
          },
          {
            "key": "price2",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "SUBTRACTION",
          "CHANGE_CALCULATION"
        ],
        "template": "{character} buys {article} {item} for {price} and pays with {payment}. How much change does {character} get?",
        "answerTemplate": "{character} receives {result} in change",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "payment",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "MULTIPLICATION"
        ],
        "template": "{character} buys {quantity} {item} at {price} each. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "quantity",
            "type": "value"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "DIVISION"
        ],
        "template": "{character} has {total} to spend equally on {quantity} {item}. How much can {character} spend on each one?",
        "answerTemplate": "{character} can spend {result} on each {item}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "total",
            "type": "value"
          },
          {
            "key": "quantity",
            "type": "value"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "COMPARISON",
          "ESTIMATION",
          "MULTI_STEP"
        ],
        "template": "{character} goes to the shop and buys {items}. How much does {character} spend in total?",
        "answerTemplate": "{character} spends {result} in total",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "ESTIMATION"
        ],
        "template": "Estimate: If {character} buys {items}, about how much will it cost?",
        "answerTemplate": "It will cost approximately {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "VALIDATION"
        ],
        "template": "{character} calculated that {items} costs {amount}. Is this correct?",
        "answerTemplate": "{validation_result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "amount",
            "type": "value"
          },
          {
            "key": "validation_result",
            "type": "boolean"
          }
        ]
      }
    ]
  }
}
# Test B.16: MONEY_COMBINATIONS model
{
  "success": true,
  "question": {
    "text": "Logan goes to the shop and buys apple, banana, sandwich, drink, cake, biscuit, sweet, chocolate, pen, pencil, ruler, notebook, eraser, book, comic, magazine, toy, game, puzzle, sticker, badge, poster, card. How much does Logan spend in total?",
    "options": [
      {
        "value": 0,
        "text": "0p",
        "isCorrect": true
      }
    ],
    "correctIndex": 0,
    "format": "DIRECT_CALCULATION",
    "difficulty": {
      "year": 4,
      "subLevel": 1,
      "displayName": "4.1",
      "cognitiveLoad": 40
    },
    "cognitiveLoad": 40,
    "curriculumTags": [
      "4N1a"
    ],
    "scenario": {
      "id": "shop-002-realistic-general",
      "theme": "SHOPPING",
      "setting": {
        "location": "local shop",
        "timeContext": "after school",
        "atmosphere": "friendly"
      },
      "characters": [
        {
          "name": "Logan",
          "role": "student"
        }
      ],
      "items": [
        {
          "name": "apple",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.2,
            "max": 0.5,
            "typical": 0.35,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "banana",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.15,
            "max": 0.4,
            "typical": 0.25,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sandwich",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 2.5,
            "max": 6,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "drink",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.8,
            "max": 2.5,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "cake",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 1.5,
            "max": 4,
            "typical": 2.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "biscuit",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.8,
            "max": 2,
            "typical": 1.2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sweet",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.1,
            "max": 1,
            "typical": 0.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "chocolate",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.6,
            "max": 3,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "pen",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.5,
            "max": 2,
            "typical": 1,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "pencil",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.2,
            "max": 1,
            "typical": 0.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "ruler",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.8,
            "max": 2.5,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "notebook",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 1,
            "max": 4,
            "typical": 2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "eraser",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.3,
            "max": 1.5,
            "typical": 0.75,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "book",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 3,
            "max": 15,
            "typical": 8,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "comic",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2,
            "max": 5,
            "typical": 3,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "magazine",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2.5,
            "max": 6,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "toy",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 5,
            "max": 25,
            "typical": 12,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "game",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 8,
            "max": 60,
            "typical": 25,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "puzzle",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 5,
            "max": 20,
            "typical": 12,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sticker",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 0.2,
            "max": 2,
            "typical": 0.8,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "badge",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 0.5,
            "max": 3,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "poster",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2,
            "max": 8,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "card",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 0.5,
            "max": 4,
            "typical": 2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        }
      ],
      "culturalElements": [
        {
          "type": "currency",
          "value": "£",
          "explanation": "British pounds"
        },
        {
          "type": "location",
          "value": "UK local shop",
          "explanation": "Typical British corner shop"
        }
      ],
      "realWorldConnection": "Everyday shopping with realistic UK prices",
      "yearAppropriate": [
        1,
        2,
        3,
        4,
        5,
        6
      ],
      "templates": [
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "MULTI_STEP"
          ],
          "modelCompatibility": [
            "ADDITION"
          ],
          "operandCount": 3,
          "template": "{character} buys {article1} {item1} for {price1}, {article2} {item2} for {price2}, and {article3} {item3} for {price3}. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item1",
              "type": "item"
            },
            {
              "key": "item2",
              "type": "item"
            },
            {
              "key": "item3",
              "type": "item"
            },
            {
              "key": "price1",
              "type": "value"
            },
            {
              "key": "price2",
              "type": "value"
            },
            {
              "key": "price3",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "MULTI_STEP"
          ],
          "modelCompatibility": [
            "ADDITION"
          ],
          "operandCount": 2,
          "template": "{character} buys {article1} {item1} for {price1} and {article2} {item2} for {price2}. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item1",
              "type": "item"
            },
            {
              "key": "item2",
              "type": "item"
            },
            {
              "key": "price1",
              "type": "value"
            },
            {
              "key": "price2",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "SUBTRACTION",
            "CHANGE_CALCULATION"
          ],
          "template": "{character} buys {article} {item} for {price} and pays with {payment}. How much change does {character} get?",
          "answerTemplate": "{character} receives {result} in change",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "payment",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "MULTIPLICATION"
          ],
          "template": "{character} buys {quantity} {item} at {price} each. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "quantity",
              "type": "value"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "DIVISION"
          ],
          "template": "{character} has {total} to spend equally on {quantity} {item}. How much can {character} spend on each one?",
          "answerTemplate": "{character} can spend {result} on each {item}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "total",
              "type": "value"
            },
            {
              "key": "quantity",
              "type": "value"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "COMPARISON",
            "ESTIMATION",
            "MULTI_STEP"
          ],
          "template": "{character} goes to the shop and buys {items}. How much does {character} spend in total?",
          "answerTemplate": "{character} spends {result} in total",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "ESTIMATION"
          ],
          "template": "Estimate: If {character} buys {items}, about how much will it cost?",
          "answerTemplate": "It will cost approximately {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "VALIDATION"
          ],
          "template": "{character} calculated that {items} costs {amount}. Is this correct?",
          "answerTemplate": "{validation_result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "amount",
              "type": "value"
            },
            {
              "key": "validation_result",
              "type": "boolean"
            }
          ]
        }
      ]
    },
    "distractors": [],
    "enhancementStatus": {
      "level": "partial",
      "requestedFormat": "DIRECT_CALCULATION",
      "actualFormat": "DIRECT_CALCULATION",
      "featuresActive": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "featuresPending": [],
      "isFullyEnhanced": true
    },
    "mathOutput": {
      "operation": "MONEY_COMBINATIONS",
      "target_amount": 4,
      "combination_count": 3
    },
    "generationTime": 1,
    "questionId": "q_1759232461763_uh5ys6i8p",
    "generationSetup": {
      "controller_used": "DIRECT_CALCULATIONController",
      "format_requested": "DIRECT_CALCULATION",
      "format_actual": "DIRECT_CALCULATION",
      "scenario_theme": "SHOPPING",
      "scenario_id": "shop-002-realistic-general",
      "scenario_selection_method": "default",
      "distractor_strategies": [],
      "distractor_count": 0,
      "theme_variety": false,
      "format_variety": false,
      "enhancement_level": "partial",
      "features_active": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "features_pending": [],
      "generation_time_ms": 1
    }
  },
  "metadata": {
    "format": "DIRECT_CALCULATION",
    "cognitive_load": 40,
    "curriculum_alignment": [
      "4N1a"
    ],
    "difficulty": "4.1",
    "scenario_theme": "SHOPPING",
    "distractor_strategies": [],
    "generation_time_ms": 1,
    "api_version": "2.0",
    "enhancement_status": "partial",
    "format_requested": "DIRECT_CALCULATION",
    "format_used": "DIRECT_CALCULATION",
    "features_active": [
      "enhanced_distractors",
      "rich_scenarios",
      "cognitive_load",
      "advanced_formats"
    ],
    "features_pending": []
  },
  "context": {
    "id": "shop-002-realistic-general",
    "theme": "SHOPPING",
    "setting": {
      "location": "local shop",
      "timeContext": "after school",
      "atmosphere": "friendly"
    },
    "characters": [
      {
        "name": "Logan",
        "role": "student"
      }
    ],
    "items": [
      {
        "name": "apple",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.2,
          "max": 0.5,
          "typical": 0.35,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "banana",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.15,
          "max": 0.4,
          "typical": 0.25,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sandwich",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 2.5,
          "max": 6,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "drink",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.8,
          "max": 2.5,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "cake",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 1.5,
          "max": 4,
          "typical": 2.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "biscuit",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.8,
          "max": 2,
          "typical": 1.2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sweet",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.1,
          "max": 1,
          "typical": 0.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "chocolate",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.6,
          "max": 3,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "pen",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.5,
          "max": 2,
          "typical": 1,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "pencil",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.2,
          "max": 1,
          "typical": 0.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "ruler",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.8,
          "max": 2.5,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "notebook",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 1,
          "max": 4,
          "typical": 2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "eraser",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.3,
          "max": 1.5,
          "typical": 0.75,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "book",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 3,
          "max": 15,
          "typical": 8,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "comic",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2,
          "max": 5,
          "typical": 3,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "magazine",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2.5,
          "max": 6,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "toy",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 5,
          "max": 25,
          "typical": 12,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "game",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 8,
          "max": 60,
          "typical": 25,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "puzzle",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 5,
          "max": 20,
          "typical": 12,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sticker",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 0.2,
          "max": 2,
          "typical": 0.8,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "badge",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 0.5,
          "max": 3,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "poster",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2,
          "max": 8,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "card",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 0.5,
          "max": 4,
          "typical": 2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      }
    ],
    "culturalElements": [
      {
        "type": "currency",
        "value": "£",
        "explanation": "British pounds"
      },
      {
        "type": "location",
        "value": "UK local shop",
        "explanation": "Typical British corner shop"
      }
    ],
    "realWorldConnection": "Everyday shopping with realistic UK prices",
    "yearAppropriate": [
      1,
      2,
      3,
      4,
      5,
      6
    ],
    "templates": [
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "MULTI_STEP"
        ],
        "modelCompatibility": [
          "ADDITION"
        ],
        "operandCount": 3,
        "template": "{character} buys {article1} {item1} for {price1}, {article2} {item2} for {price2}, and {article3} {item3} for {price3}. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item1",
            "type": "item"
          },
          {
            "key": "item2",
            "type": "item"
          },
          {
            "key": "item3",
            "type": "item"
          },
          {
            "key": "price1",
            "type": "value"
          },
          {
            "key": "price2",
            "type": "value"
          },
          {
            "key": "price3",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "MULTI_STEP"
        ],
        "modelCompatibility": [
          "ADDITION"
        ],
        "operandCount": 2,
        "template": "{character} buys {article1} {item1} for {price1} and {article2} {item2} for {price2}. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item1",
            "type": "item"
          },
          {
            "key": "item2",
            "type": "item"
          },
          {
            "key": "price1",
            "type": "value"
          },
          {
            "key": "price2",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "SUBTRACTION",
          "CHANGE_CALCULATION"
        ],
        "template": "{character} buys {article} {item} for {price} and pays with {payment}. How much change does {character} get?",
        "answerTemplate": "{character} receives {result} in change",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "payment",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "MULTIPLICATION"
        ],
        "template": "{character} buys {quantity} {item} at {price} each. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "quantity",
            "type": "value"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "DIVISION"
        ],
        "template": "{character} has {total} to spend equally on {quantity} {item}. How much can {character} spend on each one?",
        "answerTemplate": "{character} can spend {result} on each {item}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "total",
            "type": "value"
          },
          {
            "key": "quantity",
            "type": "value"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "COMPARISON",
          "ESTIMATION",
          "MULTI_STEP"
        ],
        "template": "{character} goes to the shop and buys {items}. How much does {character} spend in total?",
        "answerTemplate": "{character} spends {result} in total",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "ESTIMATION"
        ],
        "template": "Estimate: If {character} buys {items}, about how much will it cost?",
        "answerTemplate": "It will cost approximately {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "VALIDATION"
        ],
        "template": "{character} calculated that {items} costs {amount}. Is this correct?",
        "answerTemplate": "{validation_result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "amount",
            "type": "value"
          },
          {
            "key": "validation_result",
            "type": "boolean"
          }
        ]
      }
    ]
  }
}
# Test B.17: MIXED_MONEY_UNITS model
{
  "success": true,
  "question": {
    "text": "Logan goes to the shop and buys apple, banana, sandwich, drink, cake, biscuit, sweet, chocolate, pen, pencil, ruler, notebook, eraser, book, comic, magazine, toy, game, puzzle, sticker, badge, poster, card. How much does Logan spend in total?",
    "options": [
      {
        "value": 0,
        "text": "0p",
        "isCorrect": true
      }
    ],
    "correctIndex": 0,
    "format": "DIRECT_CALCULATION",
    "difficulty": {
      "year": 4,
      "subLevel": 1,
      "displayName": "4.1",
      "cognitiveLoad": 40
    },
    "cognitiveLoad": 40,
    "curriculumTags": [
      "4N1a"
    ],
    "scenario": {
      "id": "shop-002-realistic-general",
      "theme": "SHOPPING",
      "setting": {
        "location": "local shop",
        "timeContext": "after school",
        "atmosphere": "friendly"
      },
      "characters": [
        {
          "name": "Logan",
          "role": "student"
        }
      ],
      "items": [
        {
          "name": "apple",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.2,
            "max": 0.5,
            "typical": 0.35,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "banana",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.15,
            "max": 0.4,
            "typical": 0.25,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sandwich",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 2.5,
            "max": 6,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "drink",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.8,
            "max": 2.5,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "cake",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 1.5,
            "max": 4,
            "typical": 2.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "biscuit",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.8,
            "max": 2,
            "typical": 1.2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sweet",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.1,
            "max": 1,
            "typical": 0.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "chocolate",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.6,
            "max": 3,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "pen",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.5,
            "max": 2,
            "typical": 1,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "pencil",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.2,
            "max": 1,
            "typical": 0.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "ruler",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.8,
            "max": 2.5,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "notebook",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 1,
            "max": 4,
            "typical": 2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "eraser",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.3,
            "max": 1.5,
            "typical": 0.75,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "book",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 3,
            "max": 15,
            "typical": 8,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "comic",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2,
            "max": 5,
            "typical": 3,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "magazine",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2.5,
            "max": 6,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "toy",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 5,
            "max": 25,
            "typical": 12,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "game",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 8,
            "max": 60,
            "typical": 25,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "puzzle",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 5,
            "max": 20,
            "typical": 12,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sticker",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 0.2,
            "max": 2,
            "typical": 0.8,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "badge",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 0.5,
            "max": 3,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "poster",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2,
            "max": 8,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "card",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 0.5,
            "max": 4,
            "typical": 2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        }
      ],
      "culturalElements": [
        {
          "type": "currency",
          "value": "£",
          "explanation": "British pounds"
        },
        {
          "type": "location",
          "value": "UK local shop",
          "explanation": "Typical British corner shop"
        }
      ],
      "realWorldConnection": "Everyday shopping with realistic UK prices",
      "yearAppropriate": [
        1,
        2,
        3,
        4,
        5,
        6
      ],
      "templates": [
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "MULTI_STEP"
          ],
          "modelCompatibility": [
            "ADDITION"
          ],
          "operandCount": 3,
          "template": "{character} buys {article1} {item1} for {price1}, {article2} {item2} for {price2}, and {article3} {item3} for {price3}. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item1",
              "type": "item"
            },
            {
              "key": "item2",
              "type": "item"
            },
            {
              "key": "item3",
              "type": "item"
            },
            {
              "key": "price1",
              "type": "value"
            },
            {
              "key": "price2",
              "type": "value"
            },
            {
              "key": "price3",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "MULTI_STEP"
          ],
          "modelCompatibility": [
            "ADDITION"
          ],
          "operandCount": 2,
          "template": "{character} buys {article1} {item1} for {price1} and {article2} {item2} for {price2}. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item1",
              "type": "item"
            },
            {
              "key": "item2",
              "type": "item"
            },
            {
              "key": "price1",
              "type": "value"
            },
            {
              "key": "price2",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "SUBTRACTION",
            "CHANGE_CALCULATION"
          ],
          "template": "{character} buys {article} {item} for {price} and pays with {payment}. How much change does {character} get?",
          "answerTemplate": "{character} receives {result} in change",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "payment",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "MULTIPLICATION"
          ],
          "template": "{character} buys {quantity} {item} at {price} each. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "quantity",
              "type": "value"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "DIVISION"
          ],
          "template": "{character} has {total} to spend equally on {quantity} {item}. How much can {character} spend on each one?",
          "answerTemplate": "{character} can spend {result} on each {item}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "total",
              "type": "value"
            },
            {
              "key": "quantity",
              "type": "value"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "COMPARISON",
            "ESTIMATION",
            "MULTI_STEP"
          ],
          "template": "{character} goes to the shop and buys {items}. How much does {character} spend in total?",
          "answerTemplate": "{character} spends {result} in total",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "ESTIMATION"
          ],
          "template": "Estimate: If {character} buys {items}, about how much will it cost?",
          "answerTemplate": "It will cost approximately {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "VALIDATION"
          ],
          "template": "{character} calculated that {items} costs {amount}. Is this correct?",
          "answerTemplate": "{validation_result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "amount",
              "type": "value"
            },
            {
              "key": "validation_result",
              "type": "boolean"
            }
          ]
        }
      ]
    },
    "distractors": [],
    "enhancementStatus": {
      "level": "partial",
      "requestedFormat": "DIRECT_CALCULATION",
      "actualFormat": "DIRECT_CALCULATION",
      "featuresActive": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "featuresPending": [],
      "isFullyEnhanced": true
    },
    "mathOutput": {
      "operation": "MIXED_MONEY_UNITS"
    },
    "generationTime": 1,
    "questionId": "q_1759232461807_6u27w79aq",
    "generationSetup": {
      "controller_used": "DIRECT_CALCULATIONController",
      "format_requested": "DIRECT_CALCULATION",
      "format_actual": "DIRECT_CALCULATION",
      "scenario_theme": "SHOPPING",
      "scenario_id": "shop-002-realistic-general",
      "scenario_selection_method": "default",
      "distractor_strategies": [],
      "distractor_count": 0,
      "theme_variety": false,
      "format_variety": false,
      "enhancement_level": "partial",
      "features_active": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "features_pending": [],
      "generation_time_ms": 1
    }
  },
  "metadata": {
    "format": "DIRECT_CALCULATION",
    "cognitive_load": 40,
    "curriculum_alignment": [
      "4N1a"
    ],
    "difficulty": "4.1",
    "scenario_theme": "SHOPPING",
    "distractor_strategies": [],
    "generation_time_ms": 1,
    "api_version": "2.0",
    "enhancement_status": "partial",
    "format_requested": "DIRECT_CALCULATION",
    "format_used": "DIRECT_CALCULATION",
    "features_active": [
      "enhanced_distractors",
      "rich_scenarios",
      "cognitive_load",
      "advanced_formats"
    ],
    "features_pending": []
  },
  "context": {
    "id": "shop-002-realistic-general",
    "theme": "SHOPPING",
    "setting": {
      "location": "local shop",
      "timeContext": "after school",
      "atmosphere": "friendly"
    },
    "characters": [
      {
        "name": "Logan",
        "role": "student"
      }
    ],
    "items": [
      {
        "name": "apple",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.2,
          "max": 0.5,
          "typical": 0.35,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "banana",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.15,
          "max": 0.4,
          "typical": 0.25,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sandwich",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 2.5,
          "max": 6,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "drink",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.8,
          "max": 2.5,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "cake",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 1.5,
          "max": 4,
          "typical": 2.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "biscuit",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.8,
          "max": 2,
          "typical": 1.2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sweet",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.1,
          "max": 1,
          "typical": 0.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "chocolate",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.6,
          "max": 3,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "pen",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.5,
          "max": 2,
          "typical": 1,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "pencil",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.2,
          "max": 1,
          "typical": 0.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "ruler",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.8,
          "max": 2.5,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "notebook",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 1,
          "max": 4,
          "typical": 2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "eraser",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.3,
          "max": 1.5,
          "typical": 0.75,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "book",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 3,
          "max": 15,
          "typical": 8,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "comic",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2,
          "max": 5,
          "typical": 3,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "magazine",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2.5,
          "max": 6,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "toy",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 5,
          "max": 25,
          "typical": 12,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "game",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 8,
          "max": 60,
          "typical": 25,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "puzzle",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 5,
          "max": 20,
          "typical": 12,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sticker",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 0.2,
          "max": 2,
          "typical": 0.8,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "badge",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 0.5,
          "max": 3,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "poster",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2,
          "max": 8,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "card",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 0.5,
          "max": 4,
          "typical": 2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      }
    ],
    "culturalElements": [
      {
        "type": "currency",
        "value": "£",
        "explanation": "British pounds"
      },
      {
        "type": "location",
        "value": "UK local shop",
        "explanation": "Typical British corner shop"
      }
    ],
    "realWorldConnection": "Everyday shopping with realistic UK prices",
    "yearAppropriate": [
      1,
      2,
      3,
      4,
      5,
      6
    ],
    "templates": [
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "MULTI_STEP"
        ],
        "modelCompatibility": [
          "ADDITION"
        ],
        "operandCount": 3,
        "template": "{character} buys {article1} {item1} for {price1}, {article2} {item2} for {price2}, and {article3} {item3} for {price3}. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item1",
            "type": "item"
          },
          {
            "key": "item2",
            "type": "item"
          },
          {
            "key": "item3",
            "type": "item"
          },
          {
            "key": "price1",
            "type": "value"
          },
          {
            "key": "price2",
            "type": "value"
          },
          {
            "key": "price3",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "MULTI_STEP"
        ],
        "modelCompatibility": [
          "ADDITION"
        ],
        "operandCount": 2,
        "template": "{character} buys {article1} {item1} for {price1} and {article2} {item2} for {price2}. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item1",
            "type": "item"
          },
          {
            "key": "item2",
            "type": "item"
          },
          {
            "key": "price1",
            "type": "value"
          },
          {
            "key": "price2",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "SUBTRACTION",
          "CHANGE_CALCULATION"
        ],
        "template": "{character} buys {article} {item} for {price} and pays with {payment}. How much change does {character} get?",
        "answerTemplate": "{character} receives {result} in change",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "payment",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "MULTIPLICATION"
        ],
        "template": "{character} buys {quantity} {item} at {price} each. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "quantity",
            "type": "value"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "DIVISION"
        ],
        "template": "{character} has {total} to spend equally on {quantity} {item}. How much can {character} spend on each one?",
        "answerTemplate": "{character} can spend {result} on each {item}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "total",
            "type": "value"
          },
          {
            "key": "quantity",
            "type": "value"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "COMPARISON",
          "ESTIMATION",
          "MULTI_STEP"
        ],
        "template": "{character} goes to the shop and buys {items}. How much does {character} spend in total?",
        "answerTemplate": "{character} spends {result} in total",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "ESTIMATION"
        ],
        "template": "Estimate: If {character} buys {items}, about how much will it cost?",
        "answerTemplate": "It will cost approximately {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "VALIDATION"
        ],
        "template": "{character} calculated that {items} costs {amount}. Is this correct?",
        "answerTemplate": "{validation_result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "amount",
            "type": "value"
          },
          {
            "key": "validation_result",
            "type": "boolean"
          }
        ]
      }
    ]
  }
}
# Test B.18: MONEY_FRACTIONS model
{
  "success": true,
  "question": {
    "text": "Logan goes to the shop and buys apple, banana, sandwich, drink, cake, biscuit, sweet, chocolate, pen, pencil, ruler, notebook, eraser, book, comic, magazine, toy, game, puzzle, sticker, badge, poster, card. How much does Logan spend in total?",
    "options": [
      {
        "text": "12.375",
        "value": 12.38,
        "index": 0
      },
      {
        "text": "£24.75",
        "value": 24.75,
        "index": 1
      },
      {
        "text": "26.75",
        "value": 26.75,
        "index": 2
      },
      {
        "text": "23.75",
        "value": 23.75,
        "index": 3
      }
    ],
    "correctIndex": 1,
    "format": "DIRECT_CALCULATION",
    "difficulty": {
      "year": 4,
      "subLevel": 1,
      "displayName": "4.1",
      "cognitiveLoad": 40
    },
    "cognitiveLoad": 40,
    "curriculumTags": [
      "4N1a"
    ],
    "scenario": {
      "id": "shop-002-realistic-general",
      "theme": "SHOPPING",
      "setting": {
        "location": "local shop",
        "timeContext": "after school",
        "atmosphere": "friendly"
      },
      "characters": [
        {
          "name": "Logan",
          "role": "student"
        }
      ],
      "items": [
        {
          "name": "apple",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.2,
            "max": 0.5,
            "typical": 0.35,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "banana",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.15,
            "max": 0.4,
            "typical": 0.25,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sandwich",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 2.5,
            "max": 6,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "drink",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.8,
            "max": 2.5,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "cake",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 1.5,
            "max": 4,
            "typical": 2.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "biscuit",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.8,
            "max": 2,
            "typical": 1.2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sweet",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.1,
            "max": 1,
            "typical": 0.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "chocolate",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.6,
            "max": 3,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "pen",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.5,
            "max": 2,
            "typical": 1,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "pencil",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.2,
            "max": 1,
            "typical": 0.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "ruler",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.8,
            "max": 2.5,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "notebook",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 1,
            "max": 4,
            "typical": 2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "eraser",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.3,
            "max": 1.5,
            "typical": 0.75,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "book",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 3,
            "max": 15,
            "typical": 8,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "comic",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2,
            "max": 5,
            "typical": 3,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "magazine",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2.5,
            "max": 6,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "toy",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 5,
            "max": 25,
            "typical": 12,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "game",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 8,
            "max": 60,
            "typical": 25,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "puzzle",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 5,
            "max": 20,
            "typical": 12,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sticker",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 0.2,
            "max": 2,
            "typical": 0.8,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "badge",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 0.5,
            "max": 3,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "poster",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2,
            "max": 8,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "card",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 0.5,
            "max": 4,
            "typical": 2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        }
      ],
      "culturalElements": [
        {
          "type": "currency",
          "value": "£",
          "explanation": "British pounds"
        },
        {
          "type": "location",
          "value": "UK local shop",
          "explanation": "Typical British corner shop"
        }
      ],
      "realWorldConnection": "Everyday shopping with realistic UK prices",
      "yearAppropriate": [
        1,
        2,
        3,
        4,
        5,
        6
      ],
      "templates": [
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "MULTI_STEP"
          ],
          "modelCompatibility": [
            "ADDITION"
          ],
          "operandCount": 3,
          "template": "{character} buys {article1} {item1} for {price1}, {article2} {item2} for {price2}, and {article3} {item3} for {price3}. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item1",
              "type": "item"
            },
            {
              "key": "item2",
              "type": "item"
            },
            {
              "key": "item3",
              "type": "item"
            },
            {
              "key": "price1",
              "type": "value"
            },
            {
              "key": "price2",
              "type": "value"
            },
            {
              "key": "price3",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "MULTI_STEP"
          ],
          "modelCompatibility": [
            "ADDITION"
          ],
          "operandCount": 2,
          "template": "{character} buys {article1} {item1} for {price1} and {article2} {item2} for {price2}. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item1",
              "type": "item"
            },
            {
              "key": "item2",
              "type": "item"
            },
            {
              "key": "price1",
              "type": "value"
            },
            {
              "key": "price2",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "SUBTRACTION",
            "CHANGE_CALCULATION"
          ],
          "template": "{character} buys {article} {item} for {price} and pays with {payment}. How much change does {character} get?",
          "answerTemplate": "{character} receives {result} in change",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "payment",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "MULTIPLICATION"
          ],
          "template": "{character} buys {quantity} {item} at {price} each. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "quantity",
              "type": "value"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "DIVISION"
          ],
          "template": "{character} has {total} to spend equally on {quantity} {item}. How much can {character} spend on each one?",
          "answerTemplate": "{character} can spend {result} on each {item}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "total",
              "type": "value"
            },
            {
              "key": "quantity",
              "type": "value"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "COMPARISON",
            "ESTIMATION",
            "MULTI_STEP"
          ],
          "template": "{character} goes to the shop and buys {items}. How much does {character} spend in total?",
          "answerTemplate": "{character} spends {result} in total",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "ESTIMATION"
          ],
          "template": "Estimate: If {character} buys {items}, about how much will it cost?",
          "answerTemplate": "It will cost approximately {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "VALIDATION"
          ],
          "template": "{character} calculated that {items} costs {amount}. Is this correct?",
          "answerTemplate": "{validation_result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "amount",
              "type": "value"
            },
            {
              "key": "validation_result",
              "type": "boolean"
            }
          ]
        }
      ]
    },
    "distractors": [
      {
        "value": 26.75,
        "displayText": "26.75",
        "strategy": "CLOSE_VALUE",
        "reasoning": "Off by 2"
      },
      {
        "value": 23.75,
        "strategy": "CLOSE_VALUE",
        "displayText": "23.75",
        "reasoning": "Off by one (lower)"
      },
      {
        "value": 12.38,
        "displayText": "12.375",
        "reasoning": "Half the correct value"
      }
    ],
    "enhancementStatus": {
      "level": "partial",
      "requestedFormat": "DIRECT_CALCULATION",
      "actualFormat": "DIRECT_CALCULATION",
      "featuresActive": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "featuresPending": [],
      "isFullyEnhanced": true
    },
    "mathOutput": {
      "operation": "MONEY_FRACTIONS",
      "result": 24.75
    },
    "generationTime": 1,
    "questionId": "q_1759232461851_v76dubdbn",
    "generationSetup": {
      "controller_used": "DIRECT_CALCULATIONController",
      "format_requested": "DIRECT_CALCULATION",
      "format_actual": "DIRECT_CALCULATION",
      "scenario_theme": "SHOPPING",
      "scenario_id": "shop-002-realistic-general",
      "scenario_selection_method": "default",
      "distractor_strategies": [
        "CLOSE_VALUE",
        "CLOSE_VALUE",
        null
      ],
      "distractor_count": 3,
      "theme_variety": false,
      "format_variety": false,
      "enhancement_level": "partial",
      "features_active": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "features_pending": [],
      "generation_time_ms": 1
    }
  },
  "metadata": {
    "format": "DIRECT_CALCULATION",
    "cognitive_load": 40,
    "curriculum_alignment": [
      "4N1a"
    ],
    "difficulty": "4.1",
    "scenario_theme": "SHOPPING",
    "distractor_strategies": [
      "CLOSE_VALUE",
      "CLOSE_VALUE",
      null
    ],
    "generation_time_ms": 1,
    "api_version": "2.0",
    "enhancement_status": "partial",
    "format_requested": "DIRECT_CALCULATION",
    "format_used": "DIRECT_CALCULATION",
    "features_active": [
      "enhanced_distractors",
      "rich_scenarios",
      "cognitive_load",
      "advanced_formats"
    ],
    "features_pending": []
  },
  "context": {
    "id": "shop-002-realistic-general",
    "theme": "SHOPPING",
    "setting": {
      "location": "local shop",
      "timeContext": "after school",
      "atmosphere": "friendly"
    },
    "characters": [
      {
        "name": "Logan",
        "role": "student"
      }
    ],
    "items": [
      {
        "name": "apple",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.2,
          "max": 0.5,
          "typical": 0.35,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "banana",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.15,
          "max": 0.4,
          "typical": 0.25,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sandwich",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 2.5,
          "max": 6,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "drink",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.8,
          "max": 2.5,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "cake",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 1.5,
          "max": 4,
          "typical": 2.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "biscuit",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.8,
          "max": 2,
          "typical": 1.2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sweet",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.1,
          "max": 1,
          "typical": 0.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "chocolate",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.6,
          "max": 3,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "pen",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.5,
          "max": 2,
          "typical": 1,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "pencil",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.2,
          "max": 1,
          "typical": 0.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "ruler",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.8,
          "max": 2.5,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "notebook",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 1,
          "max": 4,
          "typical": 2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "eraser",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.3,
          "max": 1.5,
          "typical": 0.75,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "book",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 3,
          "max": 15,
          "typical": 8,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "comic",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2,
          "max": 5,
          "typical": 3,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "magazine",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2.5,
          "max": 6,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "toy",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 5,
          "max": 25,
          "typical": 12,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "game",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 8,
          "max": 60,
          "typical": 25,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "puzzle",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 5,
          "max": 20,
          "typical": 12,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sticker",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 0.2,
          "max": 2,
          "typical": 0.8,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "badge",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 0.5,
          "max": 3,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "poster",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2,
          "max": 8,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "card",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 0.5,
          "max": 4,
          "typical": 2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      }
    ],
    "culturalElements": [
      {
        "type": "currency",
        "value": "£",
        "explanation": "British pounds"
      },
      {
        "type": "location",
        "value": "UK local shop",
        "explanation": "Typical British corner shop"
      }
    ],
    "realWorldConnection": "Everyday shopping with realistic UK prices",
    "yearAppropriate": [
      1,
      2,
      3,
      4,
      5,
      6
    ],
    "templates": [
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "MULTI_STEP"
        ],
        "modelCompatibility": [
          "ADDITION"
        ],
        "operandCount": 3,
        "template": "{character} buys {article1} {item1} for {price1}, {article2} {item2} for {price2}, and {article3} {item3} for {price3}. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item1",
            "type": "item"
          },
          {
            "key": "item2",
            "type": "item"
          },
          {
            "key": "item3",
            "type": "item"
          },
          {
            "key": "price1",
            "type": "value"
          },
          {
            "key": "price2",
            "type": "value"
          },
          {
            "key": "price3",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "MULTI_STEP"
        ],
        "modelCompatibility": [
          "ADDITION"
        ],
        "operandCount": 2,
        "template": "{character} buys {article1} {item1} for {price1} and {article2} {item2} for {price2}. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item1",
            "type": "item"
          },
          {
            "key": "item2",
            "type": "item"
          },
          {
            "key": "price1",
            "type": "value"
          },
          {
            "key": "price2",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "SUBTRACTION",
          "CHANGE_CALCULATION"
        ],
        "template": "{character} buys {article} {item} for {price} and pays with {payment}. How much change does {character} get?",
        "answerTemplate": "{character} receives {result} in change",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "payment",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "MULTIPLICATION"
        ],
        "template": "{character} buys {quantity} {item} at {price} each. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "quantity",
            "type": "value"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "DIVISION"
        ],
        "template": "{character} has {total} to spend equally on {quantity} {item}. How much can {character} spend on each one?",
        "answerTemplate": "{character} can spend {result} on each {item}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "total",
            "type": "value"
          },
          {
            "key": "quantity",
            "type": "value"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "COMPARISON",
          "ESTIMATION",
          "MULTI_STEP"
        ],
        "template": "{character} goes to the shop and buys {items}. How much does {character} spend in total?",
        "answerTemplate": "{character} spends {result} in total",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "ESTIMATION"
        ],
        "template": "Estimate: If {character} buys {items}, about how much will it cost?",
        "answerTemplate": "It will cost approximately {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "VALIDATION"
        ],
        "template": "{character} calculated that {items} costs {amount}. Is this correct?",
        "answerTemplate": "{validation_result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "amount",
            "type": "value"
          },
          {
            "key": "validation_result",
            "type": "boolean"
          }
        ]
      }
    ]
  }
}
# Test B.19: MONEY_SCALING model
{
  "success": true,
  "question": {
    "text": "Logan goes to the shop and buys apple, banana, sandwich, drink, cake, biscuit, sweet, chocolate, pen, pencil, ruler, notebook, eraser, book, comic, magazine, toy, game, puzzle, sticker, badge, poster, card. How much does Logan spend in total?",
    "options": [
      {
        "value": 0,
        "text": "0p",
        "isCorrect": true
      }
    ],
    "correctIndex": 0,
    "format": "DIRECT_CALCULATION",
    "difficulty": {
      "year": 4,
      "subLevel": 1,
      "displayName": "4.1",
      "cognitiveLoad": 40
    },
    "cognitiveLoad": 40,
    "curriculumTags": [
      "4N1a"
    ],
    "scenario": {
      "id": "shop-002-realistic-general",
      "theme": "SHOPPING",
      "setting": {
        "location": "local shop",
        "timeContext": "after school",
        "atmosphere": "friendly"
      },
      "characters": [
        {
          "name": "Logan",
          "role": "student"
        }
      ],
      "items": [
        {
          "name": "apple",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.2,
            "max": 0.5,
            "typical": 0.35,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "banana",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.15,
            "max": 0.4,
            "typical": 0.25,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sandwich",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 2.5,
            "max": 6,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "drink",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.8,
            "max": 2.5,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "cake",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 1.5,
            "max": 4,
            "typical": 2.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "biscuit",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.8,
            "max": 2,
            "typical": 1.2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sweet",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.1,
            "max": 1,
            "typical": 0.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "chocolate",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.6,
            "max": 3,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "pen",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.5,
            "max": 2,
            "typical": 1,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "pencil",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.2,
            "max": 1,
            "typical": 0.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "ruler",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.8,
            "max": 2.5,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "notebook",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 1,
            "max": 4,
            "typical": 2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "eraser",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.3,
            "max": 1.5,
            "typical": 0.75,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "book",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 3,
            "max": 15,
            "typical": 8,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "comic",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2,
            "max": 5,
            "typical": 3,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "magazine",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2.5,
            "max": 6,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "toy",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 5,
            "max": 25,
            "typical": 12,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "game",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 8,
            "max": 60,
            "typical": 25,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "puzzle",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 5,
            "max": 20,
            "typical": 12,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sticker",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 0.2,
            "max": 2,
            "typical": 0.8,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "badge",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 0.5,
            "max": 3,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "poster",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2,
            "max": 8,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "card",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 0.5,
            "max": 4,
            "typical": 2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        }
      ],
      "culturalElements": [
        {
          "type": "currency",
          "value": "£",
          "explanation": "British pounds"
        },
        {
          "type": "location",
          "value": "UK local shop",
          "explanation": "Typical British corner shop"
        }
      ],
      "realWorldConnection": "Everyday shopping with realistic UK prices",
      "yearAppropriate": [
        1,
        2,
        3,
        4,
        5,
        6
      ],
      "templates": [
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "MULTI_STEP"
          ],
          "modelCompatibility": [
            "ADDITION"
          ],
          "operandCount": 3,
          "template": "{character} buys {article1} {item1} for {price1}, {article2} {item2} for {price2}, and {article3} {item3} for {price3}. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item1",
              "type": "item"
            },
            {
              "key": "item2",
              "type": "item"
            },
            {
              "key": "item3",
              "type": "item"
            },
            {
              "key": "price1",
              "type": "value"
            },
            {
              "key": "price2",
              "type": "value"
            },
            {
              "key": "price3",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "MULTI_STEP"
          ],
          "modelCompatibility": [
            "ADDITION"
          ],
          "operandCount": 2,
          "template": "{character} buys {article1} {item1} for {price1} and {article2} {item2} for {price2}. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item1",
              "type": "item"
            },
            {
              "key": "item2",
              "type": "item"
            },
            {
              "key": "price1",
              "type": "value"
            },
            {
              "key": "price2",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "SUBTRACTION",
            "CHANGE_CALCULATION"
          ],
          "template": "{character} buys {article} {item} for {price} and pays with {payment}. How much change does {character} get?",
          "answerTemplate": "{character} receives {result} in change",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "payment",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "MULTIPLICATION"
          ],
          "template": "{character} buys {quantity} {item} at {price} each. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "quantity",
              "type": "value"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "DIVISION"
          ],
          "template": "{character} has {total} to spend equally on {quantity} {item}. How much can {character} spend on each one?",
          "answerTemplate": "{character} can spend {result} on each {item}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "total",
              "type": "value"
            },
            {
              "key": "quantity",
              "type": "value"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "COMPARISON",
            "ESTIMATION",
            "MULTI_STEP"
          ],
          "template": "{character} goes to the shop and buys {items}. How much does {character} spend in total?",
          "answerTemplate": "{character} spends {result} in total",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "ESTIMATION"
          ],
          "template": "Estimate: If {character} buys {items}, about how much will it cost?",
          "answerTemplate": "It will cost approximately {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "VALIDATION"
          ],
          "template": "{character} calculated that {items} costs {amount}. Is this correct?",
          "answerTemplate": "{validation_result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "amount",
              "type": "value"
            },
            {
              "key": "validation_result",
              "type": "boolean"
            }
          ]
        }
      ]
    },
    "distractors": [],
    "enhancementStatus": {
      "level": "partial",
      "requestedFormat": "DIRECT_CALCULATION",
      "actualFormat": "DIRECT_CALCULATION",
      "featuresActive": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "featuresPending": [],
      "isFullyEnhanced": true
    },
    "mathOutput": {
      "operation": "MONEY_SCALING",
      "base_amount": 87
    },
    "generationTime": 1,
    "questionId": "q_1759232461896_jbjm5gjlr",
    "generationSetup": {
      "controller_used": "DIRECT_CALCULATIONController",
      "format_requested": "DIRECT_CALCULATION",
      "format_actual": "DIRECT_CALCULATION",
      "scenario_theme": "SHOPPING",
      "scenario_id": "shop-002-realistic-general",
      "scenario_selection_method": "default",
      "distractor_strategies": [],
      "distractor_count": 0,
      "theme_variety": false,
      "format_variety": false,
      "enhancement_level": "partial",
      "features_active": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "features_pending": [],
      "generation_time_ms": 1
    }
  },
  "metadata": {
    "format": "DIRECT_CALCULATION",
    "cognitive_load": 40,
    "curriculum_alignment": [
      "4N1a"
    ],
    "difficulty": "4.1",
    "scenario_theme": "SHOPPING",
    "distractor_strategies": [],
    "generation_time_ms": 1,
    "api_version": "2.0",
    "enhancement_status": "partial",
    "format_requested": "DIRECT_CALCULATION",
    "format_used": "DIRECT_CALCULATION",
    "features_active": [
      "enhanced_distractors",
      "rich_scenarios",
      "cognitive_load",
      "advanced_formats"
    ],
    "features_pending": []
  },
  "context": {
    "id": "shop-002-realistic-general",
    "theme": "SHOPPING",
    "setting": {
      "location": "local shop",
      "timeContext": "after school",
      "atmosphere": "friendly"
    },
    "characters": [
      {
        "name": "Logan",
        "role": "student"
      }
    ],
    "items": [
      {
        "name": "apple",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.2,
          "max": 0.5,
          "typical": 0.35,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "banana",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.15,
          "max": 0.4,
          "typical": 0.25,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sandwich",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 2.5,
          "max": 6,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "drink",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.8,
          "max": 2.5,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "cake",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 1.5,
          "max": 4,
          "typical": 2.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "biscuit",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.8,
          "max": 2,
          "typical": 1.2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sweet",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.1,
          "max": 1,
          "typical": 0.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "chocolate",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.6,
          "max": 3,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "pen",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.5,
          "max": 2,
          "typical": 1,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "pencil",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.2,
          "max": 1,
          "typical": 0.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "ruler",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.8,
          "max": 2.5,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "notebook",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 1,
          "max": 4,
          "typical": 2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "eraser",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.3,
          "max": 1.5,
          "typical": 0.75,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "book",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 3,
          "max": 15,
          "typical": 8,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "comic",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2,
          "max": 5,
          "typical": 3,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "magazine",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2.5,
          "max": 6,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "toy",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 5,
          "max": 25,
          "typical": 12,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "game",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 8,
          "max": 60,
          "typical": 25,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "puzzle",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 5,
          "max": 20,
          "typical": 12,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sticker",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 0.2,
          "max": 2,
          "typical": 0.8,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "badge",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 0.5,
          "max": 3,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "poster",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2,
          "max": 8,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "card",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 0.5,
          "max": 4,
          "typical": 2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      }
    ],
    "culturalElements": [
      {
        "type": "currency",
        "value": "£",
        "explanation": "British pounds"
      },
      {
        "type": "location",
        "value": "UK local shop",
        "explanation": "Typical British corner shop"
      }
    ],
    "realWorldConnection": "Everyday shopping with realistic UK prices",
    "yearAppropriate": [
      1,
      2,
      3,
      4,
      5,
      6
    ],
    "templates": [
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "MULTI_STEP"
        ],
        "modelCompatibility": [
          "ADDITION"
        ],
        "operandCount": 3,
        "template": "{character} buys {article1} {item1} for {price1}, {article2} {item2} for {price2}, and {article3} {item3} for {price3}. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item1",
            "type": "item"
          },
          {
            "key": "item2",
            "type": "item"
          },
          {
            "key": "item3",
            "type": "item"
          },
          {
            "key": "price1",
            "type": "value"
          },
          {
            "key": "price2",
            "type": "value"
          },
          {
            "key": "price3",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "MULTI_STEP"
        ],
        "modelCompatibility": [
          "ADDITION"
        ],
        "operandCount": 2,
        "template": "{character} buys {article1} {item1} for {price1} and {article2} {item2} for {price2}. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item1",
            "type": "item"
          },
          {
            "key": "item2",
            "type": "item"
          },
          {
            "key": "price1",
            "type": "value"
          },
          {
            "key": "price2",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "SUBTRACTION",
          "CHANGE_CALCULATION"
        ],
        "template": "{character} buys {article} {item} for {price} and pays with {payment}. How much change does {character} get?",
        "answerTemplate": "{character} receives {result} in change",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "payment",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "MULTIPLICATION"
        ],
        "template": "{character} buys {quantity} {item} at {price} each. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "quantity",
            "type": "value"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "DIVISION"
        ],
        "template": "{character} has {total} to spend equally on {quantity} {item}. How much can {character} spend on each one?",
        "answerTemplate": "{character} can spend {result} on each {item}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "total",
            "type": "value"
          },
          {
            "key": "quantity",
            "type": "value"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "COMPARISON",
          "ESTIMATION",
          "MULTI_STEP"
        ],
        "template": "{character} goes to the shop and buys {items}. How much does {character} spend in total?",
        "answerTemplate": "{character} spends {result} in total",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "ESTIMATION"
        ],
        "template": "Estimate: If {character} buys {items}, about how much will it cost?",
        "answerTemplate": "It will cost approximately {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "VALIDATION"
        ],
        "template": "{character} calculated that {items} costs {amount}. Is this correct?",
        "answerTemplate": "{validation_result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "amount",
            "type": "value"
          },
          {
            "key": "validation_result",
            "type": "boolean"
          }
        ]
      }
    ]
  }
}
# Test B.20: SHAPE_RECOGNITION model
{
  "success": true,
  "question": {
    "text": "Daniel buys an item for £5. How much does it cost?",
    "options": [
      {
        "value": 0,
        "text": "0p",
        "isCorrect": true
      }
    ],
    "correctIndex": 0,
    "format": "DIRECT_CALCULATION",
    "difficulty": {
      "year": 4,
      "subLevel": 1,
      "displayName": "4.1",
      "cognitiveLoad": 40
    },
    "cognitiveLoad": 40,
    "curriculumTags": [
      "4N1a"
    ],
    "scenario": {
      "id": "default-4-1759232461951",
      "theme": "SHOPPING",
      "setting": {
        "location": "shop",
        "timeContext": "afternoon",
        "atmosphere": "friendly"
      },
      "characters": [
        {
          "name": "Daniel",
          "role": "student"
        }
      ],
      "items": [
        {
          "name": "item",
          "category": "HOUSEHOLD_ITEMS",
          "typicalValue": {
            "min": 1,
            "max": 10,
            "typical": 5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        }
      ],
      "culturalElements": [
        {
          "type": "currency",
          "value": "£",
          "explanation": "British pounds"
        }
      ],
      "realWorldConnection": "Basic shopping calculations",
      "yearAppropriate": [
        4
      ],
      "templates": [
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "template": "{character} buys {article} {item} for {price}. How much does it cost?",
          "answerTemplate": "It costs {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        }
      ]
    },
    "distractors": [],
    "enhancementStatus": {
      "level": "partial",
      "requestedFormat": "DIRECT_CALCULATION",
      "actualFormat": "DIRECT_CALCULATION",
      "featuresActive": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "featuresPending": [],
      "isFullyEnhanced": true
    },
    "mathOutput": {
      "operation": "SHAPE_RECOGNITION"
    },
    "generationTime": 1,
    "questionId": "q_1759232461952_65df120bw",
    "generationSetup": {
      "controller_used": "DIRECT_CALCULATIONController",
      "format_requested": "DIRECT_CALCULATION",
      "format_actual": "DIRECT_CALCULATION",
      "scenario_theme": "SHOPPING",
      "scenario_id": "default-4-1759232461951",
      "scenario_selection_method": "default",
      "distractor_strategies": [],
      "distractor_count": 0,
      "theme_variety": false,
      "format_variety": false,
      "enhancement_level": "partial",
      "features_active": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "features_pending": [],
      "generation_time_ms": 1
    }
  },
  "metadata": {
    "format": "DIRECT_CALCULATION",
    "cognitive_load": 40,
    "curriculum_alignment": [
      "4N1a"
    ],
    "difficulty": "4.1",
    "scenario_theme": "SHOPPING",
    "distractor_strategies": [],
    "generation_time_ms": 1,
    "api_version": "2.0",
    "enhancement_status": "partial",
    "format_requested": "DIRECT_CALCULATION",
    "format_used": "DIRECT_CALCULATION",
    "features_active": [
      "enhanced_distractors",
      "rich_scenarios",
      "cognitive_load",
      "advanced_formats"
    ],
    "features_pending": []
  },
  "context": {
    "id": "default-4-1759232461951",
    "theme": "SHOPPING",
    "setting": {
      "location": "shop",
      "timeContext": "afternoon",
      "atmosphere": "friendly"
    },
    "characters": [
      {
        "name": "Daniel",
        "role": "student"
      }
    ],
    "items": [
      {
        "name": "item",
        "category": "HOUSEHOLD_ITEMS",
        "typicalValue": {
          "min": 1,
          "max": 10,
          "typical": 5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      }
    ],
    "culturalElements": [
      {
        "type": "currency",
        "value": "£",
        "explanation": "British pounds"
      }
    ],
    "realWorldConnection": "Basic shopping calculations",
    "yearAppropriate": [
      4
    ],
    "templates": [
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "template": "{character} buys {article} {item} for {price}. How much does it cost?",
        "answerTemplate": "It costs {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      }
    ]
  }
}
# Test B.21: SHAPE_PROPERTIES model
{
  "success": true,
  "question": {
    "text": "Olivia buys an item for £5. How much does it cost?",
    "options": [
      {
        "value": 0,
        "text": "0p",
        "isCorrect": true
      }
    ],
    "correctIndex": 0,
    "format": "DIRECT_CALCULATION",
    "difficulty": {
      "year": 4,
      "subLevel": 1,
      "displayName": "4.1",
      "cognitiveLoad": 40
    },
    "cognitiveLoad": 40,
    "curriculumTags": [
      "4N1a"
    ],
    "scenario": {
      "id": "default-4-1759232461995",
      "theme": "SHOPPING",
      "setting": {
        "location": "shop",
        "timeContext": "afternoon",
        "atmosphere": "friendly"
      },
      "characters": [
        {
          "name": "Olivia",
          "role": "student"
        }
      ],
      "items": [
        {
          "name": "item",
          "category": "HOUSEHOLD_ITEMS",
          "typicalValue": {
            "min": 1,
            "max": 10,
            "typical": 5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        }
      ],
      "culturalElements": [
        {
          "type": "currency",
          "value": "£",
          "explanation": "British pounds"
        }
      ],
      "realWorldConnection": "Basic shopping calculations",
      "yearAppropriate": [
        4
      ],
      "templates": [
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "template": "{character} buys {article} {item} for {price}. How much does it cost?",
          "answerTemplate": "It costs {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        }
      ]
    },
    "distractors": [],
    "enhancementStatus": {
      "level": "partial",
      "requestedFormat": "DIRECT_CALCULATION",
      "actualFormat": "DIRECT_CALCULATION",
      "featuresActive": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "featuresPending": [],
      "isFullyEnhanced": true
    },
    "mathOutput": {
      "operation": "SHAPE_PROPERTIES"
    },
    "generationTime": 1,
    "questionId": "q_1759232461995_2hiddj17n",
    "generationSetup": {
      "controller_used": "DIRECT_CALCULATIONController",
      "format_requested": "DIRECT_CALCULATION",
      "format_actual": "DIRECT_CALCULATION",
      "scenario_theme": "SHOPPING",
      "scenario_id": "default-4-1759232461995",
      "scenario_selection_method": "default",
      "distractor_strategies": [],
      "distractor_count": 0,
      "theme_variety": false,
      "format_variety": false,
      "enhancement_level": "partial",
      "features_active": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "features_pending": [],
      "generation_time_ms": 1
    }
  },
  "metadata": {
    "format": "DIRECT_CALCULATION",
    "cognitive_load": 40,
    "curriculum_alignment": [
      "4N1a"
    ],
    "difficulty": "4.1",
    "scenario_theme": "SHOPPING",
    "distractor_strategies": [],
    "generation_time_ms": 1,
    "api_version": "2.0",
    "enhancement_status": "partial",
    "format_requested": "DIRECT_CALCULATION",
    "format_used": "DIRECT_CALCULATION",
    "features_active": [
      "enhanced_distractors",
      "rich_scenarios",
      "cognitive_load",
      "advanced_formats"
    ],
    "features_pending": []
  },
  "context": {
    "id": "default-4-1759232461995",
    "theme": "SHOPPING",
    "setting": {
      "location": "shop",
      "timeContext": "afternoon",
      "atmosphere": "friendly"
    },
    "characters": [
      {
        "name": "Olivia",
        "role": "student"
      }
    ],
    "items": [
      {
        "name": "item",
        "category": "HOUSEHOLD_ITEMS",
        "typicalValue": {
          "min": 1,
          "max": 10,
          "typical": 5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      }
    ],
    "culturalElements": [
      {
        "type": "currency",
        "value": "£",
        "explanation": "British pounds"
      }
    ],
    "realWorldConnection": "Basic shopping calculations",
    "yearAppropriate": [
      4
    ],
    "templates": [
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "template": "{character} buys {article} {item} for {price}. How much does it cost?",
        "answerTemplate": "It costs {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      }
    ]
  }
}
# Test B.22: ANGLE_MEASUREMENT model
{
  "success": true,
  "question": {
    "text": "Elizabeth buys an item for £5. How much does it cost?",
    "options": [
      {
        "value": 0,
        "text": "0p",
        "isCorrect": true
      }
    ],
    "correctIndex": 0,
    "format": "DIRECT_CALCULATION",
    "difficulty": {
      "year": 4,
      "subLevel": 1,
      "displayName": "4.1",
      "cognitiveLoad": 40
    },
    "cognitiveLoad": 40,
    "curriculumTags": [
      "4N1a"
    ],
    "scenario": {
      "id": "default-4-1759232462039",
      "theme": "SHOPPING",
      "setting": {
        "location": "shop",
        "timeContext": "afternoon",
        "atmosphere": "friendly"
      },
      "characters": [
        {
          "name": "Elizabeth",
          "role": "student"
        }
      ],
      "items": [
        {
          "name": "item",
          "category": "HOUSEHOLD_ITEMS",
          "typicalValue": {
            "min": 1,
            "max": 10,
            "typical": 5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        }
      ],
      "culturalElements": [
        {
          "type": "currency",
          "value": "£",
          "explanation": "British pounds"
        }
      ],
      "realWorldConnection": "Basic shopping calculations",
      "yearAppropriate": [
        4
      ],
      "templates": [
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "template": "{character} buys {article} {item} for {price}. How much does it cost?",
          "answerTemplate": "It costs {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        }
      ]
    },
    "distractors": [],
    "enhancementStatus": {
      "level": "partial",
      "requestedFormat": "DIRECT_CALCULATION",
      "actualFormat": "DIRECT_CALCULATION",
      "featuresActive": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "featuresPending": [],
      "isFullyEnhanced": true
    },
    "mathOutput": {
      "operation": "ANGLE_MEASUREMENT",
      "angle_degrees": 60,
      "angle_type": "acute"
    },
    "generationTime": 0,
    "questionId": "q_1759232462039_2017diub3",
    "generationSetup": {
      "controller_used": "DIRECT_CALCULATIONController",
      "format_requested": "DIRECT_CALCULATION",
      "format_actual": "DIRECT_CALCULATION",
      "scenario_theme": "SHOPPING",
      "scenario_id": "default-4-1759232462039",
      "scenario_selection_method": "default",
      "distractor_strategies": [],
      "distractor_count": 0,
      "theme_variety": false,
      "format_variety": false,
      "enhancement_level": "partial",
      "features_active": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "features_pending": [],
      "generation_time_ms": 0
    }
  },
  "metadata": {
    "format": "DIRECT_CALCULATION",
    "cognitive_load": 40,
    "curriculum_alignment": [
      "4N1a"
    ],
    "difficulty": "4.1",
    "scenario_theme": "SHOPPING",
    "distractor_strategies": [],
    "generation_time_ms": 1,
    "api_version": "2.0",
    "enhancement_status": "partial",
    "format_requested": "DIRECT_CALCULATION",
    "format_used": "DIRECT_CALCULATION",
    "features_active": [
      "enhanced_distractors",
      "rich_scenarios",
      "cognitive_load",
      "advanced_formats"
    ],
    "features_pending": []
  },
  "context": {
    "id": "default-4-1759232462039",
    "theme": "SHOPPING",
    "setting": {
      "location": "shop",
      "timeContext": "afternoon",
      "atmosphere": "friendly"
    },
    "characters": [
      {
        "name": "Elizabeth",
        "role": "student"
      }
    ],
    "items": [
      {
        "name": "item",
        "category": "HOUSEHOLD_ITEMS",
        "typicalValue": {
          "min": 1,
          "max": 10,
          "typical": 5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      }
    ],
    "culturalElements": [
      {
        "type": "currency",
        "value": "£",
        "explanation": "British pounds"
      }
    ],
    "realWorldConnection": "Basic shopping calculations",
    "yearAppropriate": [
      4
    ],
    "templates": [
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "template": "{character} buys {article} {item} for {price}. How much does it cost?",
        "answerTemplate": "It costs {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      }
    ]
  }
}
# Test B.23: POSITION_DIRECTION model
{
  "success": true,
  "question": {
    "text": "Isabella buys an item for £5. How much does it cost?",
    "options": [
      {
        "value": 0,
        "text": "0p",
        "isCorrect": true
      }
    ],
    "correctIndex": 0,
    "format": "DIRECT_CALCULATION",
    "difficulty": {
      "year": 4,
      "subLevel": 1,
      "displayName": "4.1",
      "cognitiveLoad": 40
    },
    "cognitiveLoad": 40,
    "curriculumTags": [
      "4N1a"
    ],
    "scenario": {
      "id": "default-4-1759232462087",
      "theme": "SHOPPING",
      "setting": {
        "location": "shop",
        "timeContext": "afternoon",
        "atmosphere": "friendly"
      },
      "characters": [
        {
          "name": "Isabella",
          "role": "student"
        }
      ],
      "items": [
        {
          "name": "item",
          "category": "HOUSEHOLD_ITEMS",
          "typicalValue": {
            "min": 1,
            "max": 10,
            "typical": 5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        }
      ],
      "culturalElements": [
        {
          "type": "currency",
          "value": "£",
          "explanation": "British pounds"
        }
      ],
      "realWorldConnection": "Basic shopping calculations",
      "yearAppropriate": [
        4
      ],
      "templates": [
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "template": "{character} buys {article} {item} for {price}. How much does it cost?",
          "answerTemplate": "It costs {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        }
      ]
    },
    "distractors": [],
    "enhancementStatus": {
      "level": "partial",
      "requestedFormat": "DIRECT_CALCULATION",
      "actualFormat": "DIRECT_CALCULATION",
      "featuresActive": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "featuresPending": [],
      "isFullyEnhanced": true
    },
    "mathOutput": {
      "operation": "POSITION_DIRECTION"
    },
    "generationTime": 1,
    "questionId": "q_1759232462087_d9h9anklt",
    "generationSetup": {
      "controller_used": "DIRECT_CALCULATIONController",
      "format_requested": "DIRECT_CALCULATION",
      "format_actual": "DIRECT_CALCULATION",
      "scenario_theme": "SHOPPING",
      "scenario_id": "default-4-1759232462087",
      "scenario_selection_method": "default",
      "distractor_strategies": [],
      "distractor_count": 0,
      "theme_variety": false,
      "format_variety": false,
      "enhancement_level": "partial",
      "features_active": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "features_pending": [],
      "generation_time_ms": 1
    }
  },
  "metadata": {
    "format": "DIRECT_CALCULATION",
    "cognitive_load": 40,
    "curriculum_alignment": [
      "4N1a"
    ],
    "difficulty": "4.1",
    "scenario_theme": "SHOPPING",
    "distractor_strategies": [],
    "generation_time_ms": 2,
    "api_version": "2.0",
    "enhancement_status": "partial",
    "format_requested": "DIRECT_CALCULATION",
    "format_used": "DIRECT_CALCULATION",
    "features_active": [
      "enhanced_distractors",
      "rich_scenarios",
      "cognitive_load",
      "advanced_formats"
    ],
    "features_pending": []
  },
  "context": {
    "id": "default-4-1759232462087",
    "theme": "SHOPPING",
    "setting": {
      "location": "shop",
      "timeContext": "afternoon",
      "atmosphere": "friendly"
    },
    "characters": [
      {
        "name": "Isabella",
        "role": "student"
      }
    ],
    "items": [
      {
        "name": "item",
        "category": "HOUSEHOLD_ITEMS",
        "typicalValue": {
          "min": 1,
          "max": 10,
          "typical": 5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      }
    ],
    "culturalElements": [
      {
        "type": "currency",
        "value": "£",
        "explanation": "British pounds"
      }
    ],
    "realWorldConnection": "Basic shopping calculations",
    "yearAppropriate": [
      4
    ],
    "templates": [
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "template": "{character} buys {article} {item} for {price}. How much does it cost?",
        "answerTemplate": "It costs {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      }
    ]
  }
}
# Test B.24: AREA_PERIMETER model
{
  "success": true,
  "question": {
    "text": "Elijah buys an item for £5. How much does it cost?",
    "options": [
      {
        "value": 0,
        "text": "0p",
        "isCorrect": true
      }
    ],
    "correctIndex": 0,
    "format": "DIRECT_CALCULATION",
    "difficulty": {
      "year": 4,
      "subLevel": 1,
      "displayName": "4.1",
      "cognitiveLoad": 40
    },
    "cognitiveLoad": 40,
    "curriculumTags": [
      "4N1a"
    ],
    "scenario": {
      "id": "default-4-1759232462130",
      "theme": "SHOPPING",
      "setting": {
        "location": "shop",
        "timeContext": "afternoon",
        "atmosphere": "friendly"
      },
      "characters": [
        {
          "name": "Elijah",
          "role": "student"
        }
      ],
      "items": [
        {
          "name": "item",
          "category": "HOUSEHOLD_ITEMS",
          "typicalValue": {
            "min": 1,
            "max": 10,
            "typical": 5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        }
      ],
      "culturalElements": [
        {
          "type": "currency",
          "value": "£",
          "explanation": "British pounds"
        }
      ],
      "realWorldConnection": "Basic shopping calculations",
      "yearAppropriate": [
        4
      ],
      "templates": [
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "template": "{character} buys {article} {item} for {price}. How much does it cost?",
          "answerTemplate": "It costs {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        }
      ]
    },
    "distractors": [],
    "enhancementStatus": {
      "level": "partial",
      "requestedFormat": "DIRECT_CALCULATION",
      "actualFormat": "DIRECT_CALCULATION",
      "featuresActive": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "featuresPending": [],
      "isFullyEnhanced": true
    },
    "mathOutput": {
      "operation": "AREA_PERIMETER"
    },
    "generationTime": 1,
    "questionId": "q_1759232462131_1a44i0lpj",
    "generationSetup": {
      "controller_used": "DIRECT_CALCULATIONController",
      "format_requested": "DIRECT_CALCULATION",
      "format_actual": "DIRECT_CALCULATION",
      "scenario_theme": "SHOPPING",
      "scenario_id": "default-4-1759232462130",
      "scenario_selection_method": "default",
      "distractor_strategies": [],
      "distractor_count": 0,
      "theme_variety": false,
      "format_variety": false,
      "enhancement_level": "partial",
      "features_active": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "features_pending": [],
      "generation_time_ms": 1
    }
  },
  "metadata": {
    "format": "DIRECT_CALCULATION",
    "cognitive_load": 40,
    "curriculum_alignment": [
      "4N1a"
    ],
    "difficulty": "4.1",
    "scenario_theme": "SHOPPING",
    "distractor_strategies": [],
    "generation_time_ms": 1,
    "api_version": "2.0",
    "enhancement_status": "partial",
    "format_requested": "DIRECT_CALCULATION",
    "format_used": "DIRECT_CALCULATION",
    "features_active": [
      "enhanced_distractors",
      "rich_scenarios",
      "cognitive_load",
      "advanced_formats"
    ],
    "features_pending": []
  },
  "context": {
    "id": "default-4-1759232462130",
    "theme": "SHOPPING",
    "setting": {
      "location": "shop",
      "timeContext": "afternoon",
      "atmosphere": "friendly"
    },
    "characters": [
      {
        "name": "Elijah",
        "role": "student"
      }
    ],
    "items": [
      {
        "name": "item",
        "category": "HOUSEHOLD_ITEMS",
        "typicalValue": {
          "min": 1,
          "max": 10,
          "typical": 5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      }
    ],
    "culturalElements": [
      {
        "type": "currency",
        "value": "£",
        "explanation": "British pounds"
      }
    ],
    "realWorldConnection": "Basic shopping calculations",
    "yearAppropriate": [
      4
    ],
    "templates": [
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "template": "{character} buys {article} {item} for {price}. How much does it cost?",
        "answerTemplate": "It costs {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      }
    ]
  }
}

--- SUITE C: FORMAT COVERAGE TESTS ---
Testing every question format using the ADDITION model...
# Test C.1: DIRECT_CALCULATION format
{
  "success": true,
  "question": {
    "text": "Sarah wants to buy books at the book fair. Calculate the total cost.",
    "options": [
      {
        "text": "£12.89",
        "value": 12.89,
        "index": 0
      },
      {
        "text": "7.42",
        "value": 7.42,
        "index": 1
      },
      {
        "text": "22.89",
        "value": 22.89,
        "index": 2
      },
      {
        "text": "3.28",
        "value": 3.28,
        "index": 3
      }
    ],
    "correctIndex": 0,
    "format": "DIRECT_CALCULATION",
    "difficulty": {
      "year": 5,
      "subLevel": 3,
      "displayName": "5.3",
      "cognitiveLoad": 60
    },
    "cognitiveLoad": 60,
    "curriculumTags": [
      "5N1a",
      "5N1b"
    ],
    "scenario": {
      "id": "shop-001-bookfair",
      "theme": "SHOPPING",
      "setting": {
        "location": "school book fair",
        "timeContext": "lunch break",
        "atmosphere": "busy"
      },
      "characters": [
        {
          "name": "Sarah",
          "role": "student"
        },
        {
          "name": "Mr. Johnson",
          "role": "teacher"
        }
      ],
      "items": [
        {
          "name": "book",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 3,
            "max": 12,
            "typical": 6.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "bookmark",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.5,
            "max": 2,
            "typical": 1,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        }
      ],
      "culturalElements": [
        {
          "type": "currency",
          "value": "£",
          "explanation": "British pounds"
        },
        {
          "type": "event",
          "value": "book fair",
          "explanation": "School fundraising event"
        }
      ],
      "realWorldConnection": "School fundraising and reading promotion",
      "yearAppropriate": [
        2,
        3,
        4,
        5
      ],
      "templates": [
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "COMPARISON"
          ],
          "modelCompatibility": [
            "ADDITION",
            "COUNTING"
          ],
          "template": "{character} wants to buy books at the book fair. Calculate the total cost.",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        }
      ]
    },
    "distractors": [
      {
        "value": 3.28,
        "displayText": "3.28",
        "strategy": "WRONG_OPERATION",
        "reasoning": "Subtracted instead of adding"
      },
      {
        "value": 7.42,
        "displayText": "7.42",
        "strategy": "WRONG_OPERATION",
        "reasoning": "Multiplied instead of adding"
      },
      {
        "value": 22.89,
        "displayText": "22.89",
        "strategy": "PLACE_VALUE_ERROR",
        "reasoning": "Error in carrying to next column"
      }
    ],
    "enhancementStatus": {
      "level": "partial",
      "requestedFormat": "DIRECT_CALCULATION",
      "actualFormat": "DIRECT_CALCULATION",
      "featuresActive": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "featuresPending": [],
      "isFullyEnhanced": true
    },
    "mathOutput": {
      "operation": "ADDITION",
      "operand_1": 4.82,
      "operand_2": 1.54,
      "operand_3": 5.81,
      "operand_4": 0.72,
      "result": 12.89
    },
    "generationTime": 1,
    "questionId": "q_1759232462175_dg49ea86t",
    "generationSetup": {
      "controller_used": "DIRECT_CALCULATIONController",
      "format_requested": "DIRECT_CALCULATION",
      "format_actual": "DIRECT_CALCULATION",
      "scenario_theme": "SHOPPING",
      "scenario_id": "shop-001-bookfair",
      "scenario_selection_method": "default",
      "distractor_strategies": [
        "WRONG_OPERATION",
        "WRONG_OPERATION",
        "PLACE_VALUE_ERROR"
      ],
      "distractor_count": 3,
      "theme_variety": false,
      "format_variety": false,
      "enhancement_level": "partial",
      "features_active": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "features_pending": [],
      "generation_time_ms": 1
    }
  },
  "metadata": {
    "format": "DIRECT_CALCULATION",
    "cognitive_load": 60,
    "curriculum_alignment": [
      "5N1a",
      "5N1b"
    ],
    "difficulty": "5.3",
    "scenario_theme": "SHOPPING",
    "distractor_strategies": [
      "WRONG_OPERATION",
      "WRONG_OPERATION",
      "PLACE_VALUE_ERROR"
    ],
    "generation_time_ms": 1,
    "api_version": "2.0",
    "enhancement_status": "partial",
    "format_requested": "DIRECT_CALCULATION",
    "format_used": "DIRECT_CALCULATION",
    "features_active": [
      "enhanced_distractors",
      "rich_scenarios",
      "cognitive_load",
      "advanced_formats"
    ],
    "features_pending": []
  },
  "context": {
    "id": "shop-001-bookfair",
    "theme": "SHOPPING",
    "setting": {
      "location": "school book fair",
      "timeContext": "lunch break",
      "atmosphere": "busy"
    },
    "characters": [
      {
        "name": "Sarah",
        "role": "student"
      },
      {
        "name": "Mr. Johnson",
        "role": "teacher"
      }
    ],
    "items": [
      {
        "name": "book",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 3,
          "max": 12,
          "typical": 6.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "bookmark",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.5,
          "max": 2,
          "typical": 1,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      }
    ],
    "culturalElements": [
      {
        "type": "currency",
        "value": "£",
        "explanation": "British pounds"
      },
      {
        "type": "event",
        "value": "book fair",
        "explanation": "School fundraising event"
      }
    ],
    "realWorldConnection": "School fundraising and reading promotion",
    "yearAppropriate": [
      2,
      3,
      4,
      5
    ],
    "templates": [
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "COMPARISON"
        ],
        "modelCompatibility": [
          "ADDITION",
          "COUNTING"
        ],
        "template": "{character} wants to buy books at the book fair. Calculate the total cost.",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      }
    ]
  }
}
# Test C.2: COMPARISON format
{
  "success": true,
  "question": {
    "text": "Sarah is comparing options to find the best value.\n\nOption A: A: 737 + 543 + 306 + 960 = 2546\nOption B: B: 643 + 522 + 347 = 1512\n\nWhich calculation gives the higher result?",
    "options": [
      {
        "text": "Option A is better value",
        "value": 0,
        "index": 0
      },
      {
        "text": "Option B is better value",
        "value": 1,
        "index": 1
      },
      {
        "text": "Both options are equally good value",
        "value": -1,
        "index": 2
      },
      {
        "text": "Option B saves you £2068.00",
        "value": 1,
        "index": 3
      }
    ],
    "correctIndex": 1,
    "questionContent": {
      "fullText": "Sarah is comparing options to find the best value.\n\nOption A: A: 737 + 543 + 306 + 960 = 2546\nOption B: B: 643 + 522 + 347 = 1512\n\nWhich calculation gives the higher result?",
      "templateData": {
        "character": "Sarah",
        "optionA": "A: 737 + 543 + 306 + 960 = 2546",
        "optionB": "B: 643 + 522 + 347 = 1512",
        "context": "addition",
        "comparisonType": "calculated_value"
      }
    },
    "format": "COMPARISON",
    "difficulty": {
      "year": 5,
      "subLevel": 3,
      "displayName": "5.3",
      "cognitiveLoad": 60
    },
    "cognitiveLoad": 60,
    "curriculumTags": [
      "5N1a",
      "5N1b"
    ],
    "scenario": {
      "id": "shop-001-bookfair",
      "theme": "SHOPPING",
      "setting": {
        "location": "school book fair",
        "timeContext": "lunch break",
        "atmosphere": "busy"
      },
      "characters": [
        {
          "name": "Sarah",
          "role": "student"
        },
        {
          "name": "Mr. Johnson",
          "role": "teacher"
        }
      ],
      "items": [
        {
          "name": "book",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 3,
            "max": 12,
            "typical": 6.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "bookmark",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.5,
            "max": 2,
            "typical": 1,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        }
      ],
      "culturalElements": [
        {
          "type": "currency",
          "value": "£",
          "explanation": "British pounds"
        },
        {
          "type": "event",
          "value": "book fair",
          "explanation": "School fundraising event"
        }
      ],
      "realWorldConnection": "School fundraising and reading promotion",
      "yearAppropriate": [
        2,
        3,
        4,
        5
      ],
      "templates": [
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "COMPARISON"
          ],
          "modelCompatibility": [
            "ADDITION",
            "COUNTING"
          ],
          "template": "{character} wants to buy books at the book fair. Calculate the total cost.",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        }
      ]
    },
    "distractors": [
      {
        "value": 0,
        "displayText": "Option A is better value",
        "strategy": "REVERSED_COMPARISON",
        "reasoning": "Selected the option with lower value"
      },
      {
        "value": -1,
        "displayText": "Both options are equally good value",
        "strategy": "WRONG_SELECTION",
        "reasoning": "Failed to calculate the difference correctly"
      },
      {
        "value": 1,
        "displayText": "Option B saves you £2068.00",
        "strategy": "CALCULATION_ERROR",
        "reasoning": "Arithmetic error in calculating the difference"
      }
    ],
    "enhancementStatus": {
      "level": "full",
      "requestedFormat": "COMPARISON",
      "actualFormat": "COMPARISON",
      "featuresActive": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "featuresPending": [],
      "isFullyEnhanced": true
    },
    "mathOutput": {
      "operation": "ADDITION",
      "option_1_value": 2546,
      "option_2_value": 1512
    },
    "generationTime": 0,
    "questionId": "q_1759232462217_w0ul6dekz",
    "generationSetup": {
      "controller_used": "COMPARISONController",
      "format_requested": "COMPARISON",
      "format_actual": "COMPARISON",
      "scenario_theme": "SHOPPING",
      "scenario_id": "shop-001-bookfair",
      "scenario_selection_method": "default",
      "distractor_strategies": [
        "REVERSED_COMPARISON",
        "WRONG_SELECTION",
        "CALCULATION_ERROR"
      ],
      "distractor_count": 3,
      "theme_variety": false,
      "format_variety": false,
      "enhancement_level": "full",
      "features_active": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "features_pending": [],
      "generation_time_ms": 0
    }
  },
  "metadata": {
    "format": "COMPARISON",
    "cognitive_load": 60,
    "curriculum_alignment": [
      "5N1a",
      "5N1b"
    ],
    "difficulty": "5.3",
    "scenario_theme": "SHOPPING",
    "distractor_strategies": [
      "REVERSED_COMPARISON",
      "WRONG_SELECTION",
      "CALCULATION_ERROR"
    ],
    "generation_time_ms": 0,
    "api_version": "2.0",
    "enhancement_status": "full",
    "format_requested": "COMPARISON",
    "format_used": "COMPARISON",
    "features_active": [
      "enhanced_distractors",
      "rich_scenarios",
      "cognitive_load",
      "advanced_formats"
    ],
    "features_pending": []
  },
  "context": {
    "id": "shop-001-bookfair",
    "theme": "SHOPPING",
    "setting": {
      "location": "school book fair",
      "timeContext": "lunch break",
      "atmosphere": "busy"
    },
    "characters": [
      {
        "name": "Sarah",
        "role": "student"
      },
      {
        "name": "Mr. Johnson",
        "role": "teacher"
      }
    ],
    "items": [
      {
        "name": "book",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 3,
          "max": 12,
          "typical": 6.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "bookmark",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.5,
          "max": 2,
          "typical": 1,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      }
    ],
    "culturalElements": [
      {
        "type": "currency",
        "value": "£",
        "explanation": "British pounds"
      },
      {
        "type": "event",
        "value": "book fair",
        "explanation": "School fundraising event"
      }
    ],
    "realWorldConnection": "School fundraising and reading promotion",
    "yearAppropriate": [
      2,
      3,
      4,
      5
    ],
    "templates": [
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "COMPARISON"
        ],
        "modelCompatibility": [
          "ADDITION",
          "COUNTING"
        ],
        "template": "{character} wants to buy books at the book fair. Calculate the total cost.",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      }
    ]
  }
}
# Test C.3: ESTIMATION format
{
  "success": true,
  "question": {
    "text": "Sarah is adding £34.00 + £401.00 + £448.00 + £186.00. Round the result to the nearest hundreds.",
    "options": [
      {
        "text": "£1100.00",
        "value": 1100,
        "index": 0
      },
      {
        "text": "1100",
        "value": 1100,
        "index": 1
      },
      {
        "text": "1070",
        "value": 1070,
        "index": 2
      },
      {
        "text": "1000",
        "value": 1000,
        "index": 3
      }
    ],
    "correctIndex": 0,
    "questionContent": {
      "fullText": "Sarah is adding £34.00 + £401.00 + £448.00 + £186.00. Round the result to the nearest hundreds.",
      "templateData": {
        "character": "Sarah",
        "operation": "is adding £34.00 + £401.00 + £448.00 + £186.00",
        "roundingPlace": "hundreds",
        "exactValue": "1069",
        "roundedValue": "1100"
      }
    },
    "format": "ESTIMATION",
    "difficulty": {
      "year": 5,
      "subLevel": 3,
      "displayName": "5.3",
      "cognitiveLoad": 60
    },
    "cognitiveLoad": 60,
    "curriculumTags": [
      "5N1a",
      "5N1b"
    ],
    "scenario": {
      "id": "shop-001-bookfair",
      "theme": "SHOPPING",
      "setting": {
        "location": "school book fair",
        "timeContext": "lunch break",
        "atmosphere": "busy"
      },
      "characters": [
        {
          "name": "Sarah",
          "role": "student"
        },
        {
          "name": "Mr. Johnson",
          "role": "teacher"
        }
      ],
      "items": [
        {
          "name": "book",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 3,
            "max": 12,
            "typical": 6.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "bookmark",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.5,
            "max": 2,
            "typical": 1,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        }
      ],
      "culturalElements": [
        {
          "type": "currency",
          "value": "£",
          "explanation": "British pounds"
        },
        {
          "type": "event",
          "value": "book fair",
          "explanation": "School fundraising event"
        }
      ],
      "realWorldConnection": "School fundraising and reading promotion",
      "yearAppropriate": [
        2,
        3,
        4,
        5
      ],
      "templates": [
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "COMPARISON"
          ],
          "modelCompatibility": [
            "ADDITION",
            "COUNTING"
          ],
          "template": "{character} wants to buy books at the book fair. Calculate the total cost.",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        }
      ]
    },
    "distractors": [
      {
        "value": 1070,
        "strategy": "WRONG_OPERATION",
        "rationale": "Rounded to wrong place value"
      },
      {
        "value": 1000,
        "rationale": "Truncated instead of rounded"
      },
      {
        "value": 1100,
        "rationale": "Always rounded up"
      }
    ],
    "enhancementStatus": {
      "level": "full",
      "requestedFormat": "ESTIMATION",
      "actualFormat": "ESTIMATION",
      "featuresActive": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "featuresPending": [],
      "isFullyEnhanced": true
    },
    "mathOutput": {
      "operation": "ADDITION",
      "operands": [
        34,
        401,
        448,
        186
      ],
      "result": 1069,
      "intermediate_steps": [
        34,
        435,
        883
      ],
      "decimal_formatted": {
        "operands": [
          "34",
          "401",
          "448",
          "186"
        ],
        "result": "1069"
      },
      "exactValue": 1069,
      "roundedValue": 1100
    },
    "generationTime": 1,
    "questionId": "q_1759232462263_wixu9dpbh",
    "generationSetup": {
      "controller_used": "ESTIMATIONController",
      "format_requested": "ESTIMATION",
      "format_actual": "ESTIMATION",
      "scenario_theme": "SHOPPING",
      "scenario_id": "shop-001-bookfair",
      "scenario_selection_method": "default",
      "distractor_strategies": [
        "WRONG_OPERATION",
        null,
        null
      ],
      "distractor_count": 3,
      "theme_variety": false,
      "format_variety": false,
      "enhancement_level": "full",
      "features_active": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "features_pending": [],
      "generation_time_ms": 1
    }
  },
  "metadata": {
    "format": "ESTIMATION",
    "cognitive_load": 60,
    "curriculum_alignment": [
      "5N1a",
      "5N1b"
    ],
    "difficulty": "5.3",
    "scenario_theme": "SHOPPING",
    "distractor_strategies": [
      "WRONG_OPERATION",
      null,
      null
    ],
    "generation_time_ms": 1,
    "api_version": "2.0",
    "enhancement_status": "full",
    "format_requested": "ESTIMATION",
    "format_used": "ESTIMATION",
    "features_active": [
      "enhanced_distractors",
      "rich_scenarios",
      "cognitive_load",
      "advanced_formats"
    ],
    "features_pending": []
  },
  "context": {
    "id": "shop-001-bookfair",
    "theme": "SHOPPING",
    "setting": {
      "location": "school book fair",
      "timeContext": "lunch break",
      "atmosphere": "busy"
    },
    "characters": [
      {
        "name": "Sarah",
        "role": "student"
      },
      {
        "name": "Mr. Johnson",
        "role": "teacher"
      }
    ],
    "items": [
      {
        "name": "book",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 3,
          "max": 12,
          "typical": 6.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "bookmark",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.5,
          "max": 2,
          "typical": 1,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      }
    ],
    "culturalElements": [
      {
        "type": "currency",
        "value": "£",
        "explanation": "British pounds"
      },
      {
        "type": "event",
        "value": "book fair",
        "explanation": "School fundraising event"
      }
    ],
    "realWorldConnection": "School fundraising and reading promotion",
    "yearAppropriate": [
      2,
      3,
      4,
      5
    ],
    "templates": [
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "COMPARISON"
        ],
        "modelCompatibility": [
          "ADDITION",
          "COUNTING"
        ],
        "template": "{character} wants to buy books at the book fair. Calculate the total cost.",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      }
    ]
  }
}
# Test C.4: ORDERING format
{
  "success": true,
  "question": {
    "text": "Logan is comparing prices: 731, 225, 499, 132, 739, 366 pence. Arrange these prices from smallest to largest.",
    "options": [
      {
        "text": "132, 225, 366, 499, 731, 739",
        "value": 0,
        "index": 0
      },
      {
        "text": "739, 731, 499, 366, 225, 132",
        "value": 1,
        "index": 1
      },
      {
        "text": "731, 225, 499, 132, 739, 366",
        "value": 3,
        "index": 2
      },
      {
        "text": "132, 225, 366, 499, 739, 731",
        "value": 2,
        "index": 3
      }
    ],
    "correctIndex": 0,
    "questionContent": {
      "fullText": "Logan is comparing prices: 731, 225, 499, 132, 739, 366 pence. Arrange these prices from smallest to largest."
    },
    "format": "ORDERING",
    "difficulty": {
      "year": 5,
      "subLevel": 3,
      "displayName": "5.3",
      "cognitiveLoad": 60
    },
    "cognitiveLoad": 60,
    "curriculumTags": [
      "5N1a",
      "5N1b"
    ],
    "scenario": {
      "id": "shop-002-realistic-general",
      "theme": "SHOPPING",
      "setting": {
        "location": "local shop",
        "timeContext": "after school",
        "atmosphere": "friendly"
      },
      "characters": [
        {
          "name": "Logan",
          "role": "student"
        }
      ],
      "items": [
        {
          "name": "apple",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.2,
            "max": 0.5,
            "typical": 0.35,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "banana",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.15,
            "max": 0.4,
            "typical": 0.25,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sandwich",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 2.5,
            "max": 6,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "drink",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.8,
            "max": 2.5,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "cake",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 1.5,
            "max": 4,
            "typical": 2.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "biscuit",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.8,
            "max": 2,
            "typical": 1.2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sweet",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.1,
            "max": 1,
            "typical": 0.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "chocolate",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.6,
            "max": 3,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "pen",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.5,
            "max": 2,
            "typical": 1,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "pencil",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.2,
            "max": 1,
            "typical": 0.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "ruler",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.8,
            "max": 2.5,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "notebook",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 1,
            "max": 4,
            "typical": 2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "eraser",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.3,
            "max": 1.5,
            "typical": 0.75,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "book",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 3,
            "max": 15,
            "typical": 8,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "comic",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2,
            "max": 5,
            "typical": 3,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "magazine",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2.5,
            "max": 6,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "toy",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 5,
            "max": 25,
            "typical": 12,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "game",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 8,
            "max": 60,
            "typical": 25,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "puzzle",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 5,
            "max": 20,
            "typical": 12,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sticker",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 0.2,
            "max": 2,
            "typical": 0.8,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "badge",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 0.5,
            "max": 3,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "poster",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2,
            "max": 8,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "card",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 0.5,
            "max": 4,
            "typical": 2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        }
      ],
      "culturalElements": [
        {
          "type": "currency",
          "value": "£",
          "explanation": "British pounds"
        },
        {
          "type": "location",
          "value": "UK local shop",
          "explanation": "Typical British corner shop"
        }
      ],
      "realWorldConnection": "Everyday shopping with realistic UK prices",
      "yearAppropriate": [
        1,
        2,
        3,
        4,
        5,
        6
      ],
      "templates": [
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "MULTI_STEP"
          ],
          "modelCompatibility": [
            "ADDITION"
          ],
          "operandCount": 3,
          "template": "{character} buys {article1} {item1} for {price1}, {article2} {item2} for {price2}, and {article3} {item3} for {price3}. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item1",
              "type": "item"
            },
            {
              "key": "item2",
              "type": "item"
            },
            {
              "key": "item3",
              "type": "item"
            },
            {
              "key": "price1",
              "type": "value"
            },
            {
              "key": "price2",
              "type": "value"
            },
            {
              "key": "price3",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "MULTI_STEP"
          ],
          "modelCompatibility": [
            "ADDITION"
          ],
          "operandCount": 2,
          "template": "{character} buys {article1} {item1} for {price1} and {article2} {item2} for {price2}. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item1",
              "type": "item"
            },
            {
              "key": "item2",
              "type": "item"
            },
            {
              "key": "price1",
              "type": "value"
            },
            {
              "key": "price2",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "SUBTRACTION",
            "CHANGE_CALCULATION"
          ],
          "template": "{character} buys {article} {item} for {price} and pays with {payment}. How much change does {character} get?",
          "answerTemplate": "{character} receives {result} in change",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "payment",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "MULTIPLICATION"
          ],
          "template": "{character} buys {quantity} {item} at {price} each. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "quantity",
              "type": "value"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "DIVISION"
          ],
          "template": "{character} has {total} to spend equally on {quantity} {item}. How much can {character} spend on each one?",
          "answerTemplate": "{character} can spend {result} on each {item}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "total",
              "type": "value"
            },
            {
              "key": "quantity",
              "type": "value"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "COMPARISON",
            "ESTIMATION",
            "MULTI_STEP"
          ],
          "template": "{character} goes to the shop and buys {items}. How much does {character} spend in total?",
          "answerTemplate": "{character} spends {result} in total",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "ESTIMATION"
          ],
          "template": "Estimate: If {character} buys {items}, about how much will it cost?",
          "answerTemplate": "It will cost approximately {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "VALIDATION"
          ],
          "template": "{character} calculated that {items} costs {amount}. Is this correct?",
          "answerTemplate": "{validation_result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "amount",
              "type": "value"
            },
            {
              "key": "validation_result",
              "type": "boolean"
            }
          ]
        }
      ]
    },
    "distractors": [
      {
        "value": 1,
        "displayText": "739, 731, 499, 366, 225, 132",
        "reasoning": "Ordered in opposite direction"
      },
      {
        "value": 2,
        "displayText": "132, 225, 366, 499, 739, 731",
        "reasoning": "Partially correct ordering"
      },
      {
        "value": 3,
        "displayText": "731, 225, 499, 132, 739, 366",
        "reasoning": "Original unsorted order"
      }
    ],
    "enhancementStatus": {
      "level": "full",
      "requestedFormat": "ORDERING",
      "actualFormat": "ORDERING",
      "featuresActive": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "featuresPending": [],
      "isFullyEnhanced": true
    },
    "mathOutput": {
      "operation": "ADDITION",
      "operands": [
        297,
        590,
        474,
        124
      ],
      "result": 1485,
      "intermediate_steps": [
        297,
        887,
        1361
      ],
      "decimal_formatted": {
        "operands": [
          "297",
          "590",
          "474",
          "124"
        ],
        "result": "1485"
      }
    },
    "generationTime": 1,
    "questionId": "q_1759232462311_2vr2px6op",
    "generationSetup": {
      "controller_used": "ORDERINGController",
      "format_requested": "ORDERING",
      "format_actual": "ORDERING",
      "scenario_theme": "SHOPPING",
      "scenario_id": "shop-002-realistic-general",
      "scenario_selection_method": "default",
      "distractor_strategies": [
        null,
        null,
        null
      ],
      "distractor_count": 3,
      "theme_variety": false,
      "format_variety": false,
      "enhancement_level": "full",
      "features_active": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "features_pending": [],
      "generation_time_ms": 1
    }
  },
  "metadata": {
    "format": "ORDERING",
    "cognitive_load": 60,
    "curriculum_alignment": [
      "5N1a",
      "5N1b"
    ],
    "difficulty": "5.3",
    "scenario_theme": "SHOPPING",
    "distractor_strategies": [
      null,
      null,
      null
    ],
    "generation_time_ms": 1,
    "api_version": "2.0",
    "enhancement_status": "full",
    "format_requested": "ORDERING",
    "format_used": "ORDERING",
    "features_active": [
      "enhanced_distractors",
      "rich_scenarios",
      "cognitive_load",
      "advanced_formats"
    ],
    "features_pending": []
  },
  "context": {
    "id": "shop-002-realistic-general",
    "theme": "SHOPPING",
    "setting": {
      "location": "local shop",
      "timeContext": "after school",
      "atmosphere": "friendly"
    },
    "characters": [
      {
        "name": "Logan",
        "role": "student"
      }
    ],
    "items": [
      {
        "name": "apple",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.2,
          "max": 0.5,
          "typical": 0.35,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "banana",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.15,
          "max": 0.4,
          "typical": 0.25,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sandwich",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 2.5,
          "max": 6,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "drink",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.8,
          "max": 2.5,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "cake",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 1.5,
          "max": 4,
          "typical": 2.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "biscuit",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.8,
          "max": 2,
          "typical": 1.2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sweet",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.1,
          "max": 1,
          "typical": 0.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "chocolate",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.6,
          "max": 3,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "pen",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.5,
          "max": 2,
          "typical": 1,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "pencil",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.2,
          "max": 1,
          "typical": 0.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "ruler",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.8,
          "max": 2.5,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "notebook",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 1,
          "max": 4,
          "typical": 2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "eraser",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.3,
          "max": 1.5,
          "typical": 0.75,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "book",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 3,
          "max": 15,
          "typical": 8,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "comic",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2,
          "max": 5,
          "typical": 3,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "magazine",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2.5,
          "max": 6,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "toy",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 5,
          "max": 25,
          "typical": 12,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "game",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 8,
          "max": 60,
          "typical": 25,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "puzzle",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 5,
          "max": 20,
          "typical": 12,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sticker",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 0.2,
          "max": 2,
          "typical": 0.8,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "badge",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 0.5,
          "max": 3,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "poster",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2,
          "max": 8,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "card",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 0.5,
          "max": 4,
          "typical": 2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      }
    ],
    "culturalElements": [
      {
        "type": "currency",
        "value": "£",
        "explanation": "British pounds"
      },
      {
        "type": "location",
        "value": "UK local shop",
        "explanation": "Typical British corner shop"
      }
    ],
    "realWorldConnection": "Everyday shopping with realistic UK prices",
    "yearAppropriate": [
      1,
      2,
      3,
      4,
      5,
      6
    ],
    "templates": [
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "MULTI_STEP"
        ],
        "modelCompatibility": [
          "ADDITION"
        ],
        "operandCount": 3,
        "template": "{character} buys {article1} {item1} for {price1}, {article2} {item2} for {price2}, and {article3} {item3} for {price3}. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item1",
            "type": "item"
          },
          {
            "key": "item2",
            "type": "item"
          },
          {
            "key": "item3",
            "type": "item"
          },
          {
            "key": "price1",
            "type": "value"
          },
          {
            "key": "price2",
            "type": "value"
          },
          {
            "key": "price3",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "MULTI_STEP"
        ],
        "modelCompatibility": [
          "ADDITION"
        ],
        "operandCount": 2,
        "template": "{character} buys {article1} {item1} for {price1} and {article2} {item2} for {price2}. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item1",
            "type": "item"
          },
          {
            "key": "item2",
            "type": "item"
          },
          {
            "key": "price1",
            "type": "value"
          },
          {
            "key": "price2",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "SUBTRACTION",
          "CHANGE_CALCULATION"
        ],
        "template": "{character} buys {article} {item} for {price} and pays with {payment}. How much change does {character} get?",
        "answerTemplate": "{character} receives {result} in change",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "payment",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "MULTIPLICATION"
        ],
        "template": "{character} buys {quantity} {item} at {price} each. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "quantity",
            "type": "value"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "DIVISION"
        ],
        "template": "{character} has {total} to spend equally on {quantity} {item}. How much can {character} spend on each one?",
        "answerTemplate": "{character} can spend {result} on each {item}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "total",
            "type": "value"
          },
          {
            "key": "quantity",
            "type": "value"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "COMPARISON",
          "ESTIMATION",
          "MULTI_STEP"
        ],
        "template": "{character} goes to the shop and buys {items}. How much does {character} spend in total?",
        "answerTemplate": "{character} spends {result} in total",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "ESTIMATION"
        ],
        "template": "Estimate: If {character} buys {items}, about how much will it cost?",
        "answerTemplate": "It will cost approximately {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "VALIDATION"
        ],
        "template": "{character} calculated that {items} costs {amount}. Is this correct?",
        "answerTemplate": "{validation_result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "amount",
            "type": "value"
          },
          {
            "key": "validation_result",
            "type": "boolean"
          }
        ]
      }
    ]
  }
}
# Test C.5: VALIDATION format
{
  "success": true,
  "question": {
    "text": "Sarah showed their working:\\n940 + 291 + 892 + 176\\n= 649\\n\\nIs this working correct?",
    "options": [
      {
        "text": "Incorrect",
        "value": 0,
        "index": 0
      },
      {
        "text": "Incorrect",
        "value": 0,
        "index": 1
      }
    ],
    "correctIndex": 0,
    "questionContent": {
      "fullText": "Sarah showed their working:\\n940 + 291 + 892 + 176\\n= 649\\n\\nIs this working correct?"
    },
    "format": "VALIDATION",
    "difficulty": {
      "year": 5,
      "subLevel": 3,
      "displayName": "5.3",
      "cognitiveLoad": 60
    },
    "cognitiveLoad": 60,
    "curriculumTags": [
      "5N1a",
      "5N1b"
    ],
    "scenario": {
      "id": "shop-001-bookfair",
      "theme": "SHOPPING",
      "setting": {
        "location": "school book fair",
        "timeContext": "lunch break",
        "atmosphere": "busy"
      },
      "characters": [
        {
          "name": "Sarah",
          "role": "student"
        },
        {
          "name": "Mr. Johnson",
          "role": "teacher"
        }
      ],
      "items": [
        {
          "name": "book",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 3,
            "max": 12,
            "typical": 6.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "bookmark",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.5,
            "max": 2,
            "typical": 1,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        }
      ],
      "culturalElements": [
        {
          "type": "currency",
          "value": "£",
          "explanation": "British pounds"
        },
        {
          "type": "event",
          "value": "book fair",
          "explanation": "School fundraising event"
        }
      ],
      "realWorldConnection": "School fundraising and reading promotion",
      "yearAppropriate": [
        2,
        3,
        4,
        5
      ],
      "templates": [
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "COMPARISON"
          ],
          "modelCompatibility": [
            "ADDITION",
            "COUNTING"
          ],
          "template": "{character} wants to buy books at the book fair. Calculate the total cost.",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        }
      ]
    },
    "distractors": [
      {
        "value": 0,
        "displayText": "Incorrect",
        "reasoning": "Incorrectly identified correct work as wrong"
      }
    ],
    "enhancementStatus": {
      "level": "full",
      "requestedFormat": "VALIDATION",
      "actualFormat": "VALIDATION",
      "featuresActive": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "featuresPending": [],
      "isFullyEnhanced": true
    },
    "mathOutput": {
      "operation": "ADDITION",
      "operands": [
        940,
        291,
        892,
        176
      ],
      "result": 2299,
      "intermediate_steps": [
        940,
        1231,
        2123
      ],
      "decimal_formatted": {
        "operands": [
          "940",
          "291",
          "892",
          "176"
        ],
        "result": "2299"
      }
    },
    "generationTime": 1,
    "questionId": "q_1759232462357_zm9d4mchx",
    "generationSetup": {
      "controller_used": "VALIDATIONController",
      "format_requested": "VALIDATION",
      "format_actual": "VALIDATION",
      "scenario_theme": "SHOPPING",
      "scenario_id": "shop-001-bookfair",
      "scenario_selection_method": "default",
      "distractor_strategies": [
        null
      ],
      "distractor_count": 1,
      "theme_variety": false,
      "format_variety": false,
      "enhancement_level": "full",
      "features_active": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "features_pending": [],
      "generation_time_ms": 1
    }
  },
  "metadata": {
    "format": "VALIDATION",
    "cognitive_load": 60,
    "curriculum_alignment": [
      "5N1a",
      "5N1b"
    ],
    "difficulty": "5.3",
    "scenario_theme": "SHOPPING",
    "distractor_strategies": [
      null
    ],
    "generation_time_ms": 1,
    "api_version": "2.0",
    "enhancement_status": "full",
    "format_requested": "VALIDATION",
    "format_used": "VALIDATION",
    "features_active": [
      "enhanced_distractors",
      "rich_scenarios",
      "cognitive_load",
      "advanced_formats"
    ],
    "features_pending": []
  },
  "context": {
    "id": "shop-001-bookfair",
    "theme": "SHOPPING",
    "setting": {
      "location": "school book fair",
      "timeContext": "lunch break",
      "atmosphere": "busy"
    },
    "characters": [
      {
        "name": "Sarah",
        "role": "student"
      },
      {
        "name": "Mr. Johnson",
        "role": "teacher"
      }
    ],
    "items": [
      {
        "name": "book",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 3,
          "max": 12,
          "typical": 6.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "bookmark",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.5,
          "max": 2,
          "typical": 1,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      }
    ],
    "culturalElements": [
      {
        "type": "currency",
        "value": "£",
        "explanation": "British pounds"
      },
      {
        "type": "event",
        "value": "book fair",
        "explanation": "School fundraising event"
      }
    ],
    "realWorldConnection": "School fundraising and reading promotion",
    "yearAppropriate": [
      2,
      3,
      4,
      5
    ],
    "templates": [
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "COMPARISON"
        ],
        "modelCompatibility": [
          "ADDITION",
          "COUNTING"
        ],
        "template": "{character} wants to buy books at the book fair. Calculate the total cost.",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      }
    ]
  }
}
# Test C.6: MULTI_STEP format
{
  "success": true,
  "question": {
    "text": "Logan is shopping and needs to make several calculations. First, Logan adds the cost of 441p and 178p items. Next, Logan gets a 3p discount. Then Logan adds 79p more to the total. What is the final result?",
    "options": [
      {
        "text": "698",
        "value": 698,
        "index": 0
      },
      {
        "text": "695",
        "value": 695,
        "index": 1
      },
      {
        "text": "619",
        "value": 619,
        "index": 2
      },
      {
        "text": "£695.00",
        "value": 695,
        "index": 3
      }
    ],
    "correctIndex": 1,
    "questionContent": {
      "fullText": "Logan is shopping and needs to make several calculations. First, Logan adds the cost of 441p and 178p items. Next, Logan gets a 3p discount. Then Logan adds 79p more to the total. What is the final result?",
      "components": {
        "narrative": "Logan needs to solve this step by step:",
        "steps": [
          {
            "stepNumber": 1,
            "text": "Add 441 and 178",
            "operation": "ADDITION",
            "values": [
              441,
              178
            ],
            "result": 619,
            "description": "Add 441 and 178"
          },
          {
            "stepNumber": 2,
            "text": "Subtract 3 from 619",
            "operation": "SUBTRACTION",
            "values": [
              619,
              3
            ],
            "result": 616,
            "description": "Subtract 3 from 619"
          },
          {
            "stepNumber": 3,
            "text": "Add 79 to 616",
            "operation": "ADDITION",
            "values": [
              616,
              79
            ],
            "result": 695,
            "description": "Add 79 to 616"
          }
        ],
        "prompt": "What is the final result?",
        "highlightValues": [
          441,
          178,
          619,
          619,
          3,
          616,
          616,
          79,
          695
        ],
        "operators": [
          "+",
          "-"
        ]
      },
      "templateData": {
        "character": "Logan",
        "context": "local shop",
        "theme": "SHOPPING",
        "quantities": [
          441,
          619,
          616
        ],
        "prices": [
          178,
          3,
          79
        ],
        "action": "calculating step by step"
      }
    },
    "format": "MULTI_STEP",
    "difficulty": {
      "year": 5,
      "subLevel": 3,
      "displayName": "5.3",
      "cognitiveLoad": 60
    },
    "cognitiveLoad": 60,
    "curriculumTags": [
      "5N1a",
      "5N1b"
    ],
    "scenario": {
      "id": "shop-002-realistic-general",
      "theme": "SHOPPING",
      "setting": {
        "location": "local shop",
        "timeContext": "after school",
        "atmosphere": "friendly"
      },
      "characters": [
        {
          "name": "Logan",
          "role": "student"
        }
      ],
      "items": [
        {
          "name": "apple",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.2,
            "max": 0.5,
            "typical": 0.35,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "banana",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.15,
            "max": 0.4,
            "typical": 0.25,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sandwich",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 2.5,
            "max": 6,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "drink",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.8,
            "max": 2.5,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "cake",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 1.5,
            "max": 4,
            "typical": 2.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "biscuit",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.8,
            "max": 2,
            "typical": 1.2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sweet",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.1,
            "max": 1,
            "typical": 0.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "chocolate",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.6,
            "max": 3,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "pen",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.5,
            "max": 2,
            "typical": 1,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "pencil",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.2,
            "max": 1,
            "typical": 0.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "ruler",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.8,
            "max": 2.5,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "notebook",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 1,
            "max": 4,
            "typical": 2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "eraser",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.3,
            "max": 1.5,
            "typical": 0.75,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "book",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 3,
            "max": 15,
            "typical": 8,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "comic",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2,
            "max": 5,
            "typical": 3,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "magazine",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2.5,
            "max": 6,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "toy",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 5,
            "max": 25,
            "typical": 12,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "game",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 8,
            "max": 60,
            "typical": 25,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "puzzle",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 5,
            "max": 20,
            "typical": 12,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sticker",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 0.2,
            "max": 2,
            "typical": 0.8,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "badge",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 0.5,
            "max": 3,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "poster",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2,
            "max": 8,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "card",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 0.5,
            "max": 4,
            "typical": 2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        }
      ],
      "culturalElements": [
        {
          "type": "currency",
          "value": "£",
          "explanation": "British pounds"
        },
        {
          "type": "location",
          "value": "UK local shop",
          "explanation": "Typical British corner shop"
        }
      ],
      "realWorldConnection": "Everyday shopping with realistic UK prices",
      "yearAppropriate": [
        1,
        2,
        3,
        4,
        5,
        6
      ],
      "templates": [
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "MULTI_STEP"
          ],
          "modelCompatibility": [
            "ADDITION"
          ],
          "operandCount": 3,
          "template": "{character} buys {article1} {item1} for {price1}, {article2} {item2} for {price2}, and {article3} {item3} for {price3}. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item1",
              "type": "item"
            },
            {
              "key": "item2",
              "type": "item"
            },
            {
              "key": "item3",
              "type": "item"
            },
            {
              "key": "price1",
              "type": "value"
            },
            {
              "key": "price2",
              "type": "value"
            },
            {
              "key": "price3",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "MULTI_STEP"
          ],
          "modelCompatibility": [
            "ADDITION"
          ],
          "operandCount": 2,
          "template": "{character} buys {article1} {item1} for {price1} and {article2} {item2} for {price2}. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item1",
              "type": "item"
            },
            {
              "key": "item2",
              "type": "item"
            },
            {
              "key": "price1",
              "type": "value"
            },
            {
              "key": "price2",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "SUBTRACTION",
            "CHANGE_CALCULATION"
          ],
          "template": "{character} buys {article} {item} for {price} and pays with {payment}. How much change does {character} get?",
          "answerTemplate": "{character} receives {result} in change",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "payment",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "MULTIPLICATION"
          ],
          "template": "{character} buys {quantity} {item} at {price} each. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "quantity",
              "type": "value"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "DIVISION"
          ],
          "template": "{character} has {total} to spend equally on {quantity} {item}. How much can {character} spend on each one?",
          "answerTemplate": "{character} can spend {result} on each {item}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "total",
              "type": "value"
            },
            {
              "key": "quantity",
              "type": "value"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "COMPARISON",
            "ESTIMATION",
            "MULTI_STEP"
          ],
          "template": "{character} goes to the shop and buys {items}. How much does {character} spend in total?",
          "answerTemplate": "{character} spends {result} in total",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "ESTIMATION"
          ],
          "template": "Estimate: If {character} buys {items}, about how much will it cost?",
          "answerTemplate": "It will cost approximately {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "VALIDATION"
          ],
          "template": "{character} calculated that {items} costs {amount}. Is this correct?",
          "answerTemplate": "{validation_result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "amount",
              "type": "value"
            },
            {
              "key": "validation_result",
              "type": "boolean"
            }
          ]
        }
      ]
    },
    "distractors": [
      {
        "value": 619,
        "rationale": "Stopped after first step"
      },
      {
        "value": 695,
        "strategy": "WRONG_OPERATION",
        "rationale": "Used wrong operation in step 2"
      },
      {
        "value": 698,
        "rationale": "Performed operations in wrong order"
      }
    ],
    "enhancementStatus": {
      "level": "full",
      "requestedFormat": "MULTI_STEP",
      "actualFormat": "MULTI_STEP",
      "featuresActive": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "featuresPending": [],
      "isFullyEnhanced": true
    },
    "mathOutput": {
      "operation": "ADDITION",
      "operands": [
        253,
        15,
        955,
        241
      ],
      "result": 1464,
      "intermediate_steps": [
        253,
        268,
        1223
      ],
      "decimal_formatted": {
        "operands": [
          "253",
          "15",
          "955",
          "241"
        ],
        "result": "1464"
      }
    },
    "generationTime": 1,
    "questionId": "q_1759232462400_gact7ltf5",
    "generationSetup": {
      "controller_used": "MULTI_STEPController",
      "format_requested": "MULTI_STEP",
      "format_actual": "MULTI_STEP",
      "scenario_theme": "SHOPPING",
      "scenario_id": "shop-002-realistic-general",
      "scenario_selection_method": "default",
      "distractor_strategies": [
        null,
        "WRONG_OPERATION",
        null
      ],
      "distractor_count": 3,
      "theme_variety": false,
      "format_variety": false,
      "enhancement_level": "full",
      "features_active": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "features_pending": [],
      "generation_time_ms": 1
    }
  },
  "metadata": {
    "format": "MULTI_STEP",
    "cognitive_load": 60,
    "curriculum_alignment": [
      "5N1a",
      "5N1b"
    ],
    "difficulty": "5.3",
    "scenario_theme": "SHOPPING",
    "distractor_strategies": [
      null,
      "WRONG_OPERATION",
      null
    ],
    "generation_time_ms": 1,
    "api_version": "2.0",
    "enhancement_status": "full",
    "format_requested": "MULTI_STEP",
    "format_used": "MULTI_STEP",
    "features_active": [
      "enhanced_distractors",
      "rich_scenarios",
      "cognitive_load",
      "advanced_formats"
    ],
    "features_pending": []
  },
  "context": {
    "id": "shop-002-realistic-general",
    "theme": "SHOPPING",
    "setting": {
      "location": "local shop",
      "timeContext": "after school",
      "atmosphere": "friendly"
    },
    "characters": [
      {
        "name": "Logan",
        "role": "student"
      }
    ],
    "items": [
      {
        "name": "apple",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.2,
          "max": 0.5,
          "typical": 0.35,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "banana",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.15,
          "max": 0.4,
          "typical": 0.25,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sandwich",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 2.5,
          "max": 6,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "drink",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.8,
          "max": 2.5,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "cake",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 1.5,
          "max": 4,
          "typical": 2.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "biscuit",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.8,
          "max": 2,
          "typical": 1.2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sweet",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.1,
          "max": 1,
          "typical": 0.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "chocolate",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.6,
          "max": 3,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "pen",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.5,
          "max": 2,
          "typical": 1,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "pencil",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.2,
          "max": 1,
          "typical": 0.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "ruler",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.8,
          "max": 2.5,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "notebook",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 1,
          "max": 4,
          "typical": 2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "eraser",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.3,
          "max": 1.5,
          "typical": 0.75,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "book",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 3,
          "max": 15,
          "typical": 8,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "comic",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2,
          "max": 5,
          "typical": 3,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "magazine",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2.5,
          "max": 6,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "toy",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 5,
          "max": 25,
          "typical": 12,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "game",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 8,
          "max": 60,
          "typical": 25,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "puzzle",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 5,
          "max": 20,
          "typical": 12,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sticker",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 0.2,
          "max": 2,
          "typical": 0.8,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "badge",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 0.5,
          "max": 3,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "poster",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2,
          "max": 8,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "card",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 0.5,
          "max": 4,
          "typical": 2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      }
    ],
    "culturalElements": [
      {
        "type": "currency",
        "value": "£",
        "explanation": "British pounds"
      },
      {
        "type": "location",
        "value": "UK local shop",
        "explanation": "Typical British corner shop"
      }
    ],
    "realWorldConnection": "Everyday shopping with realistic UK prices",
    "yearAppropriate": [
      1,
      2,
      3,
      4,
      5,
      6
    ],
    "templates": [
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "MULTI_STEP"
        ],
        "modelCompatibility": [
          "ADDITION"
        ],
        "operandCount": 3,
        "template": "{character} buys {article1} {item1} for {price1}, {article2} {item2} for {price2}, and {article3} {item3} for {price3}. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item1",
            "type": "item"
          },
          {
            "key": "item2",
            "type": "item"
          },
          {
            "key": "item3",
            "type": "item"
          },
          {
            "key": "price1",
            "type": "value"
          },
          {
            "key": "price2",
            "type": "value"
          },
          {
            "key": "price3",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "MULTI_STEP"
        ],
        "modelCompatibility": [
          "ADDITION"
        ],
        "operandCount": 2,
        "template": "{character} buys {article1} {item1} for {price1} and {article2} {item2} for {price2}. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item1",
            "type": "item"
          },
          {
            "key": "item2",
            "type": "item"
          },
          {
            "key": "price1",
            "type": "value"
          },
          {
            "key": "price2",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "SUBTRACTION",
          "CHANGE_CALCULATION"
        ],
        "template": "{character} buys {article} {item} for {price} and pays with {payment}. How much change does {character} get?",
        "answerTemplate": "{character} receives {result} in change",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "payment",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "MULTIPLICATION"
        ],
        "template": "{character} buys {quantity} {item} at {price} each. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "quantity",
            "type": "value"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "DIVISION"
        ],
        "template": "{character} has {total} to spend equally on {quantity} {item}. How much can {character} spend on each one?",
        "answerTemplate": "{character} can spend {result} on each {item}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "total",
            "type": "value"
          },
          {
            "key": "quantity",
            "type": "value"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "COMPARISON",
          "ESTIMATION",
          "MULTI_STEP"
        ],
        "template": "{character} goes to the shop and buys {items}. How much does {character} spend in total?",
        "answerTemplate": "{character} spends {result} in total",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "ESTIMATION"
        ],
        "template": "Estimate: If {character} buys {items}, about how much will it cost?",
        "answerTemplate": "It will cost approximately {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "VALIDATION"
        ],
        "template": "{character} calculated that {items} costs {amount}. Is this correct?",
        "answerTemplate": "{validation_result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "amount",
            "type": "value"
          },
          {
            "key": "validation_result",
            "type": "boolean"
          }
        ]
      }
    ]
  }
}
# Test C.7: MISSING_VALUE format
{
  "success": true,
  "question": {
    "text": "Logan needs to balance this equation: 234 + 934 = 2170 - 5. What number should replace the ? to make both sides equal?",
    "options": [
      {
        "text": "234",
        "value": 234,
        "index": 0
      },
      {
        "text": "2165",
        "value": 2165,
        "index": 1
      },
      {
        "value": 2193.7101839534575,
        "text": "£2193.71",
        "isCorrect": false
      },
      {
        "text": "2163",
        "value": 2163,
        "index": 3
      }
    ],
    "correctIndex": 1,
    "questionContent": {
      "fullText": "Logan needs to balance this equation: 234 + 934 = 2170 - 5. What number should replace the ? to make both sides equal?"
    },
    "format": "MISSING_VALUE",
    "difficulty": {
      "year": 5,
      "subLevel": 3,
      "displayName": "5.3",
      "cognitiveLoad": 60
    },
    "cognitiveLoad": 60,
    "curriculumTags": [
      "5N1a",
      "5N1b"
    ],
    "scenario": {
      "id": "shop-002-realistic-general",
      "theme": "SHOPPING",
      "setting": {
        "location": "local shop",
        "timeContext": "after school",
        "atmosphere": "friendly"
      },
      "characters": [
        {
          "name": "Logan",
          "role": "student"
        }
      ],
      "items": [
        {
          "name": "apple",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.2,
            "max": 0.5,
            "typical": 0.35,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "banana",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.15,
            "max": 0.4,
            "typical": 0.25,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sandwich",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 2.5,
            "max": 6,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "drink",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.8,
            "max": 2.5,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "cake",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 1.5,
            "max": 4,
            "typical": 2.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "biscuit",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.8,
            "max": 2,
            "typical": 1.2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sweet",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.1,
            "max": 1,
            "typical": 0.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "chocolate",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.6,
            "max": 3,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "pen",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.5,
            "max": 2,
            "typical": 1,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "pencil",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.2,
            "max": 1,
            "typical": 0.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "ruler",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.8,
            "max": 2.5,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "notebook",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 1,
            "max": 4,
            "typical": 2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "eraser",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.3,
            "max": 1.5,
            "typical": 0.75,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "book",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 3,
            "max": 15,
            "typical": 8,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "comic",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2,
            "max": 5,
            "typical": 3,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "magazine",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2.5,
            "max": 6,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "toy",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 5,
            "max": 25,
            "typical": 12,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "game",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 8,
            "max": 60,
            "typical": 25,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "puzzle",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 5,
            "max": 20,
            "typical": 12,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sticker",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 0.2,
            "max": 2,
            "typical": 0.8,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "badge",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 0.5,
            "max": 3,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "poster",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2,
            "max": 8,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "card",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 0.5,
            "max": 4,
            "typical": 2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        }
      ],
      "culturalElements": [
        {
          "type": "currency",
          "value": "£",
          "explanation": "British pounds"
        },
        {
          "type": "location",
          "value": "UK local shop",
          "explanation": "Typical British corner shop"
        }
      ],
      "realWorldConnection": "Everyday shopping with realistic UK prices",
      "yearAppropriate": [
        1,
        2,
        3,
        4,
        5,
        6
      ],
      "templates": [
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "MULTI_STEP"
          ],
          "modelCompatibility": [
            "ADDITION"
          ],
          "operandCount": 3,
          "template": "{character} buys {article1} {item1} for {price1}, {article2} {item2} for {price2}, and {article3} {item3} for {price3}. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item1",
              "type": "item"
            },
            {
              "key": "item2",
              "type": "item"
            },
            {
              "key": "item3",
              "type": "item"
            },
            {
              "key": "price1",
              "type": "value"
            },
            {
              "key": "price2",
              "type": "value"
            },
            {
              "key": "price3",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "MULTI_STEP"
          ],
          "modelCompatibility": [
            "ADDITION"
          ],
          "operandCount": 2,
          "template": "{character} buys {article1} {item1} for {price1} and {article2} {item2} for {price2}. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item1",
              "type": "item"
            },
            {
              "key": "item2",
              "type": "item"
            },
            {
              "key": "price1",
              "type": "value"
            },
            {
              "key": "price2",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "SUBTRACTION",
            "CHANGE_CALCULATION"
          ],
          "template": "{character} buys {article} {item} for {price} and pays with {payment}. How much change does {character} get?",
          "answerTemplate": "{character} receives {result} in change",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "payment",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "MULTIPLICATION"
          ],
          "template": "{character} buys {quantity} {item} at {price} each. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "quantity",
              "type": "value"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "DIVISION"
          ],
          "template": "{character} has {total} to spend equally on {quantity} {item}. How much can {character} spend on each one?",
          "answerTemplate": "{character} can spend {result} on each {item}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "total",
              "type": "value"
            },
            {
              "key": "quantity",
              "type": "value"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "COMPARISON",
            "ESTIMATION",
            "MULTI_STEP"
          ],
          "template": "{character} goes to the shop and buys {items}. How much does {character} spend in total?",
          "answerTemplate": "{character} spends {result} in total",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "ESTIMATION"
          ],
          "template": "Estimate: If {character} buys {items}, about how much will it cost?",
          "answerTemplate": "It will cost approximately {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "VALIDATION"
          ],
          "template": "{character} calculated that {items} costs {amount}. Is this correct?",
          "answerTemplate": "{validation_result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "amount",
              "type": "value"
            },
            {
              "key": "validation_result",
              "type": "boolean"
            }
          ]
        }
      ]
    },
    "distractors": [
      {
        "value": null,
        "strategy": "WRONG_OPERATION",
        "rationale": "Used wrong operation to solve"
      },
      {
        "value": 2163,
        "strategy": "CALCULATION_ERROR",
        "rationale": "Arithmetic calculation error"
      },
      {
        "value": 234,
        "rationale": "Confused given value with missing value"
      }
    ],
    "enhancementStatus": {
      "level": "full",
      "requestedFormat": "MISSING_VALUE",
      "actualFormat": "MISSING_VALUE",
      "featuresActive": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "featuresPending": [],
      "isFullyEnhanced": true
    },
    "mathOutput": {
      "operation": "ADDITION",
      "operands": [
        234,
        934,
        744,
        253
      ],
      "result": 2165,
      "intermediate_steps": [
        234,
        1168,
        1912
      ],
      "decimal_formatted": {
        "operands": [
          "234",
          "934",
          "744",
          "253"
        ],
        "result": "2165"
      }
    },
    "generationTime": 0,
    "questionId": "q_1759232462445_gyw00ib15",
    "generationSetup": {
      "controller_used": "MISSING_VALUEController",
      "format_requested": "MISSING_VALUE",
      "format_actual": "MISSING_VALUE",
      "scenario_theme": "SHOPPING",
      "scenario_id": "shop-002-realistic-general",
      "scenario_selection_method": "default",
      "distractor_strategies": [
        "WRONG_OPERATION",
        "CALCULATION_ERROR",
        null
      ],
      "distractor_count": 3,
      "theme_variety": false,
      "format_variety": false,
      "enhancement_level": "full",
      "features_active": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "features_pending": [],
      "generation_time_ms": 0
    }
  },
  "metadata": {
    "format": "MISSING_VALUE",
    "cognitive_load": 60,
    "curriculum_alignment": [
      "5N1a",
      "5N1b"
    ],
    "difficulty": "5.3",
    "scenario_theme": "SHOPPING",
    "distractor_strategies": [
      "WRONG_OPERATION",
      "CALCULATION_ERROR",
      null
    ],
    "generation_time_ms": 0,
    "api_version": "2.0",
    "enhancement_status": "full",
    "format_requested": "MISSING_VALUE",
    "format_used": "MISSING_VALUE",
    "features_active": [
      "enhanced_distractors",
      "rich_scenarios",
      "cognitive_load",
      "advanced_formats"
    ],
    "features_pending": []
  },
  "context": {
    "id": "shop-002-realistic-general",
    "theme": "SHOPPING",
    "setting": {
      "location": "local shop",
      "timeContext": "after school",
      "atmosphere": "friendly"
    },
    "characters": [
      {
        "name": "Logan",
        "role": "student"
      }
    ],
    "items": [
      {
        "name": "apple",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.2,
          "max": 0.5,
          "typical": 0.35,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "banana",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.15,
          "max": 0.4,
          "typical": 0.25,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sandwich",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 2.5,
          "max": 6,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "drink",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.8,
          "max": 2.5,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "cake",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 1.5,
          "max": 4,
          "typical": 2.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "biscuit",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.8,
          "max": 2,
          "typical": 1.2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sweet",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.1,
          "max": 1,
          "typical": 0.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "chocolate",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.6,
          "max": 3,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "pen",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.5,
          "max": 2,
          "typical": 1,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "pencil",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.2,
          "max": 1,
          "typical": 0.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "ruler",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.8,
          "max": 2.5,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "notebook",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 1,
          "max": 4,
          "typical": 2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "eraser",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.3,
          "max": 1.5,
          "typical": 0.75,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "book",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 3,
          "max": 15,
          "typical": 8,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "comic",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2,
          "max": 5,
          "typical": 3,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "magazine",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2.5,
          "max": 6,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "toy",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 5,
          "max": 25,
          "typical": 12,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "game",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 8,
          "max": 60,
          "typical": 25,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "puzzle",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 5,
          "max": 20,
          "typical": 12,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sticker",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 0.2,
          "max": 2,
          "typical": 0.8,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "badge",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 0.5,
          "max": 3,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "poster",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2,
          "max": 8,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "card",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 0.5,
          "max": 4,
          "typical": 2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      }
    ],
    "culturalElements": [
      {
        "type": "currency",
        "value": "£",
        "explanation": "British pounds"
      },
      {
        "type": "location",
        "value": "UK local shop",
        "explanation": "Typical British corner shop"
      }
    ],
    "realWorldConnection": "Everyday shopping with realistic UK prices",
    "yearAppropriate": [
      1,
      2,
      3,
      4,
      5,
      6
    ],
    "templates": [
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "MULTI_STEP"
        ],
        "modelCompatibility": [
          "ADDITION"
        ],
        "operandCount": 3,
        "template": "{character} buys {article1} {item1} for {price1}, {article2} {item2} for {price2}, and {article3} {item3} for {price3}. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item1",
            "type": "item"
          },
          {
            "key": "item2",
            "type": "item"
          },
          {
            "key": "item3",
            "type": "item"
          },
          {
            "key": "price1",
            "type": "value"
          },
          {
            "key": "price2",
            "type": "value"
          },
          {
            "key": "price3",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "MULTI_STEP"
        ],
        "modelCompatibility": [
          "ADDITION"
        ],
        "operandCount": 2,
        "template": "{character} buys {article1} {item1} for {price1} and {article2} {item2} for {price2}. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item1",
            "type": "item"
          },
          {
            "key": "item2",
            "type": "item"
          },
          {
            "key": "price1",
            "type": "value"
          },
          {
            "key": "price2",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "SUBTRACTION",
          "CHANGE_CALCULATION"
        ],
        "template": "{character} buys {article} {item} for {price} and pays with {payment}. How much change does {character} get?",
        "answerTemplate": "{character} receives {result} in change",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "payment",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "MULTIPLICATION"
        ],
        "template": "{character} buys {quantity} {item} at {price} each. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "quantity",
            "type": "value"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "DIVISION"
        ],
        "template": "{character} has {total} to spend equally on {quantity} {item}. How much can {character} spend on each one?",
        "answerTemplate": "{character} can spend {result} on each {item}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "total",
            "type": "value"
          },
          {
            "key": "quantity",
            "type": "value"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "COMPARISON",
          "ESTIMATION",
          "MULTI_STEP"
        ],
        "template": "{character} goes to the shop and buys {items}. How much does {character} spend in total?",
        "answerTemplate": "{character} spends {result} in total",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "ESTIMATION"
        ],
        "template": "Estimate: If {character} buys {items}, about how much will it cost?",
        "answerTemplate": "It will cost approximately {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "VALIDATION"
        ],
        "template": "{character} calculated that {items} costs {amount}. Is this correct?",
        "answerTemplate": "{validation_result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "amount",
            "type": "value"
          },
          {
            "key": "validation_result",
            "type": "boolean"
          }
        ]
      }
    ]
  }
}
# Test C.8: PATTERN_RECOGNITION format
{
  "success": true,
  "question": {
    "text": "Sarah needs to find the missing number in this pattern: 40, 41, 44, ?, 56, 65, 76",
    "options": [
      {
        "text": "2624",
        "value": 2624,
        "index": 0
      },
      {
        "text": "48",
        "value": 48,
        "index": 1
      },
      {
        "text": "54",
        "value": 54,
        "index": 2
      },
      {
        "text": "49",
        "value": 49,
        "index": 3
      }
    ],
    "correctIndex": 3,
    "questionContent": {
      "fullText": "Sarah needs to find the missing number in this pattern: 40, 41, 44, ?, 56, 65, 76"
    },
    "format": "PATTERN_RECOGNITION",
    "difficulty": {
      "year": 5,
      "subLevel": 3,
      "displayName": "5.3",
      "cognitiveLoad": 60
    },
    "cognitiveLoad": 60,
    "curriculumTags": [
      "5N1a",
      "5N1b"
    ],
    "scenario": {
      "id": "shop-001-bookfair",
      "theme": "SHOPPING",
      "setting": {
        "location": "school book fair",
        "timeContext": "lunch break",
        "atmosphere": "busy"
      },
      "characters": [
        {
          "name": "Sarah",
          "role": "student"
        },
        {
          "name": "Mr. Johnson",
          "role": "teacher"
        }
      ],
      "items": [
        {
          "name": "book",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 3,
            "max": 12,
            "typical": 6.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "bookmark",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.5,
            "max": 2,
            "typical": 1,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        }
      ],
      "culturalElements": [
        {
          "type": "currency",
          "value": "£",
          "explanation": "British pounds"
        },
        {
          "type": "event",
          "value": "book fair",
          "explanation": "School fundraising event"
        }
      ],
      "realWorldConnection": "School fundraising and reading promotion",
      "yearAppropriate": [
        2,
        3,
        4,
        5
      ],
      "templates": [
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "COMPARISON"
          ],
          "modelCompatibility": [
            "ADDITION",
            "COUNTING"
          ],
          "template": "{character} wants to buy books at the book fair. Calculate the total cost.",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        }
      ]
    },
    "distractors": [
      {
        "value": 54,
        "strategy": "WRONG_OPERATION",
        "rationale": "Used wrong operation for pattern"
      },
      {
        "value": 2624,
        "rationale": "Started pattern from wrong position"
      },
      {
        "value": 48,
        "strategy": "CALCULATION_ERROR",
        "rationale": "Off by one error"
      }
    ],
    "enhancementStatus": {
      "level": "full",
      "requestedFormat": "PATTERN_RECOGNITION",
      "actualFormat": "PATTERN_RECOGNITION",
      "featuresActive": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "featuresPending": [],
      "isFullyEnhanced": true
    },
    "mathOutput": {
      "operation": "ADDITION",
      "operands": [
        97,
        266,
        764,
        62
      ],
      "result": 1189,
      "intermediate_steps": [
        97,
        363,
        1127
      ],
      "decimal_formatted": {
        "operands": [
          "97",
          "266",
          "764",
          "62"
        ],
        "result": "1189"
      }
    },
    "generationTime": 1,
    "questionId": "q_1759232462488_6bsd8yvt3",
    "generationSetup": {
      "controller_used": "PATTERN_RECOGNITIONController",
      "format_requested": "PATTERN_RECOGNITION",
      "format_actual": "PATTERN_RECOGNITION",
      "scenario_theme": "SHOPPING",
      "scenario_id": "shop-001-bookfair",
      "scenario_selection_method": "default",
      "distractor_strategies": [
        "WRONG_OPERATION",
        null,
        "CALCULATION_ERROR"
      ],
      "distractor_count": 3,
      "theme_variety": false,
      "format_variety": false,
      "enhancement_level": "full",
      "features_active": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "features_pending": [],
      "generation_time_ms": 1
    }
  },
  "metadata": {
    "format": "PATTERN_RECOGNITION",
    "cognitive_load": 60,
    "curriculum_alignment": [
      "5N1a",
      "5N1b"
    ],
    "difficulty": "5.3",
    "scenario_theme": "SHOPPING",
    "distractor_strategies": [
      "WRONG_OPERATION",
      null,
      "CALCULATION_ERROR"
    ],
    "generation_time_ms": 1,
    "api_version": "2.0",
    "enhancement_status": "full",
    "format_requested": "PATTERN_RECOGNITION",
    "format_used": "PATTERN_RECOGNITION",
    "features_active": [
      "enhanced_distractors",
      "rich_scenarios",
      "cognitive_load",
      "advanced_formats"
    ],
    "features_pending": []
  },
  "context": {
    "id": "shop-001-bookfair",
    "theme": "SHOPPING",
    "setting": {
      "location": "school book fair",
      "timeContext": "lunch break",
      "atmosphere": "busy"
    },
    "characters": [
      {
        "name": "Sarah",
        "role": "student"
      },
      {
        "name": "Mr. Johnson",
        "role": "teacher"
      }
    ],
    "items": [
      {
        "name": "book",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 3,
          "max": 12,
          "typical": 6.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "bookmark",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.5,
          "max": 2,
          "typical": 1,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      }
    ],
    "culturalElements": [
      {
        "type": "currency",
        "value": "£",
        "explanation": "British pounds"
      },
      {
        "type": "event",
        "value": "book fair",
        "explanation": "School fundraising event"
      }
    ],
    "realWorldConnection": "School fundraising and reading promotion",
    "yearAppropriate": [
      2,
      3,
      4,
      5
    ],
    "templates": [
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "COMPARISON"
        ],
        "modelCompatibility": [
          "ADDITION",
          "COUNTING"
        ],
        "template": "{character} wants to buy books at the book fair. Calculate the total cost.",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      }
    ]
  }
}

--- SUITE D: DIFFICULTY PROGRESSION TESTS ---
Testing smooth difficulty increase for the MULTIPLICATION model...
# Test D.1: MULTIPLICATION at difficulty 2.1
{
  "success": true,
  "question": {
    "text": "Logan buys 2 apple at 30p each. What is the total cost?",
    "options": [
      {
        "text": "4",
        "value": 4,
        "index": 0
      },
      {
        "text": "8",
        "value": 8,
        "index": 1
      },
      {
        "text": "-0.4",
        "value": -0.4,
        "index": 2
      },
      {
        "text": "60p",
        "value": 0.6,
        "index": 3
      }
    ],
    "correctIndex": 3,
    "format": "DIRECT_CALCULATION",
    "difficulty": {
      "year": 2,
      "subLevel": 1,
      "displayName": "2.1",
      "cognitiveLoad": 20
    },
    "cognitiveLoad": 20,
    "curriculumTags": [
      "2N1a"
    ],
    "scenario": {
      "id": "shop-002-realistic-general",
      "theme": "SHOPPING",
      "setting": {
        "location": "local shop",
        "timeContext": "after school",
        "atmosphere": "friendly"
      },
      "characters": [
        {
          "name": "Logan",
          "role": "student"
        }
      ],
      "items": [
        {
          "name": "apple",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.2,
            "max": 0.5,
            "typical": 0.35,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "banana",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.15,
            "max": 0.4,
            "typical": 0.25,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sandwich",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 2.5,
            "max": 6,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "drink",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.8,
            "max": 2.5,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "cake",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 1.5,
            "max": 4,
            "typical": 2.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "biscuit",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.8,
            "max": 2,
            "typical": 1.2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sweet",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.1,
            "max": 1,
            "typical": 0.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "chocolate",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.6,
            "max": 3,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "pen",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.5,
            "max": 2,
            "typical": 1,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "pencil",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.2,
            "max": 1,
            "typical": 0.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "ruler",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.8,
            "max": 2.5,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "notebook",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 1,
            "max": 4,
            "typical": 2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "eraser",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.3,
            "max": 1.5,
            "typical": 0.75,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "book",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 3,
            "max": 15,
            "typical": 8,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "comic",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2,
            "max": 5,
            "typical": 3,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "magazine",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2.5,
            "max": 6,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "toy",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 5,
            "max": 25,
            "typical": 12,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "game",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 8,
            "max": 60,
            "typical": 25,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "puzzle",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 5,
            "max": 20,
            "typical": 12,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sticker",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 0.2,
            "max": 2,
            "typical": 0.8,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "badge",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 0.5,
            "max": 3,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "poster",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2,
            "max": 8,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "card",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 0.5,
            "max": 4,
            "typical": 2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        }
      ],
      "culturalElements": [
        {
          "type": "currency",
          "value": "£",
          "explanation": "British pounds"
        },
        {
          "type": "location",
          "value": "UK local shop",
          "explanation": "Typical British corner shop"
        }
      ],
      "realWorldConnection": "Everyday shopping with realistic UK prices",
      "yearAppropriate": [
        1,
        2,
        3,
        4,
        5,
        6
      ],
      "templates": [
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "MULTI_STEP"
          ],
          "modelCompatibility": [
            "ADDITION"
          ],
          "operandCount": 3,
          "template": "{character} buys {article1} {item1} for {price1}, {article2} {item2} for {price2}, and {article3} {item3} for {price3}. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item1",
              "type": "item"
            },
            {
              "key": "item2",
              "type": "item"
            },
            {
              "key": "item3",
              "type": "item"
            },
            {
              "key": "price1",
              "type": "value"
            },
            {
              "key": "price2",
              "type": "value"
            },
            {
              "key": "price3",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "MULTI_STEP"
          ],
          "modelCompatibility": [
            "ADDITION"
          ],
          "operandCount": 2,
          "template": "{character} buys {article1} {item1} for {price1} and {article2} {item2} for {price2}. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item1",
              "type": "item"
            },
            {
              "key": "item2",
              "type": "item"
            },
            {
              "key": "price1",
              "type": "value"
            },
            {
              "key": "price2",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "SUBTRACTION",
            "CHANGE_CALCULATION"
          ],
          "template": "{character} buys {article} {item} for {price} and pays with {payment}. How much change does {character} get?",
          "answerTemplate": "{character} receives {result} in change",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "payment",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "MULTIPLICATION"
          ],
          "template": "{character} buys {quantity} {item} at {price} each. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "quantity",
              "type": "value"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "DIVISION"
          ],
          "template": "{character} has {total} to spend equally on {quantity} {item}. How much can {character} spend on each one?",
          "answerTemplate": "{character} can spend {result} on each {item}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "total",
              "type": "value"
            },
            {
              "key": "quantity",
              "type": "value"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "COMPARISON",
            "ESTIMATION",
            "MULTI_STEP"
          ],
          "template": "{character} goes to the shop and buys {items}. How much does {character} spend in total?",
          "answerTemplate": "{character} spends {result} in total",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "ESTIMATION"
          ],
          "template": "Estimate: If {character} buys {items}, about how much will it cost?",
          "answerTemplate": "It will cost approximately {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "VALIDATION"
          ],
          "template": "{character} calculated that {items} costs {amount}. Is this correct?",
          "answerTemplate": "{validation_result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "amount",
              "type": "value"
            },
            {
              "key": "validation_result",
              "type": "boolean"
            }
          ]
        }
      ]
    },
    "distractors": [
      {
        "value": -0.4,
        "displayText": "-0.4",
        "strategy": "COMMON_MISCONCEPTION",
        "reasoning": "Counting error"
      },
      {
        "value": 8,
        "displayText": "8",
        "strategy": "WRONG_OPERATION",
        "reasoning": "Added instead of multiplying"
      },
      {
        "value": 4,
        "displayText": "4",
        "strategy": "WRONG_OPERATION",
        "reasoning": "Subtracted instead of multiplying"
      }
    ],
    "enhancementStatus": {
      "level": "partial",
      "requestedFormat": "DIRECT_CALCULATION",
      "actualFormat": "DIRECT_CALCULATION",
      "featuresActive": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "featuresPending": [],
      "isFullyEnhanced": true
    },
    "mathOutput": {
      "operation": "MULTIPLICATION",
      "multiplier": 2,
      "multiplicand": 0.3,
      "result": 0.6
    },
    "generationTime": 0,
    "questionId": "q_1759232462532_x8qwp8o9f",
    "generationSetup": {
      "controller_used": "DIRECT_CALCULATIONController",
      "format_requested": "DIRECT_CALCULATION",
      "format_actual": "DIRECT_CALCULATION",
      "scenario_theme": "SHOPPING",
      "scenario_id": "shop-002-realistic-general",
      "scenario_selection_method": "default",
      "distractor_strategies": [
        "COMMON_MISCONCEPTION",
        "WRONG_OPERATION",
        "WRONG_OPERATION"
      ],
      "distractor_count": 3,
      "theme_variety": false,
      "format_variety": false,
      "enhancement_level": "partial",
      "features_active": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "features_pending": [],
      "generation_time_ms": 0
    }
  },
  "metadata": {
    "format": "DIRECT_CALCULATION",
    "cognitive_load": 20,
    "curriculum_alignment": [
      "2N1a"
    ],
    "difficulty": "2.1",
    "scenario_theme": "SHOPPING",
    "distractor_strategies": [
      "COMMON_MISCONCEPTION",
      "WRONG_OPERATION",
      "WRONG_OPERATION"
    ],
    "generation_time_ms": 0,
    "api_version": "2.0",
    "enhancement_status": "partial",
    "format_requested": "DIRECT_CALCULATION",
    "format_used": "DIRECT_CALCULATION",
    "features_active": [
      "enhanced_distractors",
      "rich_scenarios",
      "cognitive_load",
      "advanced_formats"
    ],
    "features_pending": []
  },
  "context": {
    "id": "shop-002-realistic-general",
    "theme": "SHOPPING",
    "setting": {
      "location": "local shop",
      "timeContext": "after school",
      "atmosphere": "friendly"
    },
    "characters": [
      {
        "name": "Logan",
        "role": "student"
      }
    ],
    "items": [
      {
        "name": "apple",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.2,
          "max": 0.5,
          "typical": 0.35,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "banana",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.15,
          "max": 0.4,
          "typical": 0.25,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sandwich",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 2.5,
          "max": 6,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "drink",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.8,
          "max": 2.5,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "cake",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 1.5,
          "max": 4,
          "typical": 2.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "biscuit",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.8,
          "max": 2,
          "typical": 1.2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sweet",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.1,
          "max": 1,
          "typical": 0.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "chocolate",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.6,
          "max": 3,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "pen",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.5,
          "max": 2,
          "typical": 1,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "pencil",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.2,
          "max": 1,
          "typical": 0.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "ruler",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.8,
          "max": 2.5,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "notebook",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 1,
          "max": 4,
          "typical": 2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "eraser",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.3,
          "max": 1.5,
          "typical": 0.75,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "book",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 3,
          "max": 15,
          "typical": 8,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "comic",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2,
          "max": 5,
          "typical": 3,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "magazine",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2.5,
          "max": 6,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "toy",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 5,
          "max": 25,
          "typical": 12,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "game",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 8,
          "max": 60,
          "typical": 25,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "puzzle",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 5,
          "max": 20,
          "typical": 12,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sticker",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 0.2,
          "max": 2,
          "typical": 0.8,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "badge",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 0.5,
          "max": 3,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "poster",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2,
          "max": 8,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "card",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 0.5,
          "max": 4,
          "typical": 2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      }
    ],
    "culturalElements": [
      {
        "type": "currency",
        "value": "£",
        "explanation": "British pounds"
      },
      {
        "type": "location",
        "value": "UK local shop",
        "explanation": "Typical British corner shop"
      }
    ],
    "realWorldConnection": "Everyday shopping with realistic UK prices",
    "yearAppropriate": [
      1,
      2,
      3,
      4,
      5,
      6
    ],
    "templates": [
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "MULTI_STEP"
        ],
        "modelCompatibility": [
          "ADDITION"
        ],
        "operandCount": 3,
        "template": "{character} buys {article1} {item1} for {price1}, {article2} {item2} for {price2}, and {article3} {item3} for {price3}. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item1",
            "type": "item"
          },
          {
            "key": "item2",
            "type": "item"
          },
          {
            "key": "item3",
            "type": "item"
          },
          {
            "key": "price1",
            "type": "value"
          },
          {
            "key": "price2",
            "type": "value"
          },
          {
            "key": "price3",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "MULTI_STEP"
        ],
        "modelCompatibility": [
          "ADDITION"
        ],
        "operandCount": 2,
        "template": "{character} buys {article1} {item1} for {price1} and {article2} {item2} for {price2}. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item1",
            "type": "item"
          },
          {
            "key": "item2",
            "type": "item"
          },
          {
            "key": "price1",
            "type": "value"
          },
          {
            "key": "price2",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "SUBTRACTION",
          "CHANGE_CALCULATION"
        ],
        "template": "{character} buys {article} {item} for {price} and pays with {payment}. How much change does {character} get?",
        "answerTemplate": "{character} receives {result} in change",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "payment",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "MULTIPLICATION"
        ],
        "template": "{character} buys {quantity} {item} at {price} each. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "quantity",
            "type": "value"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "DIVISION"
        ],
        "template": "{character} has {total} to spend equally on {quantity} {item}. How much can {character} spend on each one?",
        "answerTemplate": "{character} can spend {result} on each {item}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "total",
            "type": "value"
          },
          {
            "key": "quantity",
            "type": "value"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "COMPARISON",
          "ESTIMATION",
          "MULTI_STEP"
        ],
        "template": "{character} goes to the shop and buys {items}. How much does {character} spend in total?",
        "answerTemplate": "{character} spends {result} in total",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "ESTIMATION"
        ],
        "template": "Estimate: If {character} buys {items}, about how much will it cost?",
        "answerTemplate": "It will cost approximately {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "VALIDATION"
        ],
        "template": "{character} calculated that {items} costs {amount}. Is this correct?",
        "answerTemplate": "{validation_result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "amount",
            "type": "value"
          },
          {
            "key": "validation_result",
            "type": "boolean"
          }
        ]
      }
    ]
  }
}
# Test D.2: MULTIPLICATION at difficulty 2.4
{
  "success": true,
  "question": {
    "text": "Logan buys 2 apple at 26p each. What is the total cost?",
    "options": [
      {
        "text": "12",
        "value": 12,
        "index": 0
      },
      {
        "text": "52p",
        "value": 0.52,
        "index": 1
      },
      {
        "text": "-0.48",
        "value": -0.48,
        "index": 2
      },
      {
        "text": "8",
        "value": 8,
        "index": 3
      }
    ],
    "correctIndex": 1,
    "format": "DIRECT_CALCULATION",
    "difficulty": {
      "year": 2,
      "subLevel": 4,
      "displayName": "2.4",
      "cognitiveLoad": 35
    },
    "cognitiveLoad": 35,
    "curriculumTags": [
      "2N1a"
    ],
    "scenario": {
      "id": "shop-002-realistic-general",
      "theme": "SHOPPING",
      "setting": {
        "location": "local shop",
        "timeContext": "after school",
        "atmosphere": "friendly"
      },
      "characters": [
        {
          "name": "Logan",
          "role": "student"
        }
      ],
      "items": [
        {
          "name": "apple",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.2,
            "max": 0.5,
            "typical": 0.35,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "banana",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.15,
            "max": 0.4,
            "typical": 0.25,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sandwich",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 2.5,
            "max": 6,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "drink",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.8,
            "max": 2.5,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "cake",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 1.5,
            "max": 4,
            "typical": 2.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "biscuit",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.8,
            "max": 2,
            "typical": 1.2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sweet",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.1,
            "max": 1,
            "typical": 0.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "chocolate",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.6,
            "max": 3,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "pen",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.5,
            "max": 2,
            "typical": 1,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "pencil",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.2,
            "max": 1,
            "typical": 0.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "ruler",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.8,
            "max": 2.5,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "notebook",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 1,
            "max": 4,
            "typical": 2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "eraser",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.3,
            "max": 1.5,
            "typical": 0.75,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "book",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 3,
            "max": 15,
            "typical": 8,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "comic",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2,
            "max": 5,
            "typical": 3,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "magazine",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2.5,
            "max": 6,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "toy",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 5,
            "max": 25,
            "typical": 12,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "game",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 8,
            "max": 60,
            "typical": 25,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "puzzle",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 5,
            "max": 20,
            "typical": 12,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sticker",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 0.2,
            "max": 2,
            "typical": 0.8,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "badge",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 0.5,
            "max": 3,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "poster",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2,
            "max": 8,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "card",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 0.5,
            "max": 4,
            "typical": 2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        }
      ],
      "culturalElements": [
        {
          "type": "currency",
          "value": "£",
          "explanation": "British pounds"
        },
        {
          "type": "location",
          "value": "UK local shop",
          "explanation": "Typical British corner shop"
        }
      ],
      "realWorldConnection": "Everyday shopping with realistic UK prices",
      "yearAppropriate": [
        1,
        2,
        3,
        4,
        5,
        6
      ],
      "templates": [
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "MULTI_STEP"
          ],
          "modelCompatibility": [
            "ADDITION"
          ],
          "operandCount": 3,
          "template": "{character} buys {article1} {item1} for {price1}, {article2} {item2} for {price2}, and {article3} {item3} for {price3}. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item1",
              "type": "item"
            },
            {
              "key": "item2",
              "type": "item"
            },
            {
              "key": "item3",
              "type": "item"
            },
            {
              "key": "price1",
              "type": "value"
            },
            {
              "key": "price2",
              "type": "value"
            },
            {
              "key": "price3",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "MULTI_STEP"
          ],
          "modelCompatibility": [
            "ADDITION"
          ],
          "operandCount": 2,
          "template": "{character} buys {article1} {item1} for {price1} and {article2} {item2} for {price2}. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item1",
              "type": "item"
            },
            {
              "key": "item2",
              "type": "item"
            },
            {
              "key": "price1",
              "type": "value"
            },
            {
              "key": "price2",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "SUBTRACTION",
            "CHANGE_CALCULATION"
          ],
          "template": "{character} buys {article} {item} for {price} and pays with {payment}. How much change does {character} get?",
          "answerTemplate": "{character} receives {result} in change",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "payment",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "MULTIPLICATION"
          ],
          "template": "{character} buys {quantity} {item} at {price} each. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "quantity",
              "type": "value"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "DIVISION"
          ],
          "template": "{character} has {total} to spend equally on {quantity} {item}. How much can {character} spend on each one?",
          "answerTemplate": "{character} can spend {result} on each {item}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "total",
              "type": "value"
            },
            {
              "key": "quantity",
              "type": "value"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "COMPARISON",
            "ESTIMATION",
            "MULTI_STEP"
          ],
          "template": "{character} goes to the shop and buys {items}. How much does {character} spend in total?",
          "answerTemplate": "{character} spends {result} in total",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "ESTIMATION"
          ],
          "template": "Estimate: If {character} buys {items}, about how much will it cost?",
          "answerTemplate": "It will cost approximately {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "VALIDATION"
          ],
          "template": "{character} calculated that {items} costs {amount}. Is this correct?",
          "answerTemplate": "{validation_result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "amount",
              "type": "value"
            },
            {
              "key": "validation_result",
              "type": "boolean"
            }
          ]
        }
      ]
    },
    "distractors": [
      {
        "value": -0.48,
        "displayText": "-0.48",
        "strategy": "COMMON_MISCONCEPTION",
        "reasoning": "Counting error"
      },
      {
        "value": 12,
        "displayText": "12",
        "strategy": "WRONG_OPERATION",
        "reasoning": "Added instead of multiplying"
      },
      {
        "value": 8,
        "displayText": "8",
        "strategy": "WRONG_OPERATION",
        "reasoning": "Subtracted instead of multiplying"
      }
    ],
    "enhancementStatus": {
      "level": "partial",
      "requestedFormat": "DIRECT_CALCULATION",
      "actualFormat": "DIRECT_CALCULATION",
      "featuresActive": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "featuresPending": [],
      "isFullyEnhanced": true
    },
    "mathOutput": {
      "operation": "MULTIPLICATION",
      "multiplier": 2,
      "multiplicand": 0.26,
      "result": 0.52
    },
    "generationTime": 1,
    "questionId": "q_1759232462576_jib301kc9",
    "generationSetup": {
      "controller_used": "DIRECT_CALCULATIONController",
      "format_requested": "DIRECT_CALCULATION",
      "format_actual": "DIRECT_CALCULATION",
      "scenario_theme": "SHOPPING",
      "scenario_id": "shop-002-realistic-general",
      "scenario_selection_method": "default",
      "distractor_strategies": [
        "COMMON_MISCONCEPTION",
        "WRONG_OPERATION",
        "WRONG_OPERATION"
      ],
      "distractor_count": 3,
      "theme_variety": false,
      "format_variety": false,
      "enhancement_level": "partial",
      "features_active": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "features_pending": [],
      "generation_time_ms": 1
    }
  },
  "metadata": {
    "format": "DIRECT_CALCULATION",
    "cognitive_load": 35,
    "curriculum_alignment": [
      "2N1a"
    ],
    "difficulty": "2.4",
    "scenario_theme": "SHOPPING",
    "distractor_strategies": [
      "COMMON_MISCONCEPTION",
      "WRONG_OPERATION",
      "WRONG_OPERATION"
    ],
    "generation_time_ms": 1,
    "api_version": "2.0",
    "enhancement_status": "partial",
    "format_requested": "DIRECT_CALCULATION",
    "format_used": "DIRECT_CALCULATION",
    "features_active": [
      "enhanced_distractors",
      "rich_scenarios",
      "cognitive_load",
      "advanced_formats"
    ],
    "features_pending": []
  },
  "context": {
    "id": "shop-002-realistic-general",
    "theme": "SHOPPING",
    "setting": {
      "location": "local shop",
      "timeContext": "after school",
      "atmosphere": "friendly"
    },
    "characters": [
      {
        "name": "Logan",
        "role": "student"
      }
    ],
    "items": [
      {
        "name": "apple",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.2,
          "max": 0.5,
          "typical": 0.35,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "banana",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.15,
          "max": 0.4,
          "typical": 0.25,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sandwich",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 2.5,
          "max": 6,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "drink",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.8,
          "max": 2.5,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "cake",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 1.5,
          "max": 4,
          "typical": 2.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "biscuit",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.8,
          "max": 2,
          "typical": 1.2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sweet",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.1,
          "max": 1,
          "typical": 0.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "chocolate",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.6,
          "max": 3,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "pen",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.5,
          "max": 2,
          "typical": 1,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "pencil",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.2,
          "max": 1,
          "typical": 0.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "ruler",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.8,
          "max": 2.5,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "notebook",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 1,
          "max": 4,
          "typical": 2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "eraser",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.3,
          "max": 1.5,
          "typical": 0.75,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "book",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 3,
          "max": 15,
          "typical": 8,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "comic",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2,
          "max": 5,
          "typical": 3,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "magazine",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2.5,
          "max": 6,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "toy",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 5,
          "max": 25,
          "typical": 12,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "game",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 8,
          "max": 60,
          "typical": 25,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "puzzle",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 5,
          "max": 20,
          "typical": 12,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sticker",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 0.2,
          "max": 2,
          "typical": 0.8,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "badge",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 0.5,
          "max": 3,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "poster",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2,
          "max": 8,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "card",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 0.5,
          "max": 4,
          "typical": 2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      }
    ],
    "culturalElements": [
      {
        "type": "currency",
        "value": "£",
        "explanation": "British pounds"
      },
      {
        "type": "location",
        "value": "UK local shop",
        "explanation": "Typical British corner shop"
      }
    ],
    "realWorldConnection": "Everyday shopping with realistic UK prices",
    "yearAppropriate": [
      1,
      2,
      3,
      4,
      5,
      6
    ],
    "templates": [
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "MULTI_STEP"
        ],
        "modelCompatibility": [
          "ADDITION"
        ],
        "operandCount": 3,
        "template": "{character} buys {article1} {item1} for {price1}, {article2} {item2} for {price2}, and {article3} {item3} for {price3}. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item1",
            "type": "item"
          },
          {
            "key": "item2",
            "type": "item"
          },
          {
            "key": "item3",
            "type": "item"
          },
          {
            "key": "price1",
            "type": "value"
          },
          {
            "key": "price2",
            "type": "value"
          },
          {
            "key": "price3",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "MULTI_STEP"
        ],
        "modelCompatibility": [
          "ADDITION"
        ],
        "operandCount": 2,
        "template": "{character} buys {article1} {item1} for {price1} and {article2} {item2} for {price2}. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item1",
            "type": "item"
          },
          {
            "key": "item2",
            "type": "item"
          },
          {
            "key": "price1",
            "type": "value"
          },
          {
            "key": "price2",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "SUBTRACTION",
          "CHANGE_CALCULATION"
        ],
        "template": "{character} buys {article} {item} for {price} and pays with {payment}. How much change does {character} get?",
        "answerTemplate": "{character} receives {result} in change",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "payment",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "MULTIPLICATION"
        ],
        "template": "{character} buys {quantity} {item} at {price} each. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "quantity",
            "type": "value"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "DIVISION"
        ],
        "template": "{character} has {total} to spend equally on {quantity} {item}. How much can {character} spend on each one?",
        "answerTemplate": "{character} can spend {result} on each {item}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "total",
            "type": "value"
          },
          {
            "key": "quantity",
            "type": "value"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "COMPARISON",
          "ESTIMATION",
          "MULTI_STEP"
        ],
        "template": "{character} goes to the shop and buys {items}. How much does {character} spend in total?",
        "answerTemplate": "{character} spends {result} in total",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "ESTIMATION"
        ],
        "template": "Estimate: If {character} buys {items}, about how much will it cost?",
        "answerTemplate": "It will cost approximately {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "VALIDATION"
        ],
        "template": "{character} calculated that {items} costs {amount}. Is this correct?",
        "answerTemplate": "{validation_result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "amount",
            "type": "value"
          },
          {
            "key": "validation_result",
            "type": "boolean"
          }
        ]
      }
    ]
  }
}
# Test D.3: MULTIPLICATION at difficulty 3.2
{
  "success": true,
  "question": {
    "text": "Logan is multiplying £2.00 × 7. What is a reasonable estimate?",
    "options": [
      {
        "text": "14",
        "value": 14,
        "index": 0
      },
      {
        "text": "22.5",
        "value": 22.5,
        "index": 1
      },
      {
        "text": "9",
        "value": 9,
        "index": 2
      },
      {
        "text": "£15.00",
        "value": 15,
        "index": 3
      }
    ],
    "correctIndex": 3,
    "questionContent": {
      "fullText": "Logan is multiplying £2.00 × 7. What is a reasonable estimate?",
      "templateData": {
        "character": "Logan",
        "operation": "is multiplying £2.00 × 7",
        "exactValue": "14",
        "estimatedValue": "15"
      }
    },
    "format": "ESTIMATION",
    "difficulty": {
      "year": 3,
      "subLevel": 2,
      "displayName": "3.2",
      "cognitiveLoad": 35
    },
    "cognitiveLoad": 35,
    "curriculumTags": [
      "3N1a"
    ],
    "scenario": {
      "id": "shop-002-realistic-general",
      "theme": "SHOPPING",
      "setting": {
        "location": "local shop",
        "timeContext": "after school",
        "atmosphere": "friendly"
      },
      "characters": [
        {
          "name": "Logan",
          "role": "student"
        }
      ],
      "items": [
        {
          "name": "apple",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.2,
            "max": 0.5,
            "typical": 0.35,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "banana",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.15,
            "max": 0.4,
            "typical": 0.25,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sandwich",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 2.5,
            "max": 6,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "drink",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.8,
            "max": 2.5,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "cake",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 1.5,
            "max": 4,
            "typical": 2.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "biscuit",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.8,
            "max": 2,
            "typical": 1.2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sweet",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.1,
            "max": 1,
            "typical": 0.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "chocolate",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.6,
            "max": 3,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "pen",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.5,
            "max": 2,
            "typical": 1,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "pencil",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.2,
            "max": 1,
            "typical": 0.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "ruler",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.8,
            "max": 2.5,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "notebook",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 1,
            "max": 4,
            "typical": 2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "eraser",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.3,
            "max": 1.5,
            "typical": 0.75,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "book",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 3,
            "max": 15,
            "typical": 8,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "comic",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2,
            "max": 5,
            "typical": 3,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "magazine",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2.5,
            "max": 6,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "toy",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 5,
            "max": 25,
            "typical": 12,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "game",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 8,
            "max": 60,
            "typical": 25,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "puzzle",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 5,
            "max": 20,
            "typical": 12,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sticker",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 0.2,
            "max": 2,
            "typical": 0.8,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "badge",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 0.5,
            "max": 3,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "poster",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2,
            "max": 8,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "card",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 0.5,
            "max": 4,
            "typical": 2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        }
      ],
      "culturalElements": [
        {
          "type": "currency",
          "value": "£",
          "explanation": "British pounds"
        },
        {
          "type": "location",
          "value": "UK local shop",
          "explanation": "Typical British corner shop"
        }
      ],
      "realWorldConnection": "Everyday shopping with realistic UK prices",
      "yearAppropriate": [
        1,
        2,
        3,
        4,
        5,
        6
      ],
      "templates": [
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "MULTI_STEP"
          ],
          "modelCompatibility": [
            "ADDITION"
          ],
          "operandCount": 3,
          "template": "{character} buys {article1} {item1} for {price1}, {article2} {item2} for {price2}, and {article3} {item3} for {price3}. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item1",
              "type": "item"
            },
            {
              "key": "item2",
              "type": "item"
            },
            {
              "key": "item3",
              "type": "item"
            },
            {
              "key": "price1",
              "type": "value"
            },
            {
              "key": "price2",
              "type": "value"
            },
            {
              "key": "price3",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "MULTI_STEP"
          ],
          "modelCompatibility": [
            "ADDITION"
          ],
          "operandCount": 2,
          "template": "{character} buys {article1} {item1} for {price1} and {article2} {item2} for {price2}. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item1",
              "type": "item"
            },
            {
              "key": "item2",
              "type": "item"
            },
            {
              "key": "price1",
              "type": "value"
            },
            {
              "key": "price2",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "SUBTRACTION",
            "CHANGE_CALCULATION"
          ],
          "template": "{character} buys {article} {item} for {price} and pays with {payment}. How much change does {character} get?",
          "answerTemplate": "{character} receives {result} in change",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "payment",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "MULTIPLICATION"
          ],
          "template": "{character} buys {quantity} {item} at {price} each. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "quantity",
              "type": "value"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "DIVISION"
          ],
          "template": "{character} has {total} to spend equally on {quantity} {item}. How much can {character} spend on each one?",
          "answerTemplate": "{character} can spend {result} on each {item}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "total",
              "type": "value"
            },
            {
              "key": "quantity",
              "type": "value"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "COMPARISON",
            "ESTIMATION",
            "MULTI_STEP"
          ],
          "template": "{character} goes to the shop and buys {items}. How much does {character} spend in total?",
          "answerTemplate": "{character} spends {result} in total",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "ESTIMATION"
          ],
          "template": "Estimate: If {character} buys {items}, about how much will it cost?",
          "answerTemplate": "It will cost approximately {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "VALIDATION"
          ],
          "template": "{character} calculated that {items} costs {amount}. Is this correct?",
          "answerTemplate": "{validation_result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "amount",
              "type": "value"
            },
            {
              "key": "validation_result",
              "type": "boolean"
            }
          ]
        }
      ]
    },
    "distractors": [
      {
        "value": 14,
        "strategy": "WRONG_OPERATION",
        "rationale": "Used exact calculation instead of estimation"
      },
      {
        "value": 22.5,
        "rationale": "Overestimated significantly"
      },
      {
        "value": 9,
        "rationale": "Underestimated significantly"
      }
    ],
    "enhancementStatus": {
      "level": "full",
      "requestedFormat": "ESTIMATION",
      "actualFormat": "ESTIMATION",
      "featuresActive": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "featuresPending": [],
      "isFullyEnhanced": true
    },
    "mathOutput": {
      "operation": "MULTIPLICATION",
      "multiplicand": 2,
      "multiplier": 7,
      "result": 14,
      "factors": [
        2,
        7
      ],
      "decimal_formatted": {
        "operands": [
          "2",
          "7"
        ],
        "result": "14"
      },
      "exactValue": 14,
      "estimatedValue": 15
    },
    "generationTime": 1,
    "questionId": "q_1759232462618_h1siyiwz9",
    "generationSetup": {
      "controller_used": "ESTIMATIONController",
      "format_requested": "ESTIMATION",
      "format_actual": "ESTIMATION",
      "scenario_theme": "SHOPPING",
      "scenario_id": "shop-002-realistic-general",
      "scenario_selection_method": "default",
      "distractor_strategies": [
        "WRONG_OPERATION",
        null,
        null
      ],
      "distractor_count": 3,
      "theme_variety": false,
      "format_variety": false,
      "enhancement_level": "full",
      "features_active": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "features_pending": [],
      "generation_time_ms": 1
    }
  },
  "metadata": {
    "format": "ESTIMATION",
    "cognitive_load": 35,
    "curriculum_alignment": [
      "3N1a"
    ],
    "difficulty": "3.2",
    "scenario_theme": "SHOPPING",
    "distractor_strategies": [
      "WRONG_OPERATION",
      null,
      null
    ],
    "generation_time_ms": 1,
    "api_version": "2.0",
    "enhancement_status": "full",
    "format_requested": "ESTIMATION",
    "format_used": "ESTIMATION",
    "features_active": [
      "enhanced_distractors",
      "rich_scenarios",
      "cognitive_load",
      "advanced_formats"
    ],
    "features_pending": []
  },
  "context": {
    "id": "shop-002-realistic-general",
    "theme": "SHOPPING",
    "setting": {
      "location": "local shop",
      "timeContext": "after school",
      "atmosphere": "friendly"
    },
    "characters": [
      {
        "name": "Logan",
        "role": "student"
      }
    ],
    "items": [
      {
        "name": "apple",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.2,
          "max": 0.5,
          "typical": 0.35,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "banana",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.15,
          "max": 0.4,
          "typical": 0.25,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sandwich",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 2.5,
          "max": 6,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "drink",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.8,
          "max": 2.5,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "cake",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 1.5,
          "max": 4,
          "typical": 2.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "biscuit",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.8,
          "max": 2,
          "typical": 1.2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sweet",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.1,
          "max": 1,
          "typical": 0.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "chocolate",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.6,
          "max": 3,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "pen",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.5,
          "max": 2,
          "typical": 1,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "pencil",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.2,
          "max": 1,
          "typical": 0.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "ruler",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.8,
          "max": 2.5,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "notebook",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 1,
          "max": 4,
          "typical": 2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "eraser",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.3,
          "max": 1.5,
          "typical": 0.75,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "book",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 3,
          "max": 15,
          "typical": 8,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "comic",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2,
          "max": 5,
          "typical": 3,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "magazine",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2.5,
          "max": 6,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "toy",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 5,
          "max": 25,
          "typical": 12,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "game",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 8,
          "max": 60,
          "typical": 25,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "puzzle",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 5,
          "max": 20,
          "typical": 12,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sticker",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 0.2,
          "max": 2,
          "typical": 0.8,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "badge",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 0.5,
          "max": 3,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "poster",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2,
          "max": 8,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "card",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 0.5,
          "max": 4,
          "typical": 2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      }
    ],
    "culturalElements": [
      {
        "type": "currency",
        "value": "£",
        "explanation": "British pounds"
      },
      {
        "type": "location",
        "value": "UK local shop",
        "explanation": "Typical British corner shop"
      }
    ],
    "realWorldConnection": "Everyday shopping with realistic UK prices",
    "yearAppropriate": [
      1,
      2,
      3,
      4,
      5,
      6
    ],
    "templates": [
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "MULTI_STEP"
        ],
        "modelCompatibility": [
          "ADDITION"
        ],
        "operandCount": 3,
        "template": "{character} buys {article1} {item1} for {price1}, {article2} {item2} for {price2}, and {article3} {item3} for {price3}. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item1",
            "type": "item"
          },
          {
            "key": "item2",
            "type": "item"
          },
          {
            "key": "item3",
            "type": "item"
          },
          {
            "key": "price1",
            "type": "value"
          },
          {
            "key": "price2",
            "type": "value"
          },
          {
            "key": "price3",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "MULTI_STEP"
        ],
        "modelCompatibility": [
          "ADDITION"
        ],
        "operandCount": 2,
        "template": "{character} buys {article1} {item1} for {price1} and {article2} {item2} for {price2}. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item1",
            "type": "item"
          },
          {
            "key": "item2",
            "type": "item"
          },
          {
            "key": "price1",
            "type": "value"
          },
          {
            "key": "price2",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "SUBTRACTION",
          "CHANGE_CALCULATION"
        ],
        "template": "{character} buys {article} {item} for {price} and pays with {payment}. How much change does {character} get?",
        "answerTemplate": "{character} receives {result} in change",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "payment",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "MULTIPLICATION"
        ],
        "template": "{character} buys {quantity} {item} at {price} each. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "quantity",
            "type": "value"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "DIVISION"
        ],
        "template": "{character} has {total} to spend equally on {quantity} {item}. How much can {character} spend on each one?",
        "answerTemplate": "{character} can spend {result} on each {item}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "total",
            "type": "value"
          },
          {
            "key": "quantity",
            "type": "value"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "COMPARISON",
          "ESTIMATION",
          "MULTI_STEP"
        ],
        "template": "{character} goes to the shop and buys {items}. How much does {character} spend in total?",
        "answerTemplate": "{character} spends {result} in total",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "ESTIMATION"
        ],
        "template": "Estimate: If {character} buys {items}, about how much will it cost?",
        "answerTemplate": "It will cost approximately {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "VALIDATION"
        ],
        "template": "{character} calculated that {items} costs {amount}. Is this correct?",
        "answerTemplate": "{validation_result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "amount",
            "type": "value"
          },
          {
            "key": "validation_result",
            "type": "boolean"
          }
        ]
      }
    ]
  }
}
# Test D.4: MULTIPLICATION at difficulty 4.1
{
  "success": true,
  "question": {
    "text": "Logan buys 9 apple at 27p each. What is the total cost?",
    "options": [
      {
        "text": "£2.43",
        "value": 2.43,
        "index": 0
      },
      {
        "text": "3.43",
        "value": 3.43,
        "index": 1
      },
      {
        "text": "32",
        "value": 32,
        "index": 2
      },
      {
        "text": "14",
        "value": 14,
        "index": 3
      }
    ],
    "correctIndex": 0,
    "format": "DIRECT_CALCULATION",
    "difficulty": {
      "year": 4,
      "subLevel": 1,
      "displayName": "4.1",
      "cognitiveLoad": 40
    },
    "cognitiveLoad": 40,
    "curriculumTags": [
      "4N1a"
    ],
    "scenario": {
      "id": "shop-002-realistic-general",
      "theme": "SHOPPING",
      "setting": {
        "location": "local shop",
        "timeContext": "after school",
        "atmosphere": "friendly"
      },
      "characters": [
        {
          "name": "Logan",
          "role": "student"
        }
      ],
      "items": [
        {
          "name": "apple",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.2,
            "max": 0.5,
            "typical": 0.35,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "banana",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.15,
            "max": 0.4,
            "typical": 0.25,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sandwich",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 2.5,
            "max": 6,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "drink",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.8,
            "max": 2.5,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "cake",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 1.5,
            "max": 4,
            "typical": 2.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "biscuit",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.8,
            "max": 2,
            "typical": 1.2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sweet",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.1,
            "max": 1,
            "typical": 0.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "chocolate",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.6,
            "max": 3,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "pen",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.5,
            "max": 2,
            "typical": 1,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "pencil",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.2,
            "max": 1,
            "typical": 0.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "ruler",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.8,
            "max": 2.5,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "notebook",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 1,
            "max": 4,
            "typical": 2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "eraser",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.3,
            "max": 1.5,
            "typical": 0.75,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "book",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 3,
            "max": 15,
            "typical": 8,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "comic",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2,
            "max": 5,
            "typical": 3,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "magazine",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2.5,
            "max": 6,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "toy",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 5,
            "max": 25,
            "typical": 12,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "game",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 8,
            "max": 60,
            "typical": 25,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "puzzle",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 5,
            "max": 20,
            "typical": 12,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sticker",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 0.2,
            "max": 2,
            "typical": 0.8,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "badge",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 0.5,
            "max": 3,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "poster",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2,
            "max": 8,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "card",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 0.5,
            "max": 4,
            "typical": 2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        }
      ],
      "culturalElements": [
        {
          "type": "currency",
          "value": "£",
          "explanation": "British pounds"
        },
        {
          "type": "location",
          "value": "UK local shop",
          "explanation": "Typical British corner shop"
        }
      ],
      "realWorldConnection": "Everyday shopping with realistic UK prices",
      "yearAppropriate": [
        1,
        2,
        3,
        4,
        5,
        6
      ],
      "templates": [
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "MULTI_STEP"
          ],
          "modelCompatibility": [
            "ADDITION"
          ],
          "operandCount": 3,
          "template": "{character} buys {article1} {item1} for {price1}, {article2} {item2} for {price2}, and {article3} {item3} for {price3}. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item1",
              "type": "item"
            },
            {
              "key": "item2",
              "type": "item"
            },
            {
              "key": "item3",
              "type": "item"
            },
            {
              "key": "price1",
              "type": "value"
            },
            {
              "key": "price2",
              "type": "value"
            },
            {
              "key": "price3",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "MULTI_STEP"
          ],
          "modelCompatibility": [
            "ADDITION"
          ],
          "operandCount": 2,
          "template": "{character} buys {article1} {item1} for {price1} and {article2} {item2} for {price2}. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item1",
              "type": "item"
            },
            {
              "key": "item2",
              "type": "item"
            },
            {
              "key": "price1",
              "type": "value"
            },
            {
              "key": "price2",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "SUBTRACTION",
            "CHANGE_CALCULATION"
          ],
          "template": "{character} buys {article} {item} for {price} and pays with {payment}. How much change does {character} get?",
          "answerTemplate": "{character} receives {result} in change",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "payment",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "MULTIPLICATION"
          ],
          "template": "{character} buys {quantity} {item} at {price} each. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "quantity",
              "type": "value"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "DIVISION"
          ],
          "template": "{character} has {total} to spend equally on {quantity} {item}. How much can {character} spend on each one?",
          "answerTemplate": "{character} can spend {result} on each {item}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "total",
              "type": "value"
            },
            {
              "key": "quantity",
              "type": "value"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "COMPARISON",
            "ESTIMATION",
            "MULTI_STEP"
          ],
          "template": "{character} goes to the shop and buys {items}. How much does {character} spend in total?",
          "answerTemplate": "{character} spends {result} in total",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "ESTIMATION"
          ],
          "template": "Estimate: If {character} buys {items}, about how much will it cost?",
          "answerTemplate": "It will cost approximately {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "VALIDATION"
          ],
          "template": "{character} calculated that {items} costs {amount}. Is this correct?",
          "answerTemplate": "{validation_result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "amount",
              "type": "value"
            },
            {
              "key": "validation_result",
              "type": "boolean"
            }
          ]
        }
      ]
    },
    "distractors": [
      {
        "value": 32,
        "displayText": "32",
        "strategy": "WRONG_OPERATION",
        "reasoning": "Added instead of multiplying"
      },
      {
        "value": 14,
        "displayText": "14",
        "strategy": "WRONG_OPERATION",
        "reasoning": "Subtracted instead of multiplying"
      },
      {
        "value": 3.43,
        "displayText": "3.43",
        "strategy": "CLOSE_VALUE",
        "reasoning": "Off by 1"
      }
    ],
    "enhancementStatus": {
      "level": "partial",
      "requestedFormat": "DIRECT_CALCULATION",
      "actualFormat": "DIRECT_CALCULATION",
      "featuresActive": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "featuresPending": [],
      "isFullyEnhanced": true
    },
    "mathOutput": {
      "operation": "MULTIPLICATION",
      "multiplier": 9,
      "multiplicand": 0.27,
      "result": 2.43
    },
    "generationTime": 1,
    "questionId": "q_1759232462664_gs9bpltpa",
    "generationSetup": {
      "controller_used": "DIRECT_CALCULATIONController",
      "format_requested": "DIRECT_CALCULATION",
      "format_actual": "DIRECT_CALCULATION",
      "scenario_theme": "SHOPPING",
      "scenario_id": "shop-002-realistic-general",
      "scenario_selection_method": "default",
      "distractor_strategies": [
        "WRONG_OPERATION",
        "WRONG_OPERATION",
        "CLOSE_VALUE"
      ],
      "distractor_count": 3,
      "theme_variety": false,
      "format_variety": false,
      "enhancement_level": "partial",
      "features_active": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "features_pending": [],
      "generation_time_ms": 1
    }
  },
  "metadata": {
    "format": "DIRECT_CALCULATION",
    "cognitive_load": 40,
    "curriculum_alignment": [
      "4N1a"
    ],
    "difficulty": "4.1",
    "scenario_theme": "SHOPPING",
    "distractor_strategies": [
      "WRONG_OPERATION",
      "WRONG_OPERATION",
      "CLOSE_VALUE"
    ],
    "generation_time_ms": 1,
    "api_version": "2.0",
    "enhancement_status": "partial",
    "format_requested": "DIRECT_CALCULATION",
    "format_used": "DIRECT_CALCULATION",
    "features_active": [
      "enhanced_distractors",
      "rich_scenarios",
      "cognitive_load",
      "advanced_formats"
    ],
    "features_pending": []
  },
  "context": {
    "id": "shop-002-realistic-general",
    "theme": "SHOPPING",
    "setting": {
      "location": "local shop",
      "timeContext": "after school",
      "atmosphere": "friendly"
    },
    "characters": [
      {
        "name": "Logan",
        "role": "student"
      }
    ],
    "items": [
      {
        "name": "apple",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.2,
          "max": 0.5,
          "typical": 0.35,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "banana",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.15,
          "max": 0.4,
          "typical": 0.25,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sandwich",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 2.5,
          "max": 6,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "drink",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.8,
          "max": 2.5,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "cake",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 1.5,
          "max": 4,
          "typical": 2.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "biscuit",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.8,
          "max": 2,
          "typical": 1.2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sweet",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.1,
          "max": 1,
          "typical": 0.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "chocolate",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.6,
          "max": 3,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "pen",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.5,
          "max": 2,
          "typical": 1,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "pencil",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.2,
          "max": 1,
          "typical": 0.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "ruler",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.8,
          "max": 2.5,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "notebook",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 1,
          "max": 4,
          "typical": 2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "eraser",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.3,
          "max": 1.5,
          "typical": 0.75,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "book",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 3,
          "max": 15,
          "typical": 8,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "comic",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2,
          "max": 5,
          "typical": 3,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "magazine",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2.5,
          "max": 6,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "toy",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 5,
          "max": 25,
          "typical": 12,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "game",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 8,
          "max": 60,
          "typical": 25,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "puzzle",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 5,
          "max": 20,
          "typical": 12,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sticker",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 0.2,
          "max": 2,
          "typical": 0.8,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "badge",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 0.5,
          "max": 3,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "poster",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2,
          "max": 8,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "card",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 0.5,
          "max": 4,
          "typical": 2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      }
    ],
    "culturalElements": [
      {
        "type": "currency",
        "value": "£",
        "explanation": "British pounds"
      },
      {
        "type": "location",
        "value": "UK local shop",
        "explanation": "Typical British corner shop"
      }
    ],
    "realWorldConnection": "Everyday shopping with realistic UK prices",
    "yearAppropriate": [
      1,
      2,
      3,
      4,
      5,
      6
    ],
    "templates": [
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "MULTI_STEP"
        ],
        "modelCompatibility": [
          "ADDITION"
        ],
        "operandCount": 3,
        "template": "{character} buys {article1} {item1} for {price1}, {article2} {item2} for {price2}, and {article3} {item3} for {price3}. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item1",
            "type": "item"
          },
          {
            "key": "item2",
            "type": "item"
          },
          {
            "key": "item3",
            "type": "item"
          },
          {
            "key": "price1",
            "type": "value"
          },
          {
            "key": "price2",
            "type": "value"
          },
          {
            "key": "price3",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "MULTI_STEP"
        ],
        "modelCompatibility": [
          "ADDITION"
        ],
        "operandCount": 2,
        "template": "{character} buys {article1} {item1} for {price1} and {article2} {item2} for {price2}. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item1",
            "type": "item"
          },
          {
            "key": "item2",
            "type": "item"
          },
          {
            "key": "price1",
            "type": "value"
          },
          {
            "key": "price2",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "SUBTRACTION",
          "CHANGE_CALCULATION"
        ],
        "template": "{character} buys {article} {item} for {price} and pays with {payment}. How much change does {character} get?",
        "answerTemplate": "{character} receives {result} in change",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "payment",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "MULTIPLICATION"
        ],
        "template": "{character} buys {quantity} {item} at {price} each. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "quantity",
            "type": "value"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "DIVISION"
        ],
        "template": "{character} has {total} to spend equally on {quantity} {item}. How much can {character} spend on each one?",
        "answerTemplate": "{character} can spend {result} on each {item}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "total",
            "type": "value"
          },
          {
            "key": "quantity",
            "type": "value"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "COMPARISON",
          "ESTIMATION",
          "MULTI_STEP"
        ],
        "template": "{character} goes to the shop and buys {items}. How much does {character} spend in total?",
        "answerTemplate": "{character} spends {result} in total",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "ESTIMATION"
        ],
        "template": "Estimate: If {character} buys {items}, about how much will it cost?",
        "answerTemplate": "It will cost approximately {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "VALIDATION"
        ],
        "template": "{character} calculated that {items} costs {amount}. Is this correct?",
        "answerTemplate": "{validation_result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "amount",
            "type": "value"
          },
          {
            "key": "validation_result",
            "type": "boolean"
          }
        ]
      }
    ]
  }
}
# Test D.5: MULTIPLICATION at difficulty 5.3
{
  "success": true,
  "question": {
    "text": "Logan is multiplying £99.00 × 45. Round the result to the nearest hundreds.",
    "options": [
      {
        "text": "4460",
        "value": 4460,
        "index": 0
      },
      {
        "text": "4400",
        "value": 4400,
        "index": 1
      },
      {
        "text": "4500",
        "value": 4500,
        "index": 2
      },
      {
        "text": "£4500.00",
        "value": 4500,
        "index": 3
      }
    ],
    "correctIndex": 2,
    "questionContent": {
      "fullText": "Logan is multiplying £99.00 × 45. Round the result to the nearest hundreds.",
      "templateData": {
        "character": "Logan",
        "operation": "is multiplying £99.00 × 45",
        "roundingPlace": "hundreds",
        "exactValue": "4455",
        "roundedValue": "4500"
      }
    },
    "format": "ESTIMATION",
    "difficulty": {
      "year": 5,
      "subLevel": 3,
      "displayName": "5.3",
      "cognitiveLoad": 60
    },
    "cognitiveLoad": 60,
    "curriculumTags": [
      "5N1a"
    ],
    "scenario": {
      "id": "shop-002-realistic-general",
      "theme": "SHOPPING",
      "setting": {
        "location": "local shop",
        "timeContext": "after school",
        "atmosphere": "friendly"
      },
      "characters": [
        {
          "name": "Logan",
          "role": "student"
        }
      ],
      "items": [
        {
          "name": "apple",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.2,
            "max": 0.5,
            "typical": 0.35,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "banana",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.15,
            "max": 0.4,
            "typical": 0.25,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sandwich",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 2.5,
            "max": 6,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "drink",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.8,
            "max": 2.5,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "cake",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 1.5,
            "max": 4,
            "typical": 2.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "biscuit",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.8,
            "max": 2,
            "typical": 1.2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sweet",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.1,
            "max": 1,
            "typical": 0.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "chocolate",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.6,
            "max": 3,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "pen",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.5,
            "max": 2,
            "typical": 1,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "pencil",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.2,
            "max": 1,
            "typical": 0.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "ruler",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.8,
            "max": 2.5,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "notebook",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 1,
            "max": 4,
            "typical": 2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "eraser",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.3,
            "max": 1.5,
            "typical": 0.75,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "book",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 3,
            "max": 15,
            "typical": 8,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "comic",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2,
            "max": 5,
            "typical": 3,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "magazine",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2.5,
            "max": 6,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "toy",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 5,
            "max": 25,
            "typical": 12,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "game",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 8,
            "max": 60,
            "typical": 25,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "puzzle",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 5,
            "max": 20,
            "typical": 12,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sticker",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 0.2,
            "max": 2,
            "typical": 0.8,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "badge",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 0.5,
            "max": 3,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "poster",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2,
            "max": 8,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "card",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 0.5,
            "max": 4,
            "typical": 2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        }
      ],
      "culturalElements": [
        {
          "type": "currency",
          "value": "£",
          "explanation": "British pounds"
        },
        {
          "type": "location",
          "value": "UK local shop",
          "explanation": "Typical British corner shop"
        }
      ],
      "realWorldConnection": "Everyday shopping with realistic UK prices",
      "yearAppropriate": [
        1,
        2,
        3,
        4,
        5,
        6
      ],
      "templates": [
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "MULTI_STEP"
          ],
          "modelCompatibility": [
            "ADDITION"
          ],
          "operandCount": 3,
          "template": "{character} buys {article1} {item1} for {price1}, {article2} {item2} for {price2}, and {article3} {item3} for {price3}. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item1",
              "type": "item"
            },
            {
              "key": "item2",
              "type": "item"
            },
            {
              "key": "item3",
              "type": "item"
            },
            {
              "key": "price1",
              "type": "value"
            },
            {
              "key": "price2",
              "type": "value"
            },
            {
              "key": "price3",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "MULTI_STEP"
          ],
          "modelCompatibility": [
            "ADDITION"
          ],
          "operandCount": 2,
          "template": "{character} buys {article1} {item1} for {price1} and {article2} {item2} for {price2}. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item1",
              "type": "item"
            },
            {
              "key": "item2",
              "type": "item"
            },
            {
              "key": "price1",
              "type": "value"
            },
            {
              "key": "price2",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "SUBTRACTION",
            "CHANGE_CALCULATION"
          ],
          "template": "{character} buys {article} {item} for {price} and pays with {payment}. How much change does {character} get?",
          "answerTemplate": "{character} receives {result} in change",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "payment",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "MULTIPLICATION"
          ],
          "template": "{character} buys {quantity} {item} at {price} each. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "quantity",
              "type": "value"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "DIVISION"
          ],
          "template": "{character} has {total} to spend equally on {quantity} {item}. How much can {character} spend on each one?",
          "answerTemplate": "{character} can spend {result} on each {item}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "total",
              "type": "value"
            },
            {
              "key": "quantity",
              "type": "value"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "COMPARISON",
            "ESTIMATION",
            "MULTI_STEP"
          ],
          "template": "{character} goes to the shop and buys {items}. How much does {character} spend in total?",
          "answerTemplate": "{character} spends {result} in total",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "ESTIMATION"
          ],
          "template": "Estimate: If {character} buys {items}, about how much will it cost?",
          "answerTemplate": "It will cost approximately {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "VALIDATION"
          ],
          "template": "{character} calculated that {items} costs {amount}. Is this correct?",
          "answerTemplate": "{validation_result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "amount",
              "type": "value"
            },
            {
              "key": "validation_result",
              "type": "boolean"
            }
          ]
        }
      ]
    },
    "distractors": [
      {
        "value": 4460,
        "strategy": "WRONG_OPERATION",
        "rationale": "Rounded to wrong place value"
      },
      {
        "value": 4400,
        "rationale": "Truncated instead of rounded"
      },
      {
        "value": 4500,
        "rationale": "Always rounded up"
      }
    ],
    "enhancementStatus": {
      "level": "full",
      "requestedFormat": "ESTIMATION",
      "actualFormat": "ESTIMATION",
      "featuresActive": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "featuresPending": [],
      "isFullyEnhanced": true
    },
    "mathOutput": {
      "operation": "MULTIPLICATION",
      "multiplicand": 99,
      "multiplier": 45,
      "result": 4455,
      "factors": [
        99,
        45
      ],
      "decimal_formatted": {
        "operands": [
          "99",
          "45"
        ],
        "result": "4455"
      },
      "exactValue": 4455,
      "roundedValue": 4500
    },
    "generationTime": 0,
    "questionId": "q_1759232462708_oolcvi85l",
    "generationSetup": {
      "controller_used": "ESTIMATIONController",
      "format_requested": "ESTIMATION",
      "format_actual": "ESTIMATION",
      "scenario_theme": "SHOPPING",
      "scenario_id": "shop-002-realistic-general",
      "scenario_selection_method": "default",
      "distractor_strategies": [
        "WRONG_OPERATION",
        null,
        null
      ],
      "distractor_count": 3,
      "theme_variety": false,
      "format_variety": false,
      "enhancement_level": "full",
      "features_active": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "features_pending": [],
      "generation_time_ms": 0
    }
  },
  "metadata": {
    "format": "ESTIMATION",
    "cognitive_load": 60,
    "curriculum_alignment": [
      "5N1a"
    ],
    "difficulty": "5.3",
    "scenario_theme": "SHOPPING",
    "distractor_strategies": [
      "WRONG_OPERATION",
      null,
      null
    ],
    "generation_time_ms": 0,
    "api_version": "2.0",
    "enhancement_status": "full",
    "format_requested": "ESTIMATION",
    "format_used": "ESTIMATION",
    "features_active": [
      "enhanced_distractors",
      "rich_scenarios",
      "cognitive_load",
      "advanced_formats"
    ],
    "features_pending": []
  },
  "context": {
    "id": "shop-002-realistic-general",
    "theme": "SHOPPING",
    "setting": {
      "location": "local shop",
      "timeContext": "after school",
      "atmosphere": "friendly"
    },
    "characters": [
      {
        "name": "Logan",
        "role": "student"
      }
    ],
    "items": [
      {
        "name": "apple",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.2,
          "max": 0.5,
          "typical": 0.35,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "banana",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.15,
          "max": 0.4,
          "typical": 0.25,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sandwich",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 2.5,
          "max": 6,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "drink",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.8,
          "max": 2.5,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "cake",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 1.5,
          "max": 4,
          "typical": 2.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "biscuit",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.8,
          "max": 2,
          "typical": 1.2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sweet",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.1,
          "max": 1,
          "typical": 0.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "chocolate",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.6,
          "max": 3,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "pen",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.5,
          "max": 2,
          "typical": 1,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "pencil",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.2,
          "max": 1,
          "typical": 0.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "ruler",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.8,
          "max": 2.5,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "notebook",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 1,
          "max": 4,
          "typical": 2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "eraser",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.3,
          "max": 1.5,
          "typical": 0.75,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "book",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 3,
          "max": 15,
          "typical": 8,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "comic",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2,
          "max": 5,
          "typical": 3,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "magazine",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2.5,
          "max": 6,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "toy",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 5,
          "max": 25,
          "typical": 12,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "game",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 8,
          "max": 60,
          "typical": 25,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "puzzle",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 5,
          "max": 20,
          "typical": 12,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sticker",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 0.2,
          "max": 2,
          "typical": 0.8,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "badge",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 0.5,
          "max": 3,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "poster",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2,
          "max": 8,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "card",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 0.5,
          "max": 4,
          "typical": 2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      }
    ],
    "culturalElements": [
      {
        "type": "currency",
        "value": "£",
        "explanation": "British pounds"
      },
      {
        "type": "location",
        "value": "UK local shop",
        "explanation": "Typical British corner shop"
      }
    ],
    "realWorldConnection": "Everyday shopping with realistic UK prices",
    "yearAppropriate": [
      1,
      2,
      3,
      4,
      5,
      6
    ],
    "templates": [
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "MULTI_STEP"
        ],
        "modelCompatibility": [
          "ADDITION"
        ],
        "operandCount": 3,
        "template": "{character} buys {article1} {item1} for {price1}, {article2} {item2} for {price2}, and {article3} {item3} for {price3}. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item1",
            "type": "item"
          },
          {
            "key": "item2",
            "type": "item"
          },
          {
            "key": "item3",
            "type": "item"
          },
          {
            "key": "price1",
            "type": "value"
          },
          {
            "key": "price2",
            "type": "value"
          },
          {
            "key": "price3",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "MULTI_STEP"
        ],
        "modelCompatibility": [
          "ADDITION"
        ],
        "operandCount": 2,
        "template": "{character} buys {article1} {item1} for {price1} and {article2} {item2} for {price2}. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item1",
            "type": "item"
          },
          {
            "key": "item2",
            "type": "item"
          },
          {
            "key": "price1",
            "type": "value"
          },
          {
            "key": "price2",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "SUBTRACTION",
          "CHANGE_CALCULATION"
        ],
        "template": "{character} buys {article} {item} for {price} and pays with {payment}. How much change does {character} get?",
        "answerTemplate": "{character} receives {result} in change",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "payment",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "MULTIPLICATION"
        ],
        "template": "{character} buys {quantity} {item} at {price} each. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "quantity",
            "type": "value"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "DIVISION"
        ],
        "template": "{character} has {total} to spend equally on {quantity} {item}. How much can {character} spend on each one?",
        "answerTemplate": "{character} can spend {result} on each {item}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "total",
            "type": "value"
          },
          {
            "key": "quantity",
            "type": "value"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "COMPARISON",
          "ESTIMATION",
          "MULTI_STEP"
        ],
        "template": "{character} goes to the shop and buys {items}. How much does {character} spend in total?",
        "answerTemplate": "{character} spends {result} in total",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "ESTIMATION"
        ],
        "template": "Estimate: If {character} buys {items}, about how much will it cost?",
        "answerTemplate": "It will cost approximately {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "VALIDATION"
        ],
        "template": "{character} calculated that {items} costs {amount}. Is this correct?",
        "answerTemplate": "{validation_result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "amount",
            "type": "value"
          },
          {
            "key": "validation_result",
            "type": "boolean"
          }
        ]
      }
    ]
  }
}
# Test D.6: MULTIPLICATION at difficulty 6.4
{
  "success": true,
  "question": {
    "text": "Logan buys 144 apple at 33p each. What is the total cost?",
    "options": [
      {
        "text": "57.52",
        "value": 57.52,
        "index": 0
      },
      {
        "text": "£47.52",
        "value": 47.52,
        "index": 1
      },
      {
        "text": "1297",
        "value": 1297,
        "index": 2
      },
      {
        "text": "1585",
        "value": 1585,
        "index": 3
      }
    ],
    "correctIndex": 1,
    "format": "DIRECT_CALCULATION",
    "difficulty": {
      "year": 6,
      "subLevel": 4,
      "displayName": "6.4",
      "cognitiveLoad": 75
    },
    "cognitiveLoad": 75,
    "curriculumTags": [
      "6N1a"
    ],
    "scenario": {
      "id": "shop-002-realistic-general",
      "theme": "SHOPPING",
      "setting": {
        "location": "local shop",
        "timeContext": "after school",
        "atmosphere": "friendly"
      },
      "characters": [
        {
          "name": "Logan",
          "role": "student"
        }
      ],
      "items": [
        {
          "name": "apple",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.2,
            "max": 0.5,
            "typical": 0.35,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "banana",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.15,
            "max": 0.4,
            "typical": 0.25,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sandwich",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 2.5,
            "max": 6,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "drink",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.8,
            "max": 2.5,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "cake",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 1.5,
            "max": 4,
            "typical": 2.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "biscuit",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.8,
            "max": 2,
            "typical": 1.2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sweet",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.1,
            "max": 1,
            "typical": 0.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "chocolate",
          "category": "FOOD_DRINK",
          "typicalValue": {
            "min": 0.6,
            "max": 3,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "pen",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.5,
            "max": 2,
            "typical": 1,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "pencil",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.2,
            "max": 1,
            "typical": 0.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "ruler",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.8,
            "max": 2.5,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "notebook",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 1,
            "max": 4,
            "typical": 2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "eraser",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.3,
            "max": 1.5,
            "typical": 0.75,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "book",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 3,
            "max": 15,
            "typical": 8,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "comic",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2,
            "max": 5,
            "typical": 3,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "magazine",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2.5,
            "max": 6,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "toy",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 5,
            "max": 25,
            "typical": 12,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "game",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 8,
            "max": 60,
            "typical": 25,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "puzzle",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 5,
            "max": 20,
            "typical": 12,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sticker",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 0.2,
            "max": 2,
            "typical": 0.8,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "badge",
          "category": "TOYS_GAMES",
          "typicalValue": {
            "min": 0.5,
            "max": 3,
            "typical": 1.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "poster",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 2,
            "max": 8,
            "typical": 4,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "card",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 0.5,
            "max": 4,
            "typical": 2,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        }
      ],
      "culturalElements": [
        {
          "type": "currency",
          "value": "£",
          "explanation": "British pounds"
        },
        {
          "type": "location",
          "value": "UK local shop",
          "explanation": "Typical British corner shop"
        }
      ],
      "realWorldConnection": "Everyday shopping with realistic UK prices",
      "yearAppropriate": [
        1,
        2,
        3,
        4,
        5,
        6
      ],
      "templates": [
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "MULTI_STEP"
          ],
          "modelCompatibility": [
            "ADDITION"
          ],
          "operandCount": 3,
          "template": "{character} buys {article1} {item1} for {price1}, {article2} {item2} for {price2}, and {article3} {item3} for {price3}. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item1",
              "type": "item"
            },
            {
              "key": "item2",
              "type": "item"
            },
            {
              "key": "item3",
              "type": "item"
            },
            {
              "key": "price1",
              "type": "value"
            },
            {
              "key": "price2",
              "type": "value"
            },
            {
              "key": "price3",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "MULTI_STEP"
          ],
          "modelCompatibility": [
            "ADDITION"
          ],
          "operandCount": 2,
          "template": "{character} buys {article1} {item1} for {price1} and {article2} {item2} for {price2}. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item1",
              "type": "item"
            },
            {
              "key": "item2",
              "type": "item"
            },
            {
              "key": "price1",
              "type": "value"
            },
            {
              "key": "price2",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "SUBTRACTION",
            "CHANGE_CALCULATION"
          ],
          "template": "{character} buys {article} {item} for {price} and pays with {payment}. How much change does {character} get?",
          "answerTemplate": "{character} receives {result} in change",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "payment",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "MULTIPLICATION"
          ],
          "template": "{character} buys {quantity} {item} at {price} each. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "quantity",
              "type": "value"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION"
          ],
          "modelCompatibility": [
            "DIVISION"
          ],
          "template": "{character} has {total} to spend equally on {quantity} {item}. How much can {character} spend on each one?",
          "answerTemplate": "{character} can spend {result} on each {item}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "total",
              "type": "value"
            },
            {
              "key": "quantity",
              "type": "value"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "COMPARISON",
            "ESTIMATION",
            "MULTI_STEP"
          ],
          "template": "{character} goes to the shop and buys {items}. How much does {character} spend in total?",
          "answerTemplate": "{character} spends {result} in total",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "ESTIMATION"
          ],
          "template": "Estimate: If {character} buys {items}, about how much will it cost?",
          "answerTemplate": "It will cost approximately {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        },
        {
          "formatCompatibility": [
            "VALIDATION"
          ],
          "template": "{character} calculated that {items} costs {amount}. Is this correct?",
          "answerTemplate": "{validation_result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item_list"
            },
            {
              "key": "amount",
              "type": "value"
            },
            {
              "key": "validation_result",
              "type": "boolean"
            }
          ]
        }
      ]
    },
    "distractors": [
      {
        "value": 1585,
        "displayText": "1585",
        "strategy": "WRONG_OPERATION",
        "reasoning": "Added instead of multiplying"
      },
      {
        "value": 1297,
        "displayText": "1297",
        "strategy": "WRONG_OPERATION",
        "reasoning": "Subtracted instead of multiplying"
      },
      {
        "value": 57.52,
        "displayText": "57.52",
        "strategy": "PLACE_VALUE_ERROR",
        "reasoning": "Error in carrying to next column"
      }
    ],
    "enhancementStatus": {
      "level": "partial",
      "requestedFormat": "DIRECT_CALCULATION",
      "actualFormat": "DIRECT_CALCULATION",
      "featuresActive": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "featuresPending": [],
      "isFullyEnhanced": true
    },
    "mathOutput": {
      "operation": "MULTIPLICATION",
      "multiplier": 144,
      "multiplicand": 0.33,
      "result": 47.52
    },
    "generationTime": 1,
    "questionId": "q_1759232462752_0jdzbyac9",
    "generationSetup": {
      "controller_used": "DIRECT_CALCULATIONController",
      "format_requested": "DIRECT_CALCULATION",
      "format_actual": "DIRECT_CALCULATION",
      "scenario_theme": "SHOPPING",
      "scenario_id": "shop-002-realistic-general",
      "scenario_selection_method": "default",
      "distractor_strategies": [
        "WRONG_OPERATION",
        "WRONG_OPERATION",
        "PLACE_VALUE_ERROR"
      ],
      "distractor_count": 3,
      "theme_variety": false,
      "format_variety": false,
      "enhancement_level": "partial",
      "features_active": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "features_pending": [],
      "generation_time_ms": 1
    }
  },
  "metadata": {
    "format": "DIRECT_CALCULATION",
    "cognitive_load": 75,
    "curriculum_alignment": [
      "6N1a"
    ],
    "difficulty": "6.4",
    "scenario_theme": "SHOPPING",
    "distractor_strategies": [
      "WRONG_OPERATION",
      "WRONG_OPERATION",
      "PLACE_VALUE_ERROR"
    ],
    "generation_time_ms": 1,
    "api_version": "2.0",
    "enhancement_status": "partial",
    "format_requested": "DIRECT_CALCULATION",
    "format_used": "DIRECT_CALCULATION",
    "features_active": [
      "enhanced_distractors",
      "rich_scenarios",
      "cognitive_load",
      "advanced_formats"
    ],
    "features_pending": []
  },
  "context": {
    "id": "shop-002-realistic-general",
    "theme": "SHOPPING",
    "setting": {
      "location": "local shop",
      "timeContext": "after school",
      "atmosphere": "friendly"
    },
    "characters": [
      {
        "name": "Logan",
        "role": "student"
      }
    ],
    "items": [
      {
        "name": "apple",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.2,
          "max": 0.5,
          "typical": 0.35,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "banana",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.15,
          "max": 0.4,
          "typical": 0.25,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sandwich",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 2.5,
          "max": 6,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "drink",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.8,
          "max": 2.5,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "cake",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 1.5,
          "max": 4,
          "typical": 2.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "biscuit",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.8,
          "max": 2,
          "typical": 1.2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sweet",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.1,
          "max": 1,
          "typical": 0.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "chocolate",
        "category": "FOOD_DRINK",
        "typicalValue": {
          "min": 0.6,
          "max": 3,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "pen",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.5,
          "max": 2,
          "typical": 1,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "pencil",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.2,
          "max": 1,
          "typical": 0.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "ruler",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.8,
          "max": 2.5,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "notebook",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 1,
          "max": 4,
          "typical": 2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "eraser",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.3,
          "max": 1.5,
          "typical": 0.75,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "book",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 3,
          "max": 15,
          "typical": 8,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "comic",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2,
          "max": 5,
          "typical": 3,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "magazine",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2.5,
          "max": 6,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "toy",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 5,
          "max": 25,
          "typical": 12,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "game",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 8,
          "max": 60,
          "typical": 25,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "puzzle",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 5,
          "max": 20,
          "typical": 12,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sticker",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 0.2,
          "max": 2,
          "typical": 0.8,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "badge",
        "category": "TOYS_GAMES",
        "typicalValue": {
          "min": 0.5,
          "max": 3,
          "typical": 1.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "poster",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 2,
          "max": 8,
          "typical": 4,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "card",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 0.5,
          "max": 4,
          "typical": 2,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      }
    ],
    "culturalElements": [
      {
        "type": "currency",
        "value": "£",
        "explanation": "British pounds"
      },
      {
        "type": "location",
        "value": "UK local shop",
        "explanation": "Typical British corner shop"
      }
    ],
    "realWorldConnection": "Everyday shopping with realistic UK prices",
    "yearAppropriate": [
      1,
      2,
      3,
      4,
      5,
      6
    ],
    "templates": [
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "MULTI_STEP"
        ],
        "modelCompatibility": [
          "ADDITION"
        ],
        "operandCount": 3,
        "template": "{character} buys {article1} {item1} for {price1}, {article2} {item2} for {price2}, and {article3} {item3} for {price3}. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item1",
            "type": "item"
          },
          {
            "key": "item2",
            "type": "item"
          },
          {
            "key": "item3",
            "type": "item"
          },
          {
            "key": "price1",
            "type": "value"
          },
          {
            "key": "price2",
            "type": "value"
          },
          {
            "key": "price3",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "MULTI_STEP"
        ],
        "modelCompatibility": [
          "ADDITION"
        ],
        "operandCount": 2,
        "template": "{character} buys {article1} {item1} for {price1} and {article2} {item2} for {price2}. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item1",
            "type": "item"
          },
          {
            "key": "item2",
            "type": "item"
          },
          {
            "key": "price1",
            "type": "value"
          },
          {
            "key": "price2",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "SUBTRACTION",
          "CHANGE_CALCULATION"
        ],
        "template": "{character} buys {article} {item} for {price} and pays with {payment}. How much change does {character} get?",
        "answerTemplate": "{character} receives {result} in change",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "payment",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "MULTIPLICATION"
        ],
        "template": "{character} buys {quantity} {item} at {price} each. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "quantity",
            "type": "value"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION"
        ],
        "modelCompatibility": [
          "DIVISION"
        ],
        "template": "{character} has {total} to spend equally on {quantity} {item}. How much can {character} spend on each one?",
        "answerTemplate": "{character} can spend {result} on each {item}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "total",
            "type": "value"
          },
          {
            "key": "quantity",
            "type": "value"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "COMPARISON",
          "ESTIMATION",
          "MULTI_STEP"
        ],
        "template": "{character} goes to the shop and buys {items}. How much does {character} spend in total?",
        "answerTemplate": "{character} spends {result} in total",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "ESTIMATION"
        ],
        "template": "Estimate: If {character} buys {items}, about how much will it cost?",
        "answerTemplate": "It will cost approximately {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      },
      {
        "formatCompatibility": [
          "VALIDATION"
        ],
        "template": "{character} calculated that {items} costs {amount}. Is this correct?",
        "answerTemplate": "{validation_result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item_list"
          },
          {
            "key": "amount",
            "type": "value"
          },
          {
            "key": "validation_result",
            "type": "boolean"
          }
        ]
      }
    ]
  }
}

--- SUITE E: SCENARIO THEME TESTS ---
Testing that each scenario theme can be applied...
# Test E.1: SHOPPING theme
{
  "success": true,
  "question": {
    "text": "Sarah wants to buy books at the book fair. Calculate the total cost.",
    "options": [
      {
        "text": "28.32",
        "value": 28.32,
        "index": 0
      },
      {
        "text": "10.12",
        "value": 10.12,
        "index": 1
      },
      {
        "text": "£18.32",
        "value": 18.32,
        "index": 2
      },
      {
        "text": "11.06",
        "value": 11.06,
        "index": 3
      }
    ],
    "correctIndex": 2,
    "format": "DIRECT_CALCULATION",
    "difficulty": {
      "year": 3,
      "subLevel": 1,
      "displayName": "3.1",
      "cognitiveLoad": 30
    },
    "cognitiveLoad": 30,
    "curriculumTags": [
      "3N1a",
      "3N1b"
    ],
    "scenario": {
      "id": "shop-001-bookfair",
      "theme": "SHOPPING",
      "setting": {
        "location": "school book fair",
        "timeContext": "lunch break",
        "atmosphere": "busy"
      },
      "characters": [
        {
          "name": "Sarah",
          "role": "student"
        },
        {
          "name": "Mr. Johnson",
          "role": "teacher"
        }
      ],
      "items": [
        {
          "name": "book",
          "category": "BOOKS_MEDIA",
          "typicalValue": {
            "min": 3,
            "max": 12,
            "typical": 6.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "bookmark",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.5,
            "max": 2,
            "typical": 1,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        }
      ],
      "culturalElements": [
        {
          "type": "currency",
          "value": "£",
          "explanation": "British pounds"
        },
        {
          "type": "event",
          "value": "book fair",
          "explanation": "School fundraising event"
        }
      ],
      "realWorldConnection": "School fundraising and reading promotion",
      "yearAppropriate": [
        2,
        3,
        4,
        5
      ],
      "templates": [
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "COMPARISON"
          ],
          "modelCompatibility": [
            "ADDITION",
            "COUNTING"
          ],
          "template": "{character} wants to buy books at the book fair. Calculate the total cost.",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        }
      ]
    },
    "distractors": [
      {
        "value": 11.06,
        "displayText": "11.06",
        "strategy": "WRONG_OPERATION",
        "reasoning": "Subtracted instead of adding"
      },
      {
        "value": 10.12,
        "displayText": "10.12",
        "strategy": "WRONG_OPERATION",
        "reasoning": "Multiplied instead of adding"
      },
      {
        "value": 28.32,
        "displayText": "28.32",
        "strategy": "PLACE_VALUE_ERROR",
        "reasoning": "Error in carrying to next column"
      }
    ],
    "enhancementStatus": {
      "level": "partial",
      "requestedFormat": "DIRECT_CALCULATION",
      "actualFormat": "DIRECT_CALCULATION",
      "featuresActive": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "featuresPending": [],
      "isFullyEnhanced": true
    },
    "mathOutput": {
      "operation": "ADDITION",
      "operand_1": 11.91,
      "operand_2": 0.85,
      "operand_3": 5.56,
      "result": 18.32
    },
    "generationTime": 0,
    "questionId": "q_1759232462793_b8i1sbh2n",
    "generationSetup": {
      "controller_used": "DIRECT_CALCULATIONController",
      "format_requested": "DIRECT_CALCULATION",
      "format_actual": "DIRECT_CALCULATION",
      "scenario_theme": "SHOPPING",
      "scenario_id": "shop-001-bookfair",
      "scenario_selection_method": "requested",
      "distractor_strategies": [
        "WRONG_OPERATION",
        "WRONG_OPERATION",
        "PLACE_VALUE_ERROR"
      ],
      "distractor_count": 3,
      "theme_variety": false,
      "format_variety": false,
      "enhancement_level": "partial",
      "features_active": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "features_pending": [],
      "generation_time_ms": 0
    }
  },
  "metadata": {
    "format": "DIRECT_CALCULATION",
    "cognitive_load": 30,
    "curriculum_alignment": [
      "3N1a",
      "3N1b"
    ],
    "difficulty": "3.1",
    "scenario_theme": "SHOPPING",
    "distractor_strategies": [
      "WRONG_OPERATION",
      "WRONG_OPERATION",
      "PLACE_VALUE_ERROR"
    ],
    "generation_time_ms": 0,
    "api_version": "2.0",
    "enhancement_status": "partial",
    "format_requested": "DIRECT_CALCULATION",
    "format_used": "DIRECT_CALCULATION",
    "features_active": [
      "enhanced_distractors",
      "rich_scenarios",
      "cognitive_load",
      "advanced_formats"
    ],
    "features_pending": []
  },
  "context": {
    "id": "shop-001-bookfair",
    "theme": "SHOPPING",
    "setting": {
      "location": "school book fair",
      "timeContext": "lunch break",
      "atmosphere": "busy"
    },
    "characters": [
      {
        "name": "Sarah",
        "role": "student"
      },
      {
        "name": "Mr. Johnson",
        "role": "teacher"
      }
    ],
    "items": [
      {
        "name": "book",
        "category": "BOOKS_MEDIA",
        "typicalValue": {
          "min": 3,
          "max": 12,
          "typical": 6.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "bookmark",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.5,
          "max": 2,
          "typical": 1,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      }
    ],
    "culturalElements": [
      {
        "type": "currency",
        "value": "£",
        "explanation": "British pounds"
      },
      {
        "type": "event",
        "value": "book fair",
        "explanation": "School fundraising event"
      }
    ],
    "realWorldConnection": "School fundraising and reading promotion",
    "yearAppropriate": [
      2,
      3,
      4,
      5
    ],
    "templates": [
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "COMPARISON"
        ],
        "modelCompatibility": [
          "ADDITION",
          "COUNTING"
        ],
        "template": "{character} wants to buy books at the book fair. Calculate the total cost.",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      }
    ]
  }
}
# Test E.2: COOKING theme
{
  "success": true,
  "question": {
    "text": "Henry is making bread. The ingredients cost £35, £5, £24. What is the total cost?",
    "options": [
      {
        "text": "£64.00",
        "value": 64,
        "index": 0
      },
      {
        "text": "74",
        "value": 74,
        "index": 1
      },
      {
        "text": "175",
        "value": 175,
        "index": 2
      },
      {
        "text": "30",
        "value": 30,
        "index": 3
      }
    ],
    "correctIndex": 0,
    "format": "DIRECT_CALCULATION",
    "difficulty": {
      "year": 3,
      "subLevel": 1,
      "displayName": "3.1",
      "cognitiveLoad": 30
    },
    "cognitiveLoad": 30,
    "curriculumTags": [
      "3N1a",
      "3N1b"
    ],
    "scenario": {
      "id": "cooking-3-1759232462835",
      "theme": "COOKING",
      "setting": {
        "location": "kitchen",
        "timeContext": "weekend baking",
        "atmosphere": "creative"
      },
      "characters": [
        {
          "name": "Henry",
          "role": "student"
        },
        {
          "name": "Mum",
          "role": "parent"
        }
      ],
      "items": [
        {
          "name": "flour",
          "category": "FOOD_ITEMS",
          "typicalValue": {
            "min": 1,
            "max": 5,
            "typical": 2.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "eggs",
          "category": "FOOD_ITEMS",
          "typicalValue": {
            "min": 1,
            "max": 5,
            "typical": 2.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "butter",
          "category": "FOOD_ITEMS",
          "typicalValue": {
            "min": 1,
            "max": 5,
            "typical": 2.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sugar",
          "category": "FOOD_ITEMS",
          "typicalValue": {
            "min": 1,
            "max": 5,
            "typical": 2.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "milk",
          "category": "FOOD_ITEMS",
          "typicalValue": {
            "min": 1,
            "max": 5,
            "typical": 2.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "chocolate chips",
          "category": "FOOD_ITEMS",
          "typicalValue": {
            "min": 1,
            "max": 5,
            "typical": 2.5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        }
      ],
      "culturalElements": [
        {
          "type": "currency",
          "value": "£",
          "explanation": "British pounds"
        },
        {
          "type": "measurement",
          "value": "grams",
          "explanation": "Weight measurement for ingredients"
        }
      ],
      "realWorldConnection": "Following recipes and calculating ingredient costs",
      "yearAppropriate": [
        3
      ],
      "templates": [
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "MULTI_STEP"
          ],
          "template": "{character} is making {recipe}. The ingredients cost {prices}. What is the total cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "recipe",
              "type": "item"
            },
            {
              "key": "prices",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        }
      ]
    },
    "distractors": [
      {
        "value": 30,
        "displayText": "30",
        "strategy": "WRONG_OPERATION",
        "reasoning": "Subtracted instead of adding"
      },
      {
        "value": 175,
        "displayText": "175",
        "strategy": "WRONG_OPERATION",
        "reasoning": "Multiplied instead of adding"
      },
      {
        "value": 74,
        "displayText": "74",
        "strategy": "PLACE_VALUE_ERROR",
        "reasoning": "Error in carrying to next column"
      }
    ],
    "enhancementStatus": {
      "level": "partial",
      "requestedFormat": "DIRECT_CALCULATION",
      "actualFormat": "DIRECT_CALCULATION",
      "featuresActive": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "featuresPending": [],
      "isFullyEnhanced": true
    },
    "mathOutput": {
      "operation": "ADDITION",
      "operand_1": 35,
      "operand_2": 5,
      "operand_3": 24,
      "result": 64
    },
    "generationTime": 1,
    "questionId": "q_1759232462835_nrgy1jw7a",
    "generationSetup": {
      "controller_used": "DIRECT_CALCULATIONController",
      "format_requested": "DIRECT_CALCULATION",
      "format_actual": "DIRECT_CALCULATION",
      "scenario_theme": "COOKING",
      "scenario_id": "cooking-3-1759232462835",
      "scenario_selection_method": "requested",
      "distractor_strategies": [
        "WRONG_OPERATION",
        "WRONG_OPERATION",
        "PLACE_VALUE_ERROR"
      ],
      "distractor_count": 3,
      "theme_variety": false,
      "format_variety": false,
      "enhancement_level": "partial",
      "features_active": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "features_pending": [],
      "generation_time_ms": 1
    }
  },
  "metadata": {
    "format": "DIRECT_CALCULATION",
    "cognitive_load": 30,
    "curriculum_alignment": [
      "3N1a",
      "3N1b"
    ],
    "difficulty": "3.1",
    "scenario_theme": "COOKING",
    "distractor_strategies": [
      "WRONG_OPERATION",
      "WRONG_OPERATION",
      "PLACE_VALUE_ERROR"
    ],
    "generation_time_ms": 1,
    "api_version": "2.0",
    "enhancement_status": "partial",
    "format_requested": "DIRECT_CALCULATION",
    "format_used": "DIRECT_CALCULATION",
    "features_active": [
      "enhanced_distractors",
      "rich_scenarios",
      "cognitive_load",
      "advanced_formats"
    ],
    "features_pending": []
  },
  "context": {
    "id": "cooking-3-1759232462835",
    "theme": "COOKING",
    "setting": {
      "location": "kitchen",
      "timeContext": "weekend baking",
      "atmosphere": "creative"
    },
    "characters": [
      {
        "name": "Henry",
        "role": "student"
      },
      {
        "name": "Mum",
        "role": "parent"
      }
    ],
    "items": [
      {
        "name": "flour",
        "category": "FOOD_ITEMS",
        "typicalValue": {
          "min": 1,
          "max": 5,
          "typical": 2.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "eggs",
        "category": "FOOD_ITEMS",
        "typicalValue": {
          "min": 1,
          "max": 5,
          "typical": 2.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "butter",
        "category": "FOOD_ITEMS",
        "typicalValue": {
          "min": 1,
          "max": 5,
          "typical": 2.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sugar",
        "category": "FOOD_ITEMS",
        "typicalValue": {
          "min": 1,
          "max": 5,
          "typical": 2.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "milk",
        "category": "FOOD_ITEMS",
        "typicalValue": {
          "min": 1,
          "max": 5,
          "typical": 2.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "chocolate chips",
        "category": "FOOD_ITEMS",
        "typicalValue": {
          "min": 1,
          "max": 5,
          "typical": 2.5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      }
    ],
    "culturalElements": [
      {
        "type": "currency",
        "value": "£",
        "explanation": "British pounds"
      },
      {
        "type": "measurement",
        "value": "grams",
        "explanation": "Weight measurement for ingredients"
      }
    ],
    "realWorldConnection": "Following recipes and calculating ingredient costs",
    "yearAppropriate": [
      3
    ],
    "templates": [
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "MULTI_STEP"
        ],
        "template": "{character} is making {recipe}. The ingredients cost {prices}. What is the total cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "recipe",
            "type": "item"
          },
          {
            "key": "prices",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      }
    ]
  }
}
# Test E.3: SPORTS theme
{
  "success": true,
  "question": {
    "text": "The football costs £20. If Liam buys 2, how much will it cost?",
    "options": [
      {
        "text": "£101.00",
        "value": 101,
        "index": 0
      },
      {
        "text": "1443",
        "value": 1443,
        "index": 1
      },
      {
        "text": "2",
        "value": 2,
        "index": 2
      },
      {
        "text": "201",
        "value": 201,
        "index": 3
      }
    ],
    "correctIndex": 0,
    "format": "DIRECT_CALCULATION",
    "difficulty": {
      "year": 3,
      "subLevel": 1,
      "displayName": "3.1",
      "cognitiveLoad": 30
    },
    "cognitiveLoad": 30,
    "curriculumTags": [
      "3N1a",
      "3N1b"
    ],
    "scenario": {
      "id": "sports-3-1759232462879",
      "theme": "SPORTS",
      "setting": {
        "location": "leisure centre",
        "timeContext": "weekend",
        "atmosphere": "energetic"
      },
      "characters": [
        {
          "name": "Liam",
          "role": "student"
        },
        {
          "name": "Jacob",
          "role": "coach"
        }
      ],
      "items": [
        {
          "name": "football",
          "category": "SPORTS_EQUIPMENT",
          "typicalValue": {
            "min": 5,
            "max": 50,
            "typical": 20,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "tennis ball",
          "category": "SPORTS_EQUIPMENT",
          "typicalValue": {
            "min": 5,
            "max": 50,
            "typical": 20,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "cricket bat",
          "category": "SPORTS_EQUIPMENT",
          "typicalValue": {
            "min": 5,
            "max": 50,
            "typical": 20,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "rugby ball",
          "category": "SPORTS_EQUIPMENT",
          "typicalValue": {
            "min": 5,
            "max": 50,
            "typical": 20,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "basketball",
          "category": "SPORTS_EQUIPMENT",
          "typicalValue": {
            "min": 5,
            "max": 50,
            "typical": 20,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        }
      ],
      "culturalElements": [
        {
          "type": "currency",
          "value": "£",
          "explanation": "British pounds"
        }
      ],
      "realWorldConnection": "Calculating costs for sports activities",
      "yearAppropriate": [
        3
      ],
      "templates": [
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "MULTI_STEP"
          ],
          "template": "The {item} costs {price}. If {character} buys {quantity}, how much will it cost?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "quantity",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        }
      ]
    },
    "distractors": [
      {
        "value": 2,
        "displayText": "2",
        "strategy": "WRONG_OPERATION",
        "reasoning": "Subtracted instead of adding"
      },
      {
        "value": 1443,
        "displayText": "1443",
        "strategy": "WRONG_OPERATION",
        "reasoning": "Multiplied instead of adding"
      },
      {
        "value": 201,
        "displayText": "201",
        "strategy": "PLACE_VALUE_ERROR",
        "reasoning": "Error in carrying to next column"
      }
    ],
    "enhancementStatus": {
      "level": "partial",
      "requestedFormat": "DIRECT_CALCULATION",
      "actualFormat": "DIRECT_CALCULATION",
      "featuresActive": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "featuresPending": [],
      "isFullyEnhanced": true
    },
    "mathOutput": {
      "operation": "ADDITION",
      "operand_1": 39,
      "operand_2": 37,
      "operand_3": 25,
      "result": 101
    },
    "generationTime": 1,
    "questionId": "q_1759232462880_zlibc8fuf",
    "generationSetup": {
      "controller_used": "DIRECT_CALCULATIONController",
      "format_requested": "DIRECT_CALCULATION",
      "format_actual": "DIRECT_CALCULATION",
      "scenario_theme": "SPORTS",
      "scenario_id": "sports-3-1759232462879",
      "scenario_selection_method": "requested",
      "distractor_strategies": [
        "WRONG_OPERATION",
        "WRONG_OPERATION",
        "PLACE_VALUE_ERROR"
      ],
      "distractor_count": 3,
      "theme_variety": false,
      "format_variety": false,
      "enhancement_level": "partial",
      "features_active": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "features_pending": [],
      "generation_time_ms": 1
    }
  },
  "metadata": {
    "format": "DIRECT_CALCULATION",
    "cognitive_load": 30,
    "curriculum_alignment": [
      "3N1a",
      "3N1b"
    ],
    "difficulty": "3.1",
    "scenario_theme": "SPORTS",
    "distractor_strategies": [
      "WRONG_OPERATION",
      "WRONG_OPERATION",
      "PLACE_VALUE_ERROR"
    ],
    "generation_time_ms": 1,
    "api_version": "2.0",
    "enhancement_status": "partial",
    "format_requested": "DIRECT_CALCULATION",
    "format_used": "DIRECT_CALCULATION",
    "features_active": [
      "enhanced_distractors",
      "rich_scenarios",
      "cognitive_load",
      "advanced_formats"
    ],
    "features_pending": []
  },
  "context": {
    "id": "sports-3-1759232462879",
    "theme": "SPORTS",
    "setting": {
      "location": "leisure centre",
      "timeContext": "weekend",
      "atmosphere": "energetic"
    },
    "characters": [
      {
        "name": "Liam",
        "role": "student"
      },
      {
        "name": "Jacob",
        "role": "coach"
      }
    ],
    "items": [
      {
        "name": "football",
        "category": "SPORTS_EQUIPMENT",
        "typicalValue": {
          "min": 5,
          "max": 50,
          "typical": 20,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "tennis ball",
        "category": "SPORTS_EQUIPMENT",
        "typicalValue": {
          "min": 5,
          "max": 50,
          "typical": 20,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "cricket bat",
        "category": "SPORTS_EQUIPMENT",
        "typicalValue": {
          "min": 5,
          "max": 50,
          "typical": 20,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "rugby ball",
        "category": "SPORTS_EQUIPMENT",
        "typicalValue": {
          "min": 5,
          "max": 50,
          "typical": 20,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "basketball",
        "category": "SPORTS_EQUIPMENT",
        "typicalValue": {
          "min": 5,
          "max": 50,
          "typical": 20,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      }
    ],
    "culturalElements": [
      {
        "type": "currency",
        "value": "£",
        "explanation": "British pounds"
      }
    ],
    "realWorldConnection": "Calculating costs for sports activities",
    "yearAppropriate": [
      3
    ],
    "templates": [
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "MULTI_STEP"
        ],
        "template": "The {item} costs {price}. If {character} buys {quantity}, how much will it cost?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "quantity",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      }
    ]
  }
}
# Test E.4: SCHOOL theme
{
  "success": true,
  "question": {
    "text": "Liam needs to buy calculator, compass, protractor, highlighter for school. How much will it cost in total?",
    "options": [
      {
        "text": "£70.00",
        "value": 70,
        "index": 0
      },
      {
        "text": "74",
        "value": 74,
        "index": 1
      },
      {
        "text": "80",
        "value": 80,
        "index": 2
      },
      {
        "text": "35",
        "value": 35,
        "index": 3
      }
    ],
    "correctIndex": 0,
    "format": "DIRECT_CALCULATION",
    "difficulty": {
      "year": 3,
      "subLevel": 1,
      "displayName": "3.1",
      "cognitiveLoad": 30
    },
    "cognitiveLoad": 30,
    "curriculumTags": [
      "3N1a",
      "3N1b"
    ],
    "scenario": {
      "id": "school-3-1759232462925",
      "theme": "SCHOOL",
      "setting": {
        "location": "school stationery shop",
        "timeContext": "start of term",
        "atmosphere": "busy"
      },
      "characters": [
        {
          "name": "Liam",
          "role": "student"
        },
        {
          "name": "Mrs. Thompson",
          "role": "teacher"
        }
      ],
      "items": [
        {
          "name": "calculator",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.5,
            "max": 15,
            "typical": 3,
            "distribution": "skewed_low"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "compass",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.5,
            "max": 15,
            "typical": 3,
            "distribution": "skewed_low"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "protractor",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.5,
            "max": 15,
            "typical": 3,
            "distribution": "skewed_low"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "highlighter",
          "category": "SCHOOL_SUPPLIES",
          "typicalValue": {
            "min": 0.5,
            "max": 15,
            "typical": 3,
            "distribution": "skewed_low"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        }
      ],
      "culturalElements": [
        {
          "type": "currency",
          "value": "£",
          "explanation": "British pounds"
        },
        {
          "type": "event",
          "value": "start of term",
          "explanation": "When students buy school supplies"
        }
      ],
      "realWorldConnection": "Budgeting for school supplies",
      "yearAppropriate": [
        3
      ],
      "templates": [
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "COMPARISON"
          ],
          "template": "{character} needs to buy {items} for school. How much will it cost in total?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        }
      ]
    },
    "distractors": [
      {
        "value": 35,
        "displayText": "35",
        "strategy": "WRONG_OPERATION",
        "reasoning": "Subtracted instead of adding"
      },
      {
        "value": 74,
        "displayText": "74",
        "strategy": "WRONG_OPERATION",
        "reasoning": "Multiplied instead of adding"
      },
      {
        "value": 80,
        "displayText": "80",
        "strategy": "PLACE_VALUE_ERROR",
        "reasoning": "Error in carrying to next column"
      }
    ],
    "enhancementStatus": {
      "level": "partial",
      "requestedFormat": "DIRECT_CALCULATION",
      "actualFormat": "DIRECT_CALCULATION",
      "featuresActive": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "featuresPending": [],
      "isFullyEnhanced": true
    },
    "mathOutput": {
      "operation": "ADDITION",
      "operand_1": 37,
      "operand_2": 2,
      "operand_3": 31,
      "result": 70
    },
    "generationTime": 1,
    "questionId": "q_1759232462925_j12ouaf4d",
    "generationSetup": {
      "controller_used": "DIRECT_CALCULATIONController",
      "format_requested": "DIRECT_CALCULATION",
      "format_actual": "DIRECT_CALCULATION",
      "scenario_theme": "SCHOOL",
      "scenario_id": "school-3-1759232462925",
      "scenario_selection_method": "requested",
      "distractor_strategies": [
        "WRONG_OPERATION",
        "WRONG_OPERATION",
        "PLACE_VALUE_ERROR"
      ],
      "distractor_count": 3,
      "theme_variety": false,
      "format_variety": false,
      "enhancement_level": "partial",
      "features_active": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "features_pending": [],
      "generation_time_ms": 1
    }
  },
  "metadata": {
    "format": "DIRECT_CALCULATION",
    "cognitive_load": 30,
    "curriculum_alignment": [
      "3N1a",
      "3N1b"
    ],
    "difficulty": "3.1",
    "scenario_theme": "SCHOOL",
    "distractor_strategies": [
      "WRONG_OPERATION",
      "WRONG_OPERATION",
      "PLACE_VALUE_ERROR"
    ],
    "generation_time_ms": 1,
    "api_version": "2.0",
    "enhancement_status": "partial",
    "format_requested": "DIRECT_CALCULATION",
    "format_used": "DIRECT_CALCULATION",
    "features_active": [
      "enhanced_distractors",
      "rich_scenarios",
      "cognitive_load",
      "advanced_formats"
    ],
    "features_pending": []
  },
  "context": {
    "id": "school-3-1759232462925",
    "theme": "SCHOOL",
    "setting": {
      "location": "school stationery shop",
      "timeContext": "start of term",
      "atmosphere": "busy"
    },
    "characters": [
      {
        "name": "Liam",
        "role": "student"
      },
      {
        "name": "Mrs. Thompson",
        "role": "teacher"
      }
    ],
    "items": [
      {
        "name": "calculator",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.5,
          "max": 15,
          "typical": 3,
          "distribution": "skewed_low"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "compass",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.5,
          "max": 15,
          "typical": 3,
          "distribution": "skewed_low"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "protractor",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.5,
          "max": 15,
          "typical": 3,
          "distribution": "skewed_low"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "highlighter",
        "category": "SCHOOL_SUPPLIES",
        "typicalValue": {
          "min": 0.5,
          "max": 15,
          "typical": 3,
          "distribution": "skewed_low"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      }
    ],
    "culturalElements": [
      {
        "type": "currency",
        "value": "£",
        "explanation": "British pounds"
      },
      {
        "type": "event",
        "value": "start of term",
        "explanation": "When students buy school supplies"
      }
    ],
    "realWorldConnection": "Budgeting for school supplies",
    "yearAppropriate": [
      3
    ],
    "templates": [
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "COMPARISON"
        ],
        "template": "{character} needs to buy {items} for school. How much will it cost in total?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      }
    ]
  }
}
# Test E.5: POCKET_MONEY theme
{
  "success": true,
  "question": {
    "text": "What is 5 + 11 + 25?",
    "options": [
      {
        "text": "55",
        "value": 55,
        "index": 0
      },
      {
        "text": "16",
        "value": 16,
        "index": 1
      },
      {
        "text": "51",
        "value": 51,
        "index": 2
      },
      {
        "text": "£41.00",
        "value": 41,
        "index": 3
      }
    ],
    "correctIndex": 3,
    "format": "DIRECT_CALCULATION",
    "difficulty": {
      "year": 3,
      "subLevel": 1,
      "displayName": "3.1",
      "cognitiveLoad": 30
    },
    "cognitiveLoad": 30,
    "curriculumTags": [
      "3N1a",
      "3N1b"
    ],
    "scenario": {
      "id": "pocket-money-3-1759232462966",
      "theme": "SCHOOL",
      "setting": {
        "location": "home",
        "timeContext": "weekly",
        "atmosphere": "planning"
      },
      "characters": [
        {
          "name": "Amelia",
          "role": "student"
        }
      ],
      "items": [
        {
          "name": "video game",
          "category": "SAVING_GOAL",
          "typicalValue": {
            "min": 12,
            "max": 40,
            "typical": 25,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "board game",
          "category": "SAVING_GOAL",
          "typicalValue": {
            "min": 12,
            "max": 40,
            "typical": 25,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sports equipment",
          "category": "SAVING_GOAL",
          "typicalValue": {
            "min": 12,
            "max": 40,
            "typical": 25,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        }
      ],
      "culturalElements": [
        {
          "type": "currency",
          "value": "£",
          "explanation": "British pounds"
        },
        {
          "type": "custom",
          "value": "pocket money",
          "explanation": "Weekly allowance for children"
        }
      ],
      "realWorldConnection": "Learning to save and budget money",
      "yearAppropriate": [
        3
      ],
      "templates": [
        {
          "formatCompatibility": [
            "ESTIMATION",
            "MULTI_STEP"
          ],
          "template": "If {character} gets {amount} pocket money each week, how many weeks will it take to save for a {item} that costs {price}?",
          "answerTemplate": "It will take {result} weeks",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "amount",
              "type": "value"
            },
            {
              "key": "item",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            }
          ]
        }
      ]
    },
    "distractors": [
      {
        "value": 55,
        "displayText": "55",
        "strategy": "WRONG_OPERATION",
        "reasoning": "Multiplied instead of adding"
      },
      {
        "value": 51,
        "displayText": "51",
        "strategy": "PLACE_VALUE_ERROR",
        "reasoning": "Error in carrying to next column"
      },
      {
        "value": 16,
        "displayText": "16",
        "strategy": "PARTIAL_CALCULATION",
        "reasoning": "Stopped calculation early"
      }
    ],
    "enhancementStatus": {
      "level": "partial",
      "requestedFormat": "DIRECT_CALCULATION",
      "actualFormat": "DIRECT_CALCULATION",
      "featuresActive": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "featuresPending": [],
      "isFullyEnhanced": true
    },
    "mathOutput": {
      "operation": "ADDITION",
      "operand_1": 5,
      "operand_2": 11,
      "operand_3": 25,
      "result": 41
    },
    "generationTime": 1,
    "questionId": "q_1759232462966_0c66f2jh9",
    "generationSetup": {
      "controller_used": "DIRECT_CALCULATIONController",
      "format_requested": "DIRECT_CALCULATION",
      "format_actual": "DIRECT_CALCULATION",
      "scenario_theme": "SCHOOL",
      "scenario_id": "pocket-money-3-1759232462966",
      "scenario_selection_method": "requested",
      "distractor_strategies": [
        "WRONG_OPERATION",
        "PLACE_VALUE_ERROR",
        "PARTIAL_CALCULATION"
      ],
      "distractor_count": 3,
      "theme_variety": false,
      "format_variety": false,
      "enhancement_level": "partial",
      "features_active": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "features_pending": [],
      "generation_time_ms": 1
    }
  },
  "metadata": {
    "format": "DIRECT_CALCULATION",
    "cognitive_load": 30,
    "curriculum_alignment": [
      "3N1a",
      "3N1b"
    ],
    "difficulty": "3.1",
    "scenario_theme": "SCHOOL",
    "distractor_strategies": [
      "WRONG_OPERATION",
      "PLACE_VALUE_ERROR",
      "PARTIAL_CALCULATION"
    ],
    "generation_time_ms": 1,
    "api_version": "2.0",
    "enhancement_status": "partial",
    "format_requested": "DIRECT_CALCULATION",
    "format_used": "DIRECT_CALCULATION",
    "features_active": [
      "enhanced_distractors",
      "rich_scenarios",
      "cognitive_load",
      "advanced_formats"
    ],
    "features_pending": []
  },
  "context": {
    "id": "pocket-money-3-1759232462966",
    "theme": "SCHOOL",
    "setting": {
      "location": "home",
      "timeContext": "weekly",
      "atmosphere": "planning"
    },
    "characters": [
      {
        "name": "Amelia",
        "role": "student"
      }
    ],
    "items": [
      {
        "name": "video game",
        "category": "SAVING_GOAL",
        "typicalValue": {
          "min": 12,
          "max": 40,
          "typical": 25,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "board game",
        "category": "SAVING_GOAL",
        "typicalValue": {
          "min": 12,
          "max": 40,
          "typical": 25,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sports equipment",
        "category": "SAVING_GOAL",
        "typicalValue": {
          "min": 12,
          "max": 40,
          "typical": 25,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      }
    ],
    "culturalElements": [
      {
        "type": "currency",
        "value": "£",
        "explanation": "British pounds"
      },
      {
        "type": "custom",
        "value": "pocket money",
        "explanation": "Weekly allowance for children"
      }
    ],
    "realWorldConnection": "Learning to save and budget money",
    "yearAppropriate": [
      3
    ],
    "templates": [
      {
        "formatCompatibility": [
          "ESTIMATION",
          "MULTI_STEP"
        ],
        "template": "If {character} gets {amount} pocket money each week, how many weeks will it take to save for a {item} that costs {price}?",
        "answerTemplate": "It will take {result} weeks",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "amount",
            "type": "value"
          },
          {
            "key": "item",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          }
        ]
      }
    ]
  }
}
# Test E.6: NATURE theme
{
  "success": true,
  "question": {
    "text": "Charlotte collected flower, leaf, stone, stick, acorn, feather, shell, pine cone while exploring. How many items in total?",
    "options": [
      {
        "text": "783",
        "value": 783,
        "index": 0
      },
      {
        "text": "58",
        "value": 58,
        "index": 1
      },
      {
        "text": "2",
        "value": 2,
        "index": 2
      },
      {
        "text": "68",
        "value": 68,
        "index": 3
      }
    ],
    "correctIndex": 1,
    "format": "DIRECT_CALCULATION",
    "difficulty": {
      "year": 3,
      "subLevel": 1,
      "displayName": "3.1",
      "cognitiveLoad": 30
    },
    "cognitiveLoad": 30,
    "curriculumTags": [
      "3N1a",
      "3N1b"
    ],
    "scenario": {
      "id": "nature-3-1759232463012",
      "theme": "NATURE",
      "setting": {
        "location": "garden",
        "timeContext": "outdoor exploration",
        "atmosphere": "peaceful"
      },
      "characters": [
        {
          "name": "Charlotte",
          "role": "student"
        },
        {
          "name": "Mr. Green",
          "role": "park ranger"
        }
      ],
      "items": [
        {
          "name": "flower",
          "category": "NATURE_ITEMS",
          "typicalValue": {
            "min": 1,
            "max": 20,
            "typical": 5,
            "distribution": "normal"
          },
          "unit": "items",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "leaf",
          "category": "NATURE_ITEMS",
          "typicalValue": {
            "min": 1,
            "max": 20,
            "typical": 5,
            "distribution": "normal"
          },
          "unit": "items",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "stone",
          "category": "NATURE_ITEMS",
          "typicalValue": {
            "min": 1,
            "max": 20,
            "typical": 5,
            "distribution": "normal"
          },
          "unit": "items",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "stick",
          "category": "NATURE_ITEMS",
          "typicalValue": {
            "min": 1,
            "max": 20,
            "typical": 5,
            "distribution": "normal"
          },
          "unit": "items",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "acorn",
          "category": "NATURE_ITEMS",
          "typicalValue": {
            "min": 1,
            "max": 20,
            "typical": 5,
            "distribution": "normal"
          },
          "unit": "items",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "feather",
          "category": "NATURE_ITEMS",
          "typicalValue": {
            "min": 1,
            "max": 20,
            "typical": 5,
            "distribution": "normal"
          },
          "unit": "items",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "shell",
          "category": "NATURE_ITEMS",
          "typicalValue": {
            "min": 1,
            "max": 20,
            "typical": 5,
            "distribution": "normal"
          },
          "unit": "items",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "pine cone",
          "category": "NATURE_ITEMS",
          "typicalValue": {
            "min": 1,
            "max": 20,
            "typical": 5,
            "distribution": "normal"
          },
          "unit": "items",
          "attributes": {
            "quality": "standard"
          }
        }
      ],
      "culturalElements": [
        {
          "type": "location",
          "value": "UK countryside",
          "explanation": "British natural environments"
        }
      ],
      "realWorldConnection": "Counting and collecting in nature",
      "yearAppropriate": [
        3
      ],
      "templates": [
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "COMPARISON"
          ],
          "template": "{character} collected {items} while exploring. How many items in total?",
          "answerTemplate": "{character} collected {result} items",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        }
      ]
    },
    "distractors": [
      {
        "value": 2,
        "displayText": "2",
        "strategy": "WRONG_OPERATION",
        "reasoning": "Subtracted instead of adding"
      },
      {
        "value": 783,
        "displayText": "783",
        "strategy": "WRONG_OPERATION",
        "reasoning": "Multiplied instead of adding"
      },
      {
        "value": 68,
        "displayText": "68",
        "strategy": "PLACE_VALUE_ERROR",
        "reasoning": "Error in carrying to next column"
      }
    ],
    "enhancementStatus": {
      "level": "partial",
      "requestedFormat": "DIRECT_CALCULATION",
      "actualFormat": "DIRECT_CALCULATION",
      "featuresActive": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "featuresPending": [],
      "isFullyEnhanced": true
    },
    "mathOutput": {
      "operation": "ADDITION",
      "operand_1": 29,
      "operand_2": 27,
      "operand_3": 2,
      "result": 58
    },
    "generationTime": 1,
    "questionId": "q_1759232463012_3b8v7l0pq",
    "generationSetup": {
      "controller_used": "DIRECT_CALCULATIONController",
      "format_requested": "DIRECT_CALCULATION",
      "format_actual": "DIRECT_CALCULATION",
      "scenario_theme": "NATURE",
      "scenario_id": "nature-3-1759232463012",
      "scenario_selection_method": "requested",
      "distractor_strategies": [
        "WRONG_OPERATION",
        "WRONG_OPERATION",
        "PLACE_VALUE_ERROR"
      ],
      "distractor_count": 3,
      "theme_variety": false,
      "format_variety": false,
      "enhancement_level": "partial",
      "features_active": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "features_pending": [],
      "generation_time_ms": 1
    }
  },
  "metadata": {
    "format": "DIRECT_CALCULATION",
    "cognitive_load": 30,
    "curriculum_alignment": [
      "3N1a",
      "3N1b"
    ],
    "difficulty": "3.1",
    "scenario_theme": "NATURE",
    "distractor_strategies": [
      "WRONG_OPERATION",
      "WRONG_OPERATION",
      "PLACE_VALUE_ERROR"
    ],
    "generation_time_ms": 1,
    "api_version": "2.0",
    "enhancement_status": "partial",
    "format_requested": "DIRECT_CALCULATION",
    "format_used": "DIRECT_CALCULATION",
    "features_active": [
      "enhanced_distractors",
      "rich_scenarios",
      "cognitive_load",
      "advanced_formats"
    ],
    "features_pending": []
  },
  "context": {
    "id": "nature-3-1759232463012",
    "theme": "NATURE",
    "setting": {
      "location": "garden",
      "timeContext": "outdoor exploration",
      "atmosphere": "peaceful"
    },
    "characters": [
      {
        "name": "Charlotte",
        "role": "student"
      },
      {
        "name": "Mr. Green",
        "role": "park ranger"
      }
    ],
    "items": [
      {
        "name": "flower",
        "category": "NATURE_ITEMS",
        "typicalValue": {
          "min": 1,
          "max": 20,
          "typical": 5,
          "distribution": "normal"
        },
        "unit": "items",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "leaf",
        "category": "NATURE_ITEMS",
        "typicalValue": {
          "min": 1,
          "max": 20,
          "typical": 5,
          "distribution": "normal"
        },
        "unit": "items",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "stone",
        "category": "NATURE_ITEMS",
        "typicalValue": {
          "min": 1,
          "max": 20,
          "typical": 5,
          "distribution": "normal"
        },
        "unit": "items",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "stick",
        "category": "NATURE_ITEMS",
        "typicalValue": {
          "min": 1,
          "max": 20,
          "typical": 5,
          "distribution": "normal"
        },
        "unit": "items",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "acorn",
        "category": "NATURE_ITEMS",
        "typicalValue": {
          "min": 1,
          "max": 20,
          "typical": 5,
          "distribution": "normal"
        },
        "unit": "items",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "feather",
        "category": "NATURE_ITEMS",
        "typicalValue": {
          "min": 1,
          "max": 20,
          "typical": 5,
          "distribution": "normal"
        },
        "unit": "items",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "shell",
        "category": "NATURE_ITEMS",
        "typicalValue": {
          "min": 1,
          "max": 20,
          "typical": 5,
          "distribution": "normal"
        },
        "unit": "items",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "pine cone",
        "category": "NATURE_ITEMS",
        "typicalValue": {
          "min": 1,
          "max": 20,
          "typical": 5,
          "distribution": "normal"
        },
        "unit": "items",
        "attributes": {
          "quality": "standard"
        }
      }
    ],
    "culturalElements": [
      {
        "type": "location",
        "value": "UK countryside",
        "explanation": "British natural environments"
      }
    ],
    "realWorldConnection": "Counting and collecting in nature",
    "yearAppropriate": [
      3
    ],
    "templates": [
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "COMPARISON"
        ],
        "template": "{character} collected {items} while exploring. How many items in total?",
        "answerTemplate": "{character} collected {result} items",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      }
    ]
  }
}
# Test E.7: TRANSPORT theme
{
  "success": true,
  "question": {
    "text": "A {transport} journey costs £11. How much for 9 journeys?",
    "options": [
      {
        "text": "99",
        "value": 99,
        "index": 0
      },
      {
        "text": "45",
        "value": 45,
        "index": 1
      },
      {
        "text": "2",
        "value": 2,
        "index": 2
      },
      {
        "text": "£35.00",
        "value": 35,
        "index": 3
      }
    ],
    "correctIndex": 3,
    "format": "DIRECT_CALCULATION",
    "difficulty": {
      "year": 3,
      "subLevel": 1,
      "displayName": "3.1",
      "cognitiveLoad": 30
    },
    "cognitiveLoad": 30,
    "curriculumTags": [
      "3N1a",
      "3N1b"
    ],
    "scenario": {
      "id": "transport-3-1759232463055",
      "theme": "TRANSPORT",
      "setting": {
        "location": "transport hub",
        "timeContext": "journey planning",
        "atmosphere": "busy"
      },
      "characters": [
        {
          "name": "Elizabeth",
          "role": "passenger"
        },
        {
          "name": "Mrs. Driver",
          "role": "transport operator"
        }
      ],
      "items": [
        {
          "name": "bus",
          "category": "TRANSPORT",
          "typicalValue": {
            "min": 1.5,
            "max": 15,
            "typical": 5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "train",
          "category": "TRANSPORT",
          "typicalValue": {
            "min": 1.5,
            "max": 15,
            "typical": 5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "taxi",
          "category": "TRANSPORT",
          "typicalValue": {
            "min": 1.5,
            "max": 15,
            "typical": 5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "tube",
          "category": "TRANSPORT",
          "typicalValue": {
            "min": 1.5,
            "max": 15,
            "typical": 5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "bike",
          "category": "TRANSPORT",
          "typicalValue": {
            "min": 1.5,
            "max": 15,
            "typical": 5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        }
      ],
      "culturalElements": [
        {
          "type": "currency",
          "value": "£",
          "explanation": "British pounds for transport fares"
        }
      ],
      "realWorldConnection": "Calculating travel costs and distances",
      "yearAppropriate": [
        3
      ],
      "templates": [
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "MULTI_STEP"
          ],
          "template": "A {transport} journey costs {price}. How much for {quantity} journeys?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "transport",
              "type": "item"
            },
            {
              "key": "price",
              "type": "value"
            },
            {
              "key": "quantity",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        }
      ]
    },
    "distractors": [
      {
        "value": 2,
        "displayText": "2",
        "strategy": "WRONG_OPERATION",
        "reasoning": "Subtracted instead of adding"
      },
      {
        "value": 99,
        "displayText": "99",
        "strategy": "WRONG_OPERATION",
        "reasoning": "Multiplied instead of adding"
      },
      {
        "value": 45,
        "displayText": "45",
        "strategy": "PLACE_VALUE_ERROR",
        "reasoning": "Error in carrying to next column"
      }
    ],
    "enhancementStatus": {
      "level": "partial",
      "requestedFormat": "DIRECT_CALCULATION",
      "actualFormat": "DIRECT_CALCULATION",
      "featuresActive": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "featuresPending": [],
      "isFullyEnhanced": true
    },
    "mathOutput": {
      "operation": "ADDITION",
      "operand_1": 11,
      "operand_2": 9,
      "operand_3": 15,
      "result": 35
    },
    "generationTime": 1,
    "questionId": "q_1759232463055_3bu7jclmj",
    "generationSetup": {
      "controller_used": "DIRECT_CALCULATIONController",
      "format_requested": "DIRECT_CALCULATION",
      "format_actual": "DIRECT_CALCULATION",
      "scenario_theme": "TRANSPORT",
      "scenario_id": "transport-3-1759232463055",
      "scenario_selection_method": "requested",
      "distractor_strategies": [
        "WRONG_OPERATION",
        "WRONG_OPERATION",
        "PLACE_VALUE_ERROR"
      ],
      "distractor_count": 3,
      "theme_variety": false,
      "format_variety": false,
      "enhancement_level": "partial",
      "features_active": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "features_pending": [],
      "generation_time_ms": 1
    }
  },
  "metadata": {
    "format": "DIRECT_CALCULATION",
    "cognitive_load": 30,
    "curriculum_alignment": [
      "3N1a",
      "3N1b"
    ],
    "difficulty": "3.1",
    "scenario_theme": "TRANSPORT",
    "distractor_strategies": [
      "WRONG_OPERATION",
      "WRONG_OPERATION",
      "PLACE_VALUE_ERROR"
    ],
    "generation_time_ms": 1,
    "api_version": "2.0",
    "enhancement_status": "partial",
    "format_requested": "DIRECT_CALCULATION",
    "format_used": "DIRECT_CALCULATION",
    "features_active": [
      "enhanced_distractors",
      "rich_scenarios",
      "cognitive_load",
      "advanced_formats"
    ],
    "features_pending": []
  },
  "context": {
    "id": "transport-3-1759232463055",
    "theme": "TRANSPORT",
    "setting": {
      "location": "transport hub",
      "timeContext": "journey planning",
      "atmosphere": "busy"
    },
    "characters": [
      {
        "name": "Elizabeth",
        "role": "passenger"
      },
      {
        "name": "Mrs. Driver",
        "role": "transport operator"
      }
    ],
    "items": [
      {
        "name": "bus",
        "category": "TRANSPORT",
        "typicalValue": {
          "min": 1.5,
          "max": 15,
          "typical": 5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "train",
        "category": "TRANSPORT",
        "typicalValue": {
          "min": 1.5,
          "max": 15,
          "typical": 5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "taxi",
        "category": "TRANSPORT",
        "typicalValue": {
          "min": 1.5,
          "max": 15,
          "typical": 5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "tube",
        "category": "TRANSPORT",
        "typicalValue": {
          "min": 1.5,
          "max": 15,
          "typical": 5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "bike",
        "category": "TRANSPORT",
        "typicalValue": {
          "min": 1.5,
          "max": 15,
          "typical": 5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      }
    ],
    "culturalElements": [
      {
        "type": "currency",
        "value": "£",
        "explanation": "British pounds for transport fares"
      }
    ],
    "realWorldConnection": "Calculating travel costs and distances",
    "yearAppropriate": [
      3
    ],
    "templates": [
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "MULTI_STEP"
        ],
        "template": "A {transport} journey costs {price}. How much for {quantity} journeys?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "transport",
            "type": "item"
          },
          {
            "key": "price",
            "type": "value"
          },
          {
            "key": "quantity",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      }
    ]
  }
}
# Test E.8: COLLECTIONS theme
{
  "success": true,
  "question": {
    "text": "Elizabeth has sticker, card, coin, stamp, badge, marble, button in their collection. How many altogether?",
    "options": [
      {
        "text": "48",
        "value": 48,
        "index": 0
      },
      {
        "text": "27",
        "value": 27,
        "index": 1
      },
      {
        "text": "26",
        "value": 26,
        "index": 2
      },
      {
        "text": "38",
        "value": 38,
        "index": 3
      }
    ],
    "correctIndex": 3,
    "format": "DIRECT_CALCULATION",
    "difficulty": {
      "year": 3,
      "subLevel": 1,
      "displayName": "3.1",
      "cognitiveLoad": 30
    },
    "cognitiveLoad": 30,
    "curriculumTags": [
      "3N1a",
      "3N1b"
    ],
    "scenario": {
      "id": "collections-3-1759232463097",
      "theme": "COLLECTIONS",
      "setting": {
        "location": "bedroom",
        "timeContext": "organizing collection",
        "atmosphere": "focused"
      },
      "characters": [
        {
          "name": "Elizabeth",
          "role": "collector"
        },
        {
          "name": "Elijah",
          "role": "friend"
        }
      ],
      "items": [
        {
          "name": "sticker",
          "category": "COLLECTIBLES",
          "typicalValue": {
            "min": 1,
            "max": 50,
            "typical": 10,
            "distribution": "normal"
          },
          "unit": "items",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "card",
          "category": "COLLECTIBLES",
          "typicalValue": {
            "min": 1,
            "max": 50,
            "typical": 10,
            "distribution": "normal"
          },
          "unit": "items",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "coin",
          "category": "COLLECTIBLES",
          "typicalValue": {
            "min": 1,
            "max": 50,
            "typical": 10,
            "distribution": "normal"
          },
          "unit": "items",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "stamp",
          "category": "COLLECTIBLES",
          "typicalValue": {
            "min": 1,
            "max": 50,
            "typical": 10,
            "distribution": "normal"
          },
          "unit": "items",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "badge",
          "category": "COLLECTIBLES",
          "typicalValue": {
            "min": 1,
            "max": 50,
            "typical": 10,
            "distribution": "normal"
          },
          "unit": "items",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "marble",
          "category": "COLLECTIBLES",
          "typicalValue": {
            "min": 1,
            "max": 50,
            "typical": 10,
            "distribution": "normal"
          },
          "unit": "items",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "button",
          "category": "COLLECTIBLES",
          "typicalValue": {
            "min": 1,
            "max": 50,
            "typical": 10,
            "distribution": "normal"
          },
          "unit": "items",
          "attributes": {
            "quality": "standard"
          }
        }
      ],
      "culturalElements": [
        {
          "type": "hobby",
          "value": "collecting",
          "explanation": "Popular childhood hobby"
        }
      ],
      "realWorldConnection": "Organizing and counting collections",
      "yearAppropriate": [
        3
      ],
      "templates": [
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "ORDERING"
          ],
          "template": "{character} has {items} in their collection. How many altogether?",
          "answerTemplate": "{character} has {result} items total",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        }
      ]
    },
    "distractors": [
      {
        "value": 26,
        "displayText": "26",
        "strategy": "WRONG_OPERATION",
        "reasoning": "Multiplied instead of adding"
      },
      {
        "value": 48,
        "displayText": "48",
        "strategy": "PLACE_VALUE_ERROR",
        "reasoning": "Error in carrying to next column"
      },
      {
        "value": 27,
        "displayText": "27",
        "strategy": "PARTIAL_CALCULATION",
        "reasoning": "Stopped calculation early"
      }
    ],
    "enhancementStatus": {
      "level": "partial",
      "requestedFormat": "DIRECT_CALCULATION",
      "actualFormat": "DIRECT_CALCULATION",
      "featuresActive": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "featuresPending": [],
      "isFullyEnhanced": true
    },
    "mathOutput": {
      "operation": "ADDITION",
      "operand_1": 1,
      "operand_2": 26,
      "operand_3": 11,
      "result": 38
    },
    "generationTime": 1,
    "questionId": "q_1759232463097_duie0wnc9",
    "generationSetup": {
      "controller_used": "DIRECT_CALCULATIONController",
      "format_requested": "DIRECT_CALCULATION",
      "format_actual": "DIRECT_CALCULATION",
      "scenario_theme": "COLLECTIONS",
      "scenario_id": "collections-3-1759232463097",
      "scenario_selection_method": "requested",
      "distractor_strategies": [
        "WRONG_OPERATION",
        "PLACE_VALUE_ERROR",
        "PARTIAL_CALCULATION"
      ],
      "distractor_count": 3,
      "theme_variety": false,
      "format_variety": false,
      "enhancement_level": "partial",
      "features_active": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "features_pending": [],
      "generation_time_ms": 1
    }
  },
  "metadata": {
    "format": "DIRECT_CALCULATION",
    "cognitive_load": 30,
    "curriculum_alignment": [
      "3N1a",
      "3N1b"
    ],
    "difficulty": "3.1",
    "scenario_theme": "COLLECTIONS",
    "distractor_strategies": [
      "WRONG_OPERATION",
      "PLACE_VALUE_ERROR",
      "PARTIAL_CALCULATION"
    ],
    "generation_time_ms": 1,
    "api_version": "2.0",
    "enhancement_status": "partial",
    "format_requested": "DIRECT_CALCULATION",
    "format_used": "DIRECT_CALCULATION",
    "features_active": [
      "enhanced_distractors",
      "rich_scenarios",
      "cognitive_load",
      "advanced_formats"
    ],
    "features_pending": []
  },
  "context": {
    "id": "collections-3-1759232463097",
    "theme": "COLLECTIONS",
    "setting": {
      "location": "bedroom",
      "timeContext": "organizing collection",
      "atmosphere": "focused"
    },
    "characters": [
      {
        "name": "Elizabeth",
        "role": "collector"
      },
      {
        "name": "Elijah",
        "role": "friend"
      }
    ],
    "items": [
      {
        "name": "sticker",
        "category": "COLLECTIBLES",
        "typicalValue": {
          "min": 1,
          "max": 50,
          "typical": 10,
          "distribution": "normal"
        },
        "unit": "items",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "card",
        "category": "COLLECTIBLES",
        "typicalValue": {
          "min": 1,
          "max": 50,
          "typical": 10,
          "distribution": "normal"
        },
        "unit": "items",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "coin",
        "category": "COLLECTIBLES",
        "typicalValue": {
          "min": 1,
          "max": 50,
          "typical": 10,
          "distribution": "normal"
        },
        "unit": "items",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "stamp",
        "category": "COLLECTIBLES",
        "typicalValue": {
          "min": 1,
          "max": 50,
          "typical": 10,
          "distribution": "normal"
        },
        "unit": "items",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "badge",
        "category": "COLLECTIBLES",
        "typicalValue": {
          "min": 1,
          "max": 50,
          "typical": 10,
          "distribution": "normal"
        },
        "unit": "items",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "marble",
        "category": "COLLECTIBLES",
        "typicalValue": {
          "min": 1,
          "max": 50,
          "typical": 10,
          "distribution": "normal"
        },
        "unit": "items",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "button",
        "category": "COLLECTIBLES",
        "typicalValue": {
          "min": 1,
          "max": 50,
          "typical": 10,
          "distribution": "normal"
        },
        "unit": "items",
        "attributes": {
          "quality": "standard"
        }
      }
    ],
    "culturalElements": [
      {
        "type": "hobby",
        "value": "collecting",
        "explanation": "Popular childhood hobby"
      }
    ],
    "realWorldConnection": "Organizing and counting collections",
    "yearAppropriate": [
      3
    ],
    "templates": [
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "ORDERING"
        ],
        "template": "{character} has {items} in their collection. How many altogether?",
        "answerTemplate": "{character} has {result} items total",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      }
    ]
  }
}
# Test E.9: HOUSEHOLD theme
{
  "success": true,
  "question": {
    "text": "Ava needs to tidy cup, plate, spoon, towel, pillow, book, toy, sock. How many items to put away?",
    "options": [
      {
        "text": "10",
        "value": 10,
        "index": 0
      },
      {
        "text": "58",
        "value": 58,
        "index": 1
      },
      {
        "text": "96",
        "value": 96,
        "index": 2
      },
      {
        "text": "48",
        "value": 48,
        "index": 3
      }
    ],
    "correctIndex": 3,
    "format": "DIRECT_CALCULATION",
    "difficulty": {
      "year": 3,
      "subLevel": 1,
      "displayName": "3.1",
      "cognitiveLoad": 30
    },
    "cognitiveLoad": 30,
    "curriculumTags": [
      "3N1a",
      "3N1b"
    ],
    "scenario": {
      "id": "household-3-1759232463139",
      "theme": "HOUSEHOLD",
      "setting": {
        "location": "living room",
        "timeContext": "tidying up",
        "atmosphere": "homely"
      },
      "characters": [
        {
          "name": "Ava",
          "role": "child"
        },
        {
          "name": "Mum",
          "role": "parent"
        }
      ],
      "items": [
        {
          "name": "cup",
          "category": "HOUSEHOLD_ITEMS",
          "typicalValue": {
            "min": 1,
            "max": 30,
            "typical": 8,
            "distribution": "normal"
          },
          "unit": "items",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "plate",
          "category": "HOUSEHOLD_ITEMS",
          "typicalValue": {
            "min": 1,
            "max": 30,
            "typical": 8,
            "distribution": "normal"
          },
          "unit": "items",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "spoon",
          "category": "HOUSEHOLD_ITEMS",
          "typicalValue": {
            "min": 1,
            "max": 30,
            "typical": 8,
            "distribution": "normal"
          },
          "unit": "items",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "towel",
          "category": "HOUSEHOLD_ITEMS",
          "typicalValue": {
            "min": 1,
            "max": 30,
            "typical": 8,
            "distribution": "normal"
          },
          "unit": "items",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "pillow",
          "category": "HOUSEHOLD_ITEMS",
          "typicalValue": {
            "min": 1,
            "max": 30,
            "typical": 8,
            "distribution": "normal"
          },
          "unit": "items",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "book",
          "category": "HOUSEHOLD_ITEMS",
          "typicalValue": {
            "min": 1,
            "max": 30,
            "typical": 8,
            "distribution": "normal"
          },
          "unit": "items",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "toy",
          "category": "HOUSEHOLD_ITEMS",
          "typicalValue": {
            "min": 1,
            "max": 30,
            "typical": 8,
            "distribution": "normal"
          },
          "unit": "items",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "sock",
          "category": "HOUSEHOLD_ITEMS",
          "typicalValue": {
            "min": 1,
            "max": 30,
            "typical": 8,
            "distribution": "normal"
          },
          "unit": "items",
          "attributes": {
            "quality": "standard"
          }
        }
      ],
      "culturalElements": [
        {
          "type": "custom",
          "value": "household chores",
          "explanation": "Daily home activities"
        }
      ],
      "realWorldConnection": "Organizing and counting household items",
      "yearAppropriate": [
        3
      ],
      "templates": [
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "COMPARISON"
          ],
          "template": "{character} needs to tidy {items}. How many items to put away?",
          "answerTemplate": "{character} needs to put away {result} items",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "items",
              "type": "item"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        }
      ]
    },
    "distractors": [
      {
        "value": 10,
        "displayText": "10",
        "strategy": "WRONG_OPERATION",
        "reasoning": "Subtracted instead of adding"
      },
      {
        "value": 96,
        "displayText": "96",
        "strategy": "WRONG_OPERATION",
        "reasoning": "Multiplied instead of adding"
      },
      {
        "value": 58,
        "displayText": "58",
        "strategy": "PLACE_VALUE_ERROR",
        "reasoning": "Error in carrying to next column"
      }
    ],
    "enhancementStatus": {
      "level": "partial",
      "requestedFormat": "DIRECT_CALCULATION",
      "actualFormat": "DIRECT_CALCULATION",
      "featuresActive": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "featuresPending": [],
      "isFullyEnhanced": true
    },
    "mathOutput": {
      "operation": "ADDITION",
      "operand_1": 16,
      "operand_2": 6,
      "operand_3": 26,
      "result": 48
    },
    "generationTime": 1,
    "questionId": "q_1759232463139_xlidica5i",
    "generationSetup": {
      "controller_used": "DIRECT_CALCULATIONController",
      "format_requested": "DIRECT_CALCULATION",
      "format_actual": "DIRECT_CALCULATION",
      "scenario_theme": "HOUSEHOLD",
      "scenario_id": "household-3-1759232463139",
      "scenario_selection_method": "requested",
      "distractor_strategies": [
        "WRONG_OPERATION",
        "WRONG_OPERATION",
        "PLACE_VALUE_ERROR"
      ],
      "distractor_count": 3,
      "theme_variety": false,
      "format_variety": false,
      "enhancement_level": "partial",
      "features_active": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "features_pending": [],
      "generation_time_ms": 1
    }
  },
  "metadata": {
    "format": "DIRECT_CALCULATION",
    "cognitive_load": 30,
    "curriculum_alignment": [
      "3N1a",
      "3N1b"
    ],
    "difficulty": "3.1",
    "scenario_theme": "HOUSEHOLD",
    "distractor_strategies": [
      "WRONG_OPERATION",
      "WRONG_OPERATION",
      "PLACE_VALUE_ERROR"
    ],
    "generation_time_ms": 1,
    "api_version": "2.0",
    "enhancement_status": "partial",
    "format_requested": "DIRECT_CALCULATION",
    "format_used": "DIRECT_CALCULATION",
    "features_active": [
      "enhanced_distractors",
      "rich_scenarios",
      "cognitive_load",
      "advanced_formats"
    ],
    "features_pending": []
  },
  "context": {
    "id": "household-3-1759232463139",
    "theme": "HOUSEHOLD",
    "setting": {
      "location": "living room",
      "timeContext": "tidying up",
      "atmosphere": "homely"
    },
    "characters": [
      {
        "name": "Ava",
        "role": "child"
      },
      {
        "name": "Mum",
        "role": "parent"
      }
    ],
    "items": [
      {
        "name": "cup",
        "category": "HOUSEHOLD_ITEMS",
        "typicalValue": {
          "min": 1,
          "max": 30,
          "typical": 8,
          "distribution": "normal"
        },
        "unit": "items",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "plate",
        "category": "HOUSEHOLD_ITEMS",
        "typicalValue": {
          "min": 1,
          "max": 30,
          "typical": 8,
          "distribution": "normal"
        },
        "unit": "items",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "spoon",
        "category": "HOUSEHOLD_ITEMS",
        "typicalValue": {
          "min": 1,
          "max": 30,
          "typical": 8,
          "distribution": "normal"
        },
        "unit": "items",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "towel",
        "category": "HOUSEHOLD_ITEMS",
        "typicalValue": {
          "min": 1,
          "max": 30,
          "typical": 8,
          "distribution": "normal"
        },
        "unit": "items",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "pillow",
        "category": "HOUSEHOLD_ITEMS",
        "typicalValue": {
          "min": 1,
          "max": 30,
          "typical": 8,
          "distribution": "normal"
        },
        "unit": "items",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "book",
        "category": "HOUSEHOLD_ITEMS",
        "typicalValue": {
          "min": 1,
          "max": 30,
          "typical": 8,
          "distribution": "normal"
        },
        "unit": "items",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "toy",
        "category": "HOUSEHOLD_ITEMS",
        "typicalValue": {
          "min": 1,
          "max": 30,
          "typical": 8,
          "distribution": "normal"
        },
        "unit": "items",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "sock",
        "category": "HOUSEHOLD_ITEMS",
        "typicalValue": {
          "min": 1,
          "max": 30,
          "typical": 8,
          "distribution": "normal"
        },
        "unit": "items",
        "attributes": {
          "quality": "standard"
        }
      }
    ],
    "culturalElements": [
      {
        "type": "custom",
        "value": "household chores",
        "explanation": "Daily home activities"
      }
    ],
    "realWorldConnection": "Organizing and counting household items",
    "yearAppropriate": [
      3
    ],
    "templates": [
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "COMPARISON"
        ],
        "template": "{character} needs to tidy {items}. How many items to put away?",
        "answerTemplate": "{character} needs to put away {result} items",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "items",
            "type": "item"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      }
    ]
  }
}
# Test E.10: CELEBRATIONS theme
{
  "success": true,
  "question": {
    "text": "Sophia is planning a {celebration}. The supplies cost £32.00, £8.00. What is the total?",
    "options": [
      {
        "text": "256",
        "value": 256,
        "index": 0
      },
      {
        "text": "24",
        "value": 24,
        "index": 1
      },
      {
        "text": "£71.00",
        "value": 71,
        "index": 2
      },
      {
        "text": "81",
        "value": 81,
        "index": 3
      }
    ],
    "correctIndex": 2,
    "format": "DIRECT_CALCULATION",
    "difficulty": {
      "year": 3,
      "subLevel": 1,
      "displayName": "3.1",
      "cognitiveLoad": 30
    },
    "cognitiveLoad": 30,
    "curriculumTags": [
      "3N1a",
      "3N1b"
    ],
    "scenario": {
      "id": "celebrations-3-1759232463196",
      "theme": "CELEBRATIONS",
      "setting": {
        "location": "party venue",
        "timeContext": "celebration planning",
        "atmosphere": "festive"
      },
      "characters": [
        {
          "name": "Sophia",
          "role": "party organizer"
        },
        {
          "name": "Amelia",
          "role": "guest"
        }
      ],
      "items": [
        {
          "name": "balloon",
          "category": "PARTY_SUPPLIES",
          "typicalValue": {
            "min": 0.5,
            "max": 20,
            "typical": 5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "cake",
          "category": "PARTY_SUPPLIES",
          "typicalValue": {
            "min": 0.5,
            "max": 20,
            "typical": 5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "present",
          "category": "PARTY_SUPPLIES",
          "typicalValue": {
            "min": 0.5,
            "max": 20,
            "typical": 5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "decoration",
          "category": "PARTY_SUPPLIES",
          "typicalValue": {
            "min": 0.5,
            "max": 20,
            "typical": 5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "party hat",
          "category": "PARTY_SUPPLIES",
          "typicalValue": {
            "min": 0.5,
            "max": 20,
            "typical": 5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        },
        {
          "name": "candle",
          "category": "PARTY_SUPPLIES",
          "typicalValue": {
            "min": 0.5,
            "max": 20,
            "typical": 5,
            "distribution": "normal"
          },
          "unit": "£",
          "attributes": {
            "quality": "standard"
          }
        }
      ],
      "culturalElements": [
        {
          "type": "currency",
          "value": "£",
          "explanation": "British pounds for party supplies"
        },
        {
          "type": "event",
          "value": "celebration",
          "explanation": "Special occasions and festivals"
        }
      ],
      "realWorldConnection": "Planning and budgeting for celebrations",
      "yearAppropriate": [
        3
      ],
      "templates": [
        {
          "formatCompatibility": [
            "DIRECT_CALCULATION",
            "MULTI_STEP"
          ],
          "template": "{character} is planning a {celebration}. The supplies cost {prices}. What is the total?",
          "answerTemplate": "The total cost is {result}",
          "placeholders": [
            {
              "key": "character",
              "type": "character"
            },
            {
              "key": "celebration",
              "type": "event"
            },
            {
              "key": "prices",
              "type": "value"
            },
            {
              "key": "result",
              "type": "value"
            }
          ]
        }
      ]
    },
    "distractors": [
      {
        "value": 24,
        "displayText": "24",
        "strategy": "WRONG_OPERATION",
        "reasoning": "Subtracted instead of adding"
      },
      {
        "value": 256,
        "displayText": "256",
        "strategy": "WRONG_OPERATION",
        "reasoning": "Multiplied instead of adding"
      },
      {
        "value": 81,
        "displayText": "81",
        "strategy": "PLACE_VALUE_ERROR",
        "reasoning": "Error in carrying to next column"
      }
    ],
    "enhancementStatus": {
      "level": "partial",
      "requestedFormat": "DIRECT_CALCULATION",
      "actualFormat": "DIRECT_CALCULATION",
      "featuresActive": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "featuresPending": [],
      "isFullyEnhanced": true
    },
    "mathOutput": {
      "operation": "ADDITION",
      "operand_1": 32,
      "operand_2": 8,
      "operand_3": 31,
      "result": 71
    },
    "generationTime": 1,
    "questionId": "q_1759232463196_hpvraaq1y",
    "generationSetup": {
      "controller_used": "DIRECT_CALCULATIONController",
      "format_requested": "DIRECT_CALCULATION",
      "format_actual": "DIRECT_CALCULATION",
      "scenario_theme": "CELEBRATIONS",
      "scenario_id": "celebrations-3-1759232463196",
      "scenario_selection_method": "requested",
      "distractor_strategies": [
        "WRONG_OPERATION",
        "WRONG_OPERATION",
        "PLACE_VALUE_ERROR"
      ],
      "distractor_count": 3,
      "theme_variety": false,
      "format_variety": false,
      "enhancement_level": "partial",
      "features_active": [
        "enhanced_distractors",
        "rich_scenarios",
        "cognitive_load",
        "advanced_formats"
      ],
      "features_pending": [],
      "generation_time_ms": 1
    }
  },
  "metadata": {
    "format": "DIRECT_CALCULATION",
    "cognitive_load": 30,
    "curriculum_alignment": [
      "3N1a",
      "3N1b"
    ],
    "difficulty": "3.1",
    "scenario_theme": "CELEBRATIONS",
    "distractor_strategies": [
      "WRONG_OPERATION",
      "WRONG_OPERATION",
      "PLACE_VALUE_ERROR"
    ],
    "generation_time_ms": 1,
    "api_version": "2.0",
    "enhancement_status": "partial",
    "format_requested": "DIRECT_CALCULATION",
    "format_used": "DIRECT_CALCULATION",
    "features_active": [
      "enhanced_distractors",
      "rich_scenarios",
      "cognitive_load",
      "advanced_formats"
    ],
    "features_pending": []
  },
  "context": {
    "id": "celebrations-3-1759232463196",
    "theme": "CELEBRATIONS",
    "setting": {
      "location": "party venue",
      "timeContext": "celebration planning",
      "atmosphere": "festive"
    },
    "characters": [
      {
        "name": "Sophia",
        "role": "party organizer"
      },
      {
        "name": "Amelia",
        "role": "guest"
      }
    ],
    "items": [
      {
        "name": "balloon",
        "category": "PARTY_SUPPLIES",
        "typicalValue": {
          "min": 0.5,
          "max": 20,
          "typical": 5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "cake",
        "category": "PARTY_SUPPLIES",
        "typicalValue": {
          "min": 0.5,
          "max": 20,
          "typical": 5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "present",
        "category": "PARTY_SUPPLIES",
        "typicalValue": {
          "min": 0.5,
          "max": 20,
          "typical": 5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "decoration",
        "category": "PARTY_SUPPLIES",
        "typicalValue": {
          "min": 0.5,
          "max": 20,
          "typical": 5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "party hat",
        "category": "PARTY_SUPPLIES",
        "typicalValue": {
          "min": 0.5,
          "max": 20,
          "typical": 5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      },
      {
        "name": "candle",
        "category": "PARTY_SUPPLIES",
        "typicalValue": {
          "min": 0.5,
          "max": 20,
          "typical": 5,
          "distribution": "normal"
        },
        "unit": "£",
        "attributes": {
          "quality": "standard"
        }
      }
    ],
    "culturalElements": [
      {
        "type": "currency",
        "value": "£",
        "explanation": "British pounds for party supplies"
      },
      {
        "type": "event",
        "value": "celebration",
        "explanation": "Special occasions and festivals"
      }
    ],
    "realWorldConnection": "Planning and budgeting for celebrations",
    "yearAppropriate": [
      3
    ],
    "templates": [
      {
        "formatCompatibility": [
          "DIRECT_CALCULATION",
          "MULTI_STEP"
        ],
        "template": "{character} is planning a {celebration}. The supplies cost {prices}. What is the total?",
        "answerTemplate": "The total cost is {result}",
        "placeholders": [
          {
            "key": "character",
            "type": "character"
          },
          {
            "key": "celebration",
            "type": "event"
          },
          {
            "key": "prices",
            "type": "value"
          },
          {
            "key": "result",
            "type": "value"
          }
        ]
      }
    ]
  }
}

--- SUITE F: EDGE CASE AND ERROR HANDLING TESTS ---
Testing invalid inputs and expected error responses...
# Test F.1: Request with a non-existent model_id
{
  "error": "Unsupported model_id: FOOBAR. Supported models: ADDITION, SUBTRACTION, MULTIPLICATION, DIVISION, PERCENTAGE, FRACTION, COUNTING, TIME_RATE, CONVERSION, COMPARISON, MULTI_STEP, LINEAR_EQUATION, UNIT_RATE, COIN_RECOGNITION, CHANGE_CALCULATION, MONEY_COMBINATIONS, MIXED_MONEY_UNITS, MONEY_FRACTIONS, MONEY_SCALING, SHAPE_RECOGNITION, SHAPE_PROPERTIES, ANGLE_MEASUREMENT, POSITION_DIRECTION, AREA_PERIMETER"
}
# Test F.2: Request with an invalid difficulty_level
{
  "error": "difficulty_level must be X.Y where X=1-6 and Y=1-4"
}
# Test F.3: Request with an invalid format_preference
{
  "error": "Invalid format_preference. Valid options: DIRECT_CALCULATION, COMPARISON, ESTIMATION, ORDERING, VALIDATION, MULTI_STEP, MISSING_VALUE, PATTERN_RECOGNITION"
}
# Test F.4: Request with a dedicated broken model (TEST_BROKEN)
{
  "error": "Unsupported model_id: TEST_BROKEN. Supported models: ADDITION, SUBTRACTION, MULTIPLICATION, DIVISION, PERCENTAGE, FRACTION, COUNTING, TIME_RATE, CONVERSION, COMPARISON, MULTI_STEP, LINEAR_EQUATION, UNIT_RATE, COIN_RECOGNITION, CHANGE_CALCULATION, MONEY_COMBINATIONS, MIXED_MONEY_UNITS, MONEY_FRACTIONS, MONEY_SCALING, SHAPE_RECOGNITION, SHAPE_PROPERTIES, ANGLE_MEASUREMENT, POSITION_DIRECTION, AREA_PERIMETER"
}
# Test F.5: Request with a quantity greater than 20
{
  "error": "quantity must be between 1 and 20"
}
# Test F.6: Request missing the required model_id field
{
  "error": "model_id is required"
}

--- SUITE G: BATCH GENERATION TESTS ---
Testing the ability to generate multiple questions in one request...
# Test G.1: Request a batch of 5 questions
{
  "success": true,
  "questions": [
    {
      "text": "Logan buys an apple for 24p and pays with £2. How much change does Logan get?",
      "options": [
        {
          "text": "0.76",
          "value": 0.76,
          "index": 0
        },
        {
          "text": "3.76",
          "value": 3.76,
          "index": 1
        },
        {
          "text": "67",
          "value": 67,
          "index": 2
        },
        {
          "text": "£1.76",
          "value": 1.76,
          "index": 3
        }
      ],
      "correctIndex": 3,
      "format": "DIRECT_CALCULATION",
      "difficulty": {
        "year": 3,
        "subLevel": 3,
        "displayName": "3.3",
        "cognitiveLoad": 40
      },
      "cognitiveLoad": 40,
      "curriculumTags": [
        "3N1c",
        "3N1d"
      ],
      "scenario": {
        "id": "shop-002-realistic-general",
        "theme": "SHOPPING",
        "setting": {
          "location": "local shop",
          "timeContext": "after school",
          "atmosphere": "friendly"
        },
        "characters": [
          {
            "name": "Logan",
            "role": "student"
          }
        ],
        "items": [
          {
            "name": "apple",
            "category": "FOOD_DRINK",
            "typicalValue": {
              "min": 0.2,
              "max": 0.5,
              "typical": 0.35,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "banana",
            "category": "FOOD_DRINK",
            "typicalValue": {
              "min": 0.15,
              "max": 0.4,
              "typical": 0.25,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "sandwich",
            "category": "FOOD_DRINK",
            "typicalValue": {
              "min": 2.5,
              "max": 6,
              "typical": 4,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "drink",
            "category": "FOOD_DRINK",
            "typicalValue": {
              "min": 0.8,
              "max": 2.5,
              "typical": 1.5,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "cake",
            "category": "FOOD_DRINK",
            "typicalValue": {
              "min": 1.5,
              "max": 4,
              "typical": 2.5,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "biscuit",
            "category": "FOOD_DRINK",
            "typicalValue": {
              "min": 0.8,
              "max": 2,
              "typical": 1.2,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "sweet",
            "category": "FOOD_DRINK",
            "typicalValue": {
              "min": 0.1,
              "max": 1,
              "typical": 0.5,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "chocolate",
            "category": "FOOD_DRINK",
            "typicalValue": {
              "min": 0.6,
              "max": 3,
              "typical": 1.5,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "pen",
            "category": "SCHOOL_SUPPLIES",
            "typicalValue": {
              "min": 0.5,
              "max": 2,
              "typical": 1,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "pencil",
            "category": "SCHOOL_SUPPLIES",
            "typicalValue": {
              "min": 0.2,
              "max": 1,
              "typical": 0.5,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "ruler",
            "category": "SCHOOL_SUPPLIES",
            "typicalValue": {
              "min": 0.8,
              "max": 2.5,
              "typical": 1.5,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "notebook",
            "category": "SCHOOL_SUPPLIES",
            "typicalValue": {
              "min": 1,
              "max": 4,
              "typical": 2,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "eraser",
            "category": "SCHOOL_SUPPLIES",
            "typicalValue": {
              "min": 0.3,
              "max": 1.5,
              "typical": 0.75,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "book",
            "category": "BOOKS_MEDIA",
            "typicalValue": {
              "min": 3,
              "max": 15,
              "typical": 8,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "comic",
            "category": "BOOKS_MEDIA",
            "typicalValue": {
              "min": 2,
              "max": 5,
              "typical": 3,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "magazine",
            "category": "BOOKS_MEDIA",
            "typicalValue": {
              "min": 2.5,
              "max": 6,
              "typical": 4,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "toy",
            "category": "TOYS_GAMES",
            "typicalValue": {
              "min": 5,
              "max": 25,
              "typical": 12,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "game",
            "category": "TOYS_GAMES",
            "typicalValue": {
              "min": 8,
              "max": 60,
              "typical": 25,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "puzzle",
            "category": "TOYS_GAMES",
            "typicalValue": {
              "min": 5,
              "max": 20,
              "typical": 12,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "sticker",
            "category": "TOYS_GAMES",
            "typicalValue": {
              "min": 0.2,
              "max": 2,
              "typical": 0.8,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "badge",
            "category": "TOYS_GAMES",
            "typicalValue": {
              "min": 0.5,
              "max": 3,
              "typical": 1.5,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "poster",
            "category": "BOOKS_MEDIA",
            "typicalValue": {
              "min": 2,
              "max": 8,
              "typical": 4,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "card",
            "category": "BOOKS_MEDIA",
            "typicalValue": {
              "min": 0.5,
              "max": 4,
              "typical": 2,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          }
        ],
        "culturalElements": [
          {
            "type": "currency",
            "value": "£",
            "explanation": "British pounds"
          },
          {
            "type": "location",
            "value": "UK local shop",
            "explanation": "Typical British corner shop"
          }
        ],
        "realWorldConnection": "Everyday shopping with realistic UK prices",
        "yearAppropriate": [
          1,
          2,
          3,
          4,
          5,
          6
        ],
        "templates": [
          {
            "formatCompatibility": [
              "DIRECT_CALCULATION",
              "MULTI_STEP"
            ],
            "modelCompatibility": [
              "ADDITION"
            ],
            "operandCount": 3,
            "template": "{character} buys {article1} {item1} for {price1}, {article2} {item2} for {price2}, and {article3} {item3} for {price3}. What is the total cost?",
            "answerTemplate": "The total cost is {result}",
            "placeholders": [
              {
                "key": "character",
                "type": "character"
              },
              {
                "key": "item1",
                "type": "item"
              },
              {
                "key": "item2",
                "type": "item"
              },
              {
                "key": "item3",
                "type": "item"
              },
              {
                "key": "price1",
                "type": "value"
              },
              {
                "key": "price2",
                "type": "value"
              },
              {
                "key": "price3",
                "type": "value"
              },
              {
                "key": "result",
                "type": "value"
              }
            ]
          },
          {
            "formatCompatibility": [
              "DIRECT_CALCULATION",
              "MULTI_STEP"
            ],
            "modelCompatibility": [
              "ADDITION"
            ],
            "operandCount": 2,
            "template": "{character} buys {article1} {item1} for {price1} and {article2} {item2} for {price2}. What is the total cost?",
            "answerTemplate": "The total cost is {result}",
            "placeholders": [
              {
                "key": "character",
                "type": "character"
              },
              {
                "key": "item1",
                "type": "item"
              },
              {
                "key": "item2",
                "type": "item"
              },
              {
                "key": "price1",
                "type": "value"
              },
              {
                "key": "price2",
                "type": "value"
              },
              {
                "key": "result",
                "type": "value"
              }
            ]
          },
          {
            "formatCompatibility": [
              "DIRECT_CALCULATION"
            ],
            "modelCompatibility": [
              "SUBTRACTION",
              "CHANGE_CALCULATION"
            ],
            "template": "{character} buys {article} {item} for {price} and pays with {payment}. How much change does {character} get?",
            "answerTemplate": "{character} receives {result} in change",
            "placeholders": [
              {
                "key": "character",
                "type": "character"
              },
              {
                "key": "item",
                "type": "item"
              },
              {
                "key": "price",
                "type": "value"
              },
              {
                "key": "payment",
                "type": "value"
              },
              {
                "key": "result",
                "type": "value"
              }
            ]
          },
          {
            "formatCompatibility": [
              "DIRECT_CALCULATION"
            ],
            "modelCompatibility": [
              "MULTIPLICATION"
            ],
            "template": "{character} buys {quantity} {item} at {price} each. What is the total cost?",
            "answerTemplate": "The total cost is {result}",
            "placeholders": [
              {
                "key": "character",
                "type": "character"
              },
              {
                "key": "quantity",
                "type": "value"
              },
              {
                "key": "item",
                "type": "item"
              },
              {
                "key": "price",
                "type": "value"
              },
              {
                "key": "result",
                "type": "value"
              }
            ]
          },
          {
            "formatCompatibility": [
              "DIRECT_CALCULATION"
            ],
            "modelCompatibility": [
              "DIVISION"
            ],
            "template": "{character} has {total} to spend equally on {quantity} {item}. How much can {character} spend on each one?",
            "answerTemplate": "{character} can spend {result} on each {item}",
            "placeholders": [
              {
                "key": "character",
                "type": "character"
              },
              {
                "key": "total",
                "type": "value"
              },
              {
                "key": "quantity",
                "type": "value"
              },
              {
                "key": "item",
                "type": "item"
              },
              {
                "key": "result",
                "type": "value"
              }
            ]
          },
          {
            "formatCompatibility": [
              "DIRECT_CALCULATION",
              "COMPARISON",
              "ESTIMATION",
              "MULTI_STEP"
            ],
            "template": "{character} goes to the shop and buys {items}. How much does {character} spend in total?",
            "answerTemplate": "{character} spends {result} in total",
            "placeholders": [
              {
                "key": "character",
                "type": "character"
              },
              {
                "key": "items",
                "type": "item_list"
              },
              {
                "key": "result",
                "type": "value"
              }
            ]
          },
          {
            "formatCompatibility": [
              "ESTIMATION"
            ],
            "template": "Estimate: If {character} buys {items}, about how much will it cost?",
            "answerTemplate": "It will cost approximately {result}",
            "placeholders": [
              {
                "key": "character",
                "type": "character"
              },
              {
                "key": "items",
                "type": "item_list"
              },
              {
                "key": "result",
                "type": "value"
              }
            ]
          },
          {
            "formatCompatibility": [
              "VALIDATION"
            ],
            "template": "{character} calculated that {items} costs {amount}. Is this correct?",
            "answerTemplate": "{validation_result}",
            "placeholders": [
              {
                "key": "character",
                "type": "character"
              },
              {
                "key": "items",
                "type": "item_list"
              },
              {
                "key": "amount",
                "type": "value"
              },
              {
                "key": "validation_result",
                "type": "boolean"
              }
            ]
          }
        ]
      },
      "distractors": [
        {
          "value": 67,
          "displayText": "67",
          "strategy": "WRONG_OPERATION",
          "reasoning": "Added instead of subtracting"
        },
        {
          "value": 0.76,
          "displayText": "0.76",
          "strategy": "CLOSE_VALUE",
          "reasoning": "Off by 1"
        },
        {
          "value": 3.76,
          "displayText": "3.76",
          "strategy": "CLOSE_VALUE",
          "reasoning": "Off by 2"
        }
      ],
      "enhancementStatus": {
        "level": "partial",
        "requestedFormat": "DIRECT_CALCULATION",
        "actualFormat": "DIRECT_CALCULATION",
        "featuresActive": [
          "enhanced_distractors",
          "rich_scenarios",
          "cognitive_load",
          "advanced_formats"
        ],
        "featuresPending": [],
        "isFullyEnhanced": true
      },
      "mathOutput": {
        "operation": "SUBTRACTION",
        "subtrahend": 0.24,
        "minuend": 2,
        "result": 1.76
      },
      "generationTime": 0,
      "questionId": "q_1759232463521_20q3pqyzz",
      "generationSetup": {
        "controller_used": "DIRECT_CALCULATIONController",
        "format_requested": "DIRECT_CALCULATION",
        "format_actual": "DIRECT_CALCULATION",
        "scenario_theme": "SHOPPING",
        "scenario_id": "shop-002-realistic-general",
        "scenario_selection_method": "default",
        "distractor_strategies": [
          "WRONG_OPERATION",
          "CLOSE_VALUE",
          "CLOSE_VALUE"
        ],
        "distractor_count": 3,
        "theme_variety": false,
        "format_variety": false,
        "enhancement_level": "partial",
        "features_active": [
          "enhanced_distractors",
          "rich_scenarios",
          "cognitive_load",
          "advanced_formats"
        ],
        "features_pending": [],
        "generation_time_ms": 0
      }
    },
    {
      "text": "Logan buys an apple for 48p and pays with £2. How much change does Logan get?",
      "options": [
        {
          "text": "0.52",
          "value": 0.52,
          "index": 0
        },
        {
          "text": "2.52",
          "value": 2.52,
          "index": 1
        },
        {
          "text": "£1.52",
          "value": 1.52,
          "index": 2
        },
        {
          "text": "128",
          "value": 128,
          "index": 3
        }
      ],
      "correctIndex": 2,
      "format": "DIRECT_CALCULATION",
      "difficulty": {
        "year": 3,
        "subLevel": 3,
        "displayName": "3.3",
        "cognitiveLoad": 40
      },
      "cognitiveLoad": 40,
      "curriculumTags": [
        "3N1c",
        "3N1d"
      ],
      "scenario": {
        "id": "shop-002-realistic-general",
        "theme": "SHOPPING",
        "setting": {
          "location": "local shop",
          "timeContext": "after school",
          "atmosphere": "friendly"
        },
        "characters": [
          {
            "name": "Logan",
            "role": "student"
          }
        ],
        "items": [
          {
            "name": "apple",
            "category": "FOOD_DRINK",
            "typicalValue": {
              "min": 0.2,
              "max": 0.5,
              "typical": 0.35,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "banana",
            "category": "FOOD_DRINK",
            "typicalValue": {
              "min": 0.15,
              "max": 0.4,
              "typical": 0.25,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "sandwich",
            "category": "FOOD_DRINK",
            "typicalValue": {
              "min": 2.5,
              "max": 6,
              "typical": 4,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "drink",
            "category": "FOOD_DRINK",
            "typicalValue": {
              "min": 0.8,
              "max": 2.5,
              "typical": 1.5,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "cake",
            "category": "FOOD_DRINK",
            "typicalValue": {
              "min": 1.5,
              "max": 4,
              "typical": 2.5,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "biscuit",
            "category": "FOOD_DRINK",
            "typicalValue": {
              "min": 0.8,
              "max": 2,
              "typical": 1.2,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "sweet",
            "category": "FOOD_DRINK",
            "typicalValue": {
              "min": 0.1,
              "max": 1,
              "typical": 0.5,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "chocolate",
            "category": "FOOD_DRINK",
            "typicalValue": {
              "min": 0.6,
              "max": 3,
              "typical": 1.5,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "pen",
            "category": "SCHOOL_SUPPLIES",
            "typicalValue": {
              "min": 0.5,
              "max": 2,
              "typical": 1,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "pencil",
            "category": "SCHOOL_SUPPLIES",
            "typicalValue": {
              "min": 0.2,
              "max": 1,
              "typical": 0.5,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "ruler",
            "category": "SCHOOL_SUPPLIES",
            "typicalValue": {
              "min": 0.8,
              "max": 2.5,
              "typical": 1.5,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "notebook",
            "category": "SCHOOL_SUPPLIES",
            "typicalValue": {
              "min": 1,
              "max": 4,
              "typical": 2,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "eraser",
            "category": "SCHOOL_SUPPLIES",
            "typicalValue": {
              "min": 0.3,
              "max": 1.5,
              "typical": 0.75,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "book",
            "category": "BOOKS_MEDIA",
            "typicalValue": {
              "min": 3,
              "max": 15,
              "typical": 8,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "comic",
            "category": "BOOKS_MEDIA",
            "typicalValue": {
              "min": 2,
              "max": 5,
              "typical": 3,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "magazine",
            "category": "BOOKS_MEDIA",
            "typicalValue": {
              "min": 2.5,
              "max": 6,
              "typical": 4,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "toy",
            "category": "TOYS_GAMES",
            "typicalValue": {
              "min": 5,
              "max": 25,
              "typical": 12,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "game",
            "category": "TOYS_GAMES",
            "typicalValue": {
              "min": 8,
              "max": 60,
              "typical": 25,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "puzzle",
            "category": "TOYS_GAMES",
            "typicalValue": {
              "min": 5,
              "max": 20,
              "typical": 12,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "sticker",
            "category": "TOYS_GAMES",
            "typicalValue": {
              "min": 0.2,
              "max": 2,
              "typical": 0.8,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "badge",
            "category": "TOYS_GAMES",
            "typicalValue": {
              "min": 0.5,
              "max": 3,
              "typical": 1.5,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "poster",
            "category": "BOOKS_MEDIA",
            "typicalValue": {
              "min": 2,
              "max": 8,
              "typical": 4,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "card",
            "category": "BOOKS_MEDIA",
            "typicalValue": {
              "min": 0.5,
              "max": 4,
              "typical": 2,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          }
        ],
        "culturalElements": [
          {
            "type": "currency",
            "value": "£",
            "explanation": "British pounds"
          },
          {
            "type": "location",
            "value": "UK local shop",
            "explanation": "Typical British corner shop"
          }
        ],
        "realWorldConnection": "Everyday shopping with realistic UK prices",
        "yearAppropriate": [
          1,
          2,
          3,
          4,
          5,
          6
        ],
        "templates": [
          {
            "formatCompatibility": [
              "DIRECT_CALCULATION",
              "MULTI_STEP"
            ],
            "modelCompatibility": [
              "ADDITION"
            ],
            "operandCount": 3,
            "template": "{character} buys {article1} {item1} for {price1}, {article2} {item2} for {price2}, and {article3} {item3} for {price3}. What is the total cost?",
            "answerTemplate": "The total cost is {result}",
            "placeholders": [
              {
                "key": "character",
                "type": "character"
              },
              {
                "key": "item1",
                "type": "item"
              },
              {
                "key": "item2",
                "type": "item"
              },
              {
                "key": "item3",
                "type": "item"
              },
              {
                "key": "price1",
                "type": "value"
              },
              {
                "key": "price2",
                "type": "value"
              },
              {
                "key": "price3",
                "type": "value"
              },
              {
                "key": "result",
                "type": "value"
              }
            ]
          },
          {
            "formatCompatibility": [
              "DIRECT_CALCULATION",
              "MULTI_STEP"
            ],
            "modelCompatibility": [
              "ADDITION"
            ],
            "operandCount": 2,
            "template": "{character} buys {article1} {item1} for {price1} and {article2} {item2} for {price2}. What is the total cost?",
            "answerTemplate": "The total cost is {result}",
            "placeholders": [
              {
                "key": "character",
                "type": "character"
              },
              {
                "key": "item1",
                "type": "item"
              },
              {
                "key": "item2",
                "type": "item"
              },
              {
                "key": "price1",
                "type": "value"
              },
              {
                "key": "price2",
                "type": "value"
              },
              {
                "key": "result",
                "type": "value"
              }
            ]
          },
          {
            "formatCompatibility": [
              "DIRECT_CALCULATION"
            ],
            "modelCompatibility": [
              "SUBTRACTION",
              "CHANGE_CALCULATION"
            ],
            "template": "{character} buys {article} {item} for {price} and pays with {payment}. How much change does {character} get?",
            "answerTemplate": "{character} receives {result} in change",
            "placeholders": [
              {
                "key": "character",
                "type": "character"
              },
              {
                "key": "item",
                "type": "item"
              },
              {
                "key": "price",
                "type": "value"
              },
              {
                "key": "payment",
                "type": "value"
              },
              {
                "key": "result",
                "type": "value"
              }
            ]
          },
          {
            "formatCompatibility": [
              "DIRECT_CALCULATION"
            ],
            "modelCompatibility": [
              "MULTIPLICATION"
            ],
            "template": "{character} buys {quantity} {item} at {price} each. What is the total cost?",
            "answerTemplate": "The total cost is {result}",
            "placeholders": [
              {
                "key": "character",
                "type": "character"
              },
              {
                "key": "quantity",
                "type": "value"
              },
              {
                "key": "item",
                "type": "item"
              },
              {
                "key": "price",
                "type": "value"
              },
              {
                "key": "result",
                "type": "value"
              }
            ]
          },
          {
            "formatCompatibility": [
              "DIRECT_CALCULATION"
            ],
            "modelCompatibility": [
              "DIVISION"
            ],
            "template": "{character} has {total} to spend equally on {quantity} {item}. How much can {character} spend on each one?",
            "answerTemplate": "{character} can spend {result} on each {item}",
            "placeholders": [
              {
                "key": "character",
                "type": "character"
              },
              {
                "key": "total",
                "type": "value"
              },
              {
                "key": "quantity",
                "type": "value"
              },
              {
                "key": "item",
                "type": "item"
              },
              {
                "key": "result",
                "type": "value"
              }
            ]
          },
          {
            "formatCompatibility": [
              "DIRECT_CALCULATION",
              "COMPARISON",
              "ESTIMATION",
              "MULTI_STEP"
            ],
            "template": "{character} goes to the shop and buys {items}. How much does {character} spend in total?",
            "answerTemplate": "{character} spends {result} in total",
            "placeholders": [
              {
                "key": "character",
                "type": "character"
              },
              {
                "key": "items",
                "type": "item_list"
              },
              {
                "key": "result",
                "type": "value"
              }
            ]
          },
          {
            "formatCompatibility": [
              "ESTIMATION"
            ],
            "template": "Estimate: If {character} buys {items}, about how much will it cost?",
            "answerTemplate": "It will cost approximately {result}",
            "placeholders": [
              {
                "key": "character",
                "type": "character"
              },
              {
                "key": "items",
                "type": "item_list"
              },
              {
                "key": "result",
                "type": "value"
              }
            ]
          },
          {
            "formatCompatibility": [
              "VALIDATION"
            ],
            "template": "{character} calculated that {items} costs {amount}. Is this correct?",
            "answerTemplate": "{validation_result}",
            "placeholders": [
              {
                "key": "character",
                "type": "character"
              },
              {
                "key": "items",
                "type": "item_list"
              },
              {
                "key": "amount",
                "type": "value"
              },
              {
                "key": "validation_result",
                "type": "boolean"
              }
            ]
          }
        ]
      },
      "distractors": [
        {
          "value": 128,
          "displayText": "128",
          "strategy": "WRONG_OPERATION",
          "reasoning": "Added instead of subtracting"
        },
        {
          "value": 2.52,
          "displayText": "2.52",
          "strategy": "CLOSE_VALUE",
          "reasoning": "Off by 1"
        },
        {
          "value": 0.52,
          "displayText": "0.52",
          "strategy": "CLOSE_VALUE",
          "reasoning": "Off by 1"
        }
      ],
      "enhancementStatus": {
        "level": "partial",
        "requestedFormat": "DIRECT_CALCULATION",
        "actualFormat": "DIRECT_CALCULATION",
        "featuresActive": [
          "enhanced_distractors",
          "rich_scenarios",
          "cognitive_load",
          "advanced_formats"
        ],
        "featuresPending": [],
        "isFullyEnhanced": true
      },
      "mathOutput": {
        "operation": "SUBTRACTION",
        "subtrahend": 0.48,
        "minuend": 2,
        "result": 1.52
      },
      "generationTime": 1,
      "questionId": "q_1759232463522_fj54cqaeo",
      "generationSetup": {
        "controller_used": "DIRECT_CALCULATIONController",
        "format_requested": "DIRECT_CALCULATION",
        "format_actual": "DIRECT_CALCULATION",
        "scenario_theme": "SHOPPING",
        "scenario_id": "shop-002-realistic-general",
        "scenario_selection_method": "default",
        "distractor_strategies": [
          "WRONG_OPERATION",
          "CLOSE_VALUE",
          "CLOSE_VALUE"
        ],
        "distractor_count": 3,
        "theme_variety": false,
        "format_variety": false,
        "enhancement_level": "partial",
        "features_active": [
          "enhanced_distractors",
          "rich_scenarios",
          "cognitive_load",
          "advanced_formats"
        ],
        "features_pending": [],
        "generation_time_ms": 1
      }
    },
    {
      "text": "Logan needs to solve: 16 - 11\\n\\nWhich answer is correct?\\nA) 50  B) 5  C) 6  D) 27",
      "options": [
        {
          "text": "50",
          "value": 50,
          "index": 0
        },
        {
          "text": "6",
          "value": 6,
          "index": 1
        },
        {
          "text": "£5.00",
          "value": 5,
          "index": 2
        },
        {
          "text": "27",
          "value": 27,
          "index": 3
        }
      ],
      "correctIndex": 2,
      "questionContent": {
        "fullText": "Logan needs to solve: 16 - 11\\n\\nWhich answer is correct?\\nA) 50  B) 5  C) 6  D) 27"
      },
      "format": "VALIDATION",
      "difficulty": {
        "year": 3,
        "subLevel": 3,
        "displayName": "3.3",
        "cognitiveLoad": 40
      },
      "cognitiveLoad": 40,
      "curriculumTags": [
        "3N1c",
        "3N1d"
      ],
      "scenario": {
        "id": "shop-002-realistic-general",
        "theme": "SHOPPING",
        "setting": {
          "location": "local shop",
          "timeContext": "after school",
          "atmosphere": "friendly"
        },
        "characters": [
          {
            "name": "Logan",
            "role": "student"
          }
        ],
        "items": [
          {
            "name": "apple",
            "category": "FOOD_DRINK",
            "typicalValue": {
              "min": 0.2,
              "max": 0.5,
              "typical": 0.35,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "banana",
            "category": "FOOD_DRINK",
            "typicalValue": {
              "min": 0.15,
              "max": 0.4,
              "typical": 0.25,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "sandwich",
            "category": "FOOD_DRINK",
            "typicalValue": {
              "min": 2.5,
              "max": 6,
              "typical": 4,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "drink",
            "category": "FOOD_DRINK",
            "typicalValue": {
              "min": 0.8,
              "max": 2.5,
              "typical": 1.5,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "cake",
            "category": "FOOD_DRINK",
            "typicalValue": {
              "min": 1.5,
              "max": 4,
              "typical": 2.5,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "biscuit",
            "category": "FOOD_DRINK",
            "typicalValue": {
              "min": 0.8,
              "max": 2,
              "typical": 1.2,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "sweet",
            "category": "FOOD_DRINK",
            "typicalValue": {
              "min": 0.1,
              "max": 1,
              "typical": 0.5,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "chocolate",
            "category": "FOOD_DRINK",
            "typicalValue": {
              "min": 0.6,
              "max": 3,
              "typical": 1.5,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "pen",
            "category": "SCHOOL_SUPPLIES",
            "typicalValue": {
              "min": 0.5,
              "max": 2,
              "typical": 1,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "pencil",
            "category": "SCHOOL_SUPPLIES",
            "typicalValue": {
              "min": 0.2,
              "max": 1,
              "typical": 0.5,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "ruler",
            "category": "SCHOOL_SUPPLIES",
            "typicalValue": {
              "min": 0.8,
              "max": 2.5,
              "typical": 1.5,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "notebook",
            "category": "SCHOOL_SUPPLIES",
            "typicalValue": {
              "min": 1,
              "max": 4,
              "typical": 2,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "eraser",
            "category": "SCHOOL_SUPPLIES",
            "typicalValue": {
              "min": 0.3,
              "max": 1.5,
              "typical": 0.75,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "book",
            "category": "BOOKS_MEDIA",
            "typicalValue": {
              "min": 3,
              "max": 15,
              "typical": 8,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "comic",
            "category": "BOOKS_MEDIA",
            "typicalValue": {
              "min": 2,
              "max": 5,
              "typical": 3,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "magazine",
            "category": "BOOKS_MEDIA",
            "typicalValue": {
              "min": 2.5,
              "max": 6,
              "typical": 4,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "toy",
            "category": "TOYS_GAMES",
            "typicalValue": {
              "min": 5,
              "max": 25,
              "typical": 12,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "game",
            "category": "TOYS_GAMES",
            "typicalValue": {
              "min": 8,
              "max": 60,
              "typical": 25,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "puzzle",
            "category": "TOYS_GAMES",
            "typicalValue": {
              "min": 5,
              "max": 20,
              "typical": 12,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "sticker",
            "category": "TOYS_GAMES",
            "typicalValue": {
              "min": 0.2,
              "max": 2,
              "typical": 0.8,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "badge",
            "category": "TOYS_GAMES",
            "typicalValue": {
              "min": 0.5,
              "max": 3,
              "typical": 1.5,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "poster",
            "category": "BOOKS_MEDIA",
            "typicalValue": {
              "min": 2,
              "max": 8,
              "typical": 4,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "card",
            "category": "BOOKS_MEDIA",
            "typicalValue": {
              "min": 0.5,
              "max": 4,
              "typical": 2,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          }
        ],
        "culturalElements": [
          {
            "type": "currency",
            "value": "£",
            "explanation": "British pounds"
          },
          {
            "type": "location",
            "value": "UK local shop",
            "explanation": "Typical British corner shop"
          }
        ],
        "realWorldConnection": "Everyday shopping with realistic UK prices",
        "yearAppropriate": [
          1,
          2,
          3,
          4,
          5,
          6
        ],
        "templates": [
          {
            "formatCompatibility": [
              "DIRECT_CALCULATION",
              "MULTI_STEP"
            ],
            "modelCompatibility": [
              "ADDITION"
            ],
            "operandCount": 3,
            "template": "{character} buys {article1} {item1} for {price1}, {article2} {item2} for {price2}, and {article3} {item3} for {price3}. What is the total cost?",
            "answerTemplate": "The total cost is {result}",
            "placeholders": [
              {
                "key": "character",
                "type": "character"
              },
              {
                "key": "item1",
                "type": "item"
              },
              {
                "key": "item2",
                "type": "item"
              },
              {
                "key": "item3",
                "type": "item"
              },
              {
                "key": "price1",
                "type": "value"
              },
              {
                "key": "price2",
                "type": "value"
              },
              {
                "key": "price3",
                "type": "value"
              },
              {
                "key": "result",
                "type": "value"
              }
            ]
          },
          {
            "formatCompatibility": [
              "DIRECT_CALCULATION",
              "MULTI_STEP"
            ],
            "modelCompatibility": [
              "ADDITION"
            ],
            "operandCount": 2,
            "template": "{character} buys {article1} {item1} for {price1} and {article2} {item2} for {price2}. What is the total cost?",
            "answerTemplate": "The total cost is {result}",
            "placeholders": [
              {
                "key": "character",
                "type": "character"
              },
              {
                "key": "item1",
                "type": "item"
              },
              {
                "key": "item2",
                "type": "item"
              },
              {
                "key": "price1",
                "type": "value"
              },
              {
                "key": "price2",
                "type": "value"
              },
              {
                "key": "result",
                "type": "value"
              }
            ]
          },
          {
            "formatCompatibility": [
              "DIRECT_CALCULATION"
            ],
            "modelCompatibility": [
              "SUBTRACTION",
              "CHANGE_CALCULATION"
            ],
            "template": "{character} buys {article} {item} for {price} and pays with {payment}. How much change does {character} get?",
            "answerTemplate": "{character} receives {result} in change",
            "placeholders": [
              {
                "key": "character",
                "type": "character"
              },
              {
                "key": "item",
                "type": "item"
              },
              {
                "key": "price",
                "type": "value"
              },
              {
                "key": "payment",
                "type": "value"
              },
              {
                "key": "result",
                "type": "value"
              }
            ]
          },
          {
            "formatCompatibility": [
              "DIRECT_CALCULATION"
            ],
            "modelCompatibility": [
              "MULTIPLICATION"
            ],
            "template": "{character} buys {quantity} {item} at {price} each. What is the total cost?",
            "answerTemplate": "The total cost is {result}",
            "placeholders": [
              {
                "key": "character",
                "type": "character"
              },
              {
                "key": "quantity",
                "type": "value"
              },
              {
                "key": "item",
                "type": "item"
              },
              {
                "key": "price",
                "type": "value"
              },
              {
                "key": "result",
                "type": "value"
              }
            ]
          },
          {
            "formatCompatibility": [
              "DIRECT_CALCULATION"
            ],
            "modelCompatibility": [
              "DIVISION"
            ],
            "template": "{character} has {total} to spend equally on {quantity} {item}. How much can {character} spend on each one?",
            "answerTemplate": "{character} can spend {result} on each {item}",
            "placeholders": [
              {
                "key": "character",
                "type": "character"
              },
              {
                "key": "total",
                "type": "value"
              },
              {
                "key": "quantity",
                "type": "value"
              },
              {
                "key": "item",
                "type": "item"
              },
              {
                "key": "result",
                "type": "value"
              }
            ]
          },
          {
            "formatCompatibility": [
              "DIRECT_CALCULATION",
              "COMPARISON",
              "ESTIMATION",
              "MULTI_STEP"
            ],
            "template": "{character} goes to the shop and buys {items}. How much does {character} spend in total?",
            "answerTemplate": "{character} spends {result} in total",
            "placeholders": [
              {
                "key": "character",
                "type": "character"
              },
              {
                "key": "items",
                "type": "item_list"
              },
              {
                "key": "result",
                "type": "value"
              }
            ]
          },
          {
            "formatCompatibility": [
              "ESTIMATION"
            ],
            "template": "Estimate: If {character} buys {items}, about how much will it cost?",
            "answerTemplate": "It will cost approximately {result}",
            "placeholders": [
              {
                "key": "character",
                "type": "character"
              },
              {
                "key": "items",
                "type": "item_list"
              },
              {
                "key": "result",
                "type": "value"
              }
            ]
          },
          {
            "formatCompatibility": [
              "VALIDATION"
            ],
            "template": "{character} calculated that {items} costs {amount}. Is this correct?",
            "answerTemplate": "{validation_result}",
            "placeholders": [
              {
                "key": "character",
                "type": "character"
              },
              {
                "key": "items",
                "type": "item_list"
              },
              {
                "key": "amount",
                "type": "value"
              },
              {
                "key": "validation_result",
                "type": "boolean"
              }
            ]
          }
        ]
      },
      "distractors": [
        {
          "value": 50,
          "strategy": "CALCULATION_ERROR",
          "rationale": "Common calculation error"
        },
        {
          "value": 6,
          "strategy": "CALCULATION_ERROR",
          "rationale": "Common calculation error"
        },
        {
          "value": 27,
          "strategy": "CALCULATION_ERROR",
          "rationale": "Common calculation error"
        }
      ],
      "enhancementStatus": {
        "level": "full",
        "requestedFormat": "VALIDATION",
        "actualFormat": "VALIDATION",
        "featuresActive": [
          "enhanced_distractors",
          "rich_scenarios",
          "cognitive_load",
          "advanced_formats"
        ],
        "featuresPending": [],
        "isFullyEnhanced": true
      },
      "mathOutput": {
        "operation": "SUBTRACTION",
        "minuend": 16,
        "subtrahend": 11,
        "result": 5,
        "decimal_formatted": {
          "minuend": "16",
          "subtrahend": "11",
          "result": "5"
        }
      },
      "generationTime": 0,
      "questionId": "q_1759232463522_3izs2f6xo",
      "generationSetup": {
        "controller_used": "VALIDATIONController",
        "format_requested": "VALIDATION",
        "format_actual": "VALIDATION",
        "scenario_theme": "SHOPPING",
        "scenario_id": "shop-002-realistic-general",
        "scenario_selection_method": "default",
        "distractor_strategies": [
          "CALCULATION_ERROR",
          "CALCULATION_ERROR",
          "CALCULATION_ERROR"
        ],
        "distractor_count": 3,
        "theme_variety": false,
        "format_variety": false,
        "enhancement_level": "full",
        "features_active": [
          "enhanced_distractors",
          "rich_scenarios",
          "cognitive_load",
          "advanced_formats"
        ],
        "features_pending": [],
        "generation_time_ms": 0
      }
    },
    {
      "text": "Logan buys an apple for 22p and pays with £2. How much change does Logan get?",
      "options": [
        {
          "text": "0.78",
          "value": 0.78,
          "index": 0
        },
        {
          "text": "178",
          "value": 178,
          "index": 1
        },
        {
          "text": "£1.78",
          "value": 1.78,
          "index": 2
        },
        {
          "text": "2.78",
          "value": 2.7800000000000002,
          "index": 3
        }
      ],
      "correctIndex": 2,
      "format": "DIRECT_CALCULATION",
      "difficulty": {
        "year": 3,
        "subLevel": 3,
        "displayName": "3.3",
        "cognitiveLoad": 40
      },
      "cognitiveLoad": 40,
      "curriculumTags": [
        "3N1c",
        "3N1d"
      ],
      "scenario": {
        "id": "shop-002-realistic-general",
        "theme": "SHOPPING",
        "setting": {
          "location": "local shop",
          "timeContext": "after school",
          "atmosphere": "friendly"
        },
        "characters": [
          {
            "name": "Logan",
            "role": "student"
          }
        ],
        "items": [
          {
            "name": "apple",
            "category": "FOOD_DRINK",
            "typicalValue": {
              "min": 0.2,
              "max": 0.5,
              "typical": 0.35,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "banana",
            "category": "FOOD_DRINK",
            "typicalValue": {
              "min": 0.15,
              "max": 0.4,
              "typical": 0.25,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "sandwich",
            "category": "FOOD_DRINK",
            "typicalValue": {
              "min": 2.5,
              "max": 6,
              "typical": 4,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "drink",
            "category": "FOOD_DRINK",
            "typicalValue": {
              "min": 0.8,
              "max": 2.5,
              "typical": 1.5,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "cake",
            "category": "FOOD_DRINK",
            "typicalValue": {
              "min": 1.5,
              "max": 4,
              "typical": 2.5,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "biscuit",
            "category": "FOOD_DRINK",
            "typicalValue": {
              "min": 0.8,
              "max": 2,
              "typical": 1.2,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "sweet",
            "category": "FOOD_DRINK",
            "typicalValue": {
              "min": 0.1,
              "max": 1,
              "typical": 0.5,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "chocolate",
            "category": "FOOD_DRINK",
            "typicalValue": {
              "min": 0.6,
              "max": 3,
              "typical": 1.5,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "pen",
            "category": "SCHOOL_SUPPLIES",
            "typicalValue": {
              "min": 0.5,
              "max": 2,
              "typical": 1,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "pencil",
            "category": "SCHOOL_SUPPLIES",
            "typicalValue": {
              "min": 0.2,
              "max": 1,
              "typical": 0.5,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "ruler",
            "category": "SCHOOL_SUPPLIES",
            "typicalValue": {
              "min": 0.8,
              "max": 2.5,
              "typical": 1.5,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "notebook",
            "category": "SCHOOL_SUPPLIES",
            "typicalValue": {
              "min": 1,
              "max": 4,
              "typical": 2,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "eraser",
            "category": "SCHOOL_SUPPLIES",
            "typicalValue": {
              "min": 0.3,
              "max": 1.5,
              "typical": 0.75,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "book",
            "category": "BOOKS_MEDIA",
            "typicalValue": {
              "min": 3,
              "max": 15,
              "typical": 8,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "comic",
            "category": "BOOKS_MEDIA",
            "typicalValue": {
              "min": 2,
              "max": 5,
              "typical": 3,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "magazine",
            "category": "BOOKS_MEDIA",
            "typicalValue": {
              "min": 2.5,
              "max": 6,
              "typical": 4,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "toy",
            "category": "TOYS_GAMES",
            "typicalValue": {
              "min": 5,
              "max": 25,
              "typical": 12,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "game",
            "category": "TOYS_GAMES",
            "typicalValue": {
              "min": 8,
              "max": 60,
              "typical": 25,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "puzzle",
            "category": "TOYS_GAMES",
            "typicalValue": {
              "min": 5,
              "max": 20,
              "typical": 12,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "sticker",
            "category": "TOYS_GAMES",
            "typicalValue": {
              "min": 0.2,
              "max": 2,
              "typical": 0.8,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "badge",
            "category": "TOYS_GAMES",
            "typicalValue": {
              "min": 0.5,
              "max": 3,
              "typical": 1.5,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "poster",
            "category": "BOOKS_MEDIA",
            "typicalValue": {
              "min": 2,
              "max": 8,
              "typical": 4,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "card",
            "category": "BOOKS_MEDIA",
            "typicalValue": {
              "min": 0.5,
              "max": 4,
              "typical": 2,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          }
        ],
        "culturalElements": [
          {
            "type": "currency",
            "value": "£",
            "explanation": "British pounds"
          },
          {
            "type": "location",
            "value": "UK local shop",
            "explanation": "Typical British corner shop"
          }
        ],
        "realWorldConnection": "Everyday shopping with realistic UK prices",
        "yearAppropriate": [
          1,
          2,
          3,
          4,
          5,
          6
        ],
        "templates": [
          {
            "formatCompatibility": [
              "DIRECT_CALCULATION",
              "MULTI_STEP"
            ],
            "modelCompatibility": [
              "ADDITION"
            ],
            "operandCount": 3,
            "template": "{character} buys {article1} {item1} for {price1}, {article2} {item2} for {price2}, and {article3} {item3} for {price3}. What is the total cost?",
            "answerTemplate": "The total cost is {result}",
            "placeholders": [
              {
                "key": "character",
                "type": "character"
              },
              {
                "key": "item1",
                "type": "item"
              },
              {
                "key": "item2",
                "type": "item"
              },
              {
                "key": "item3",
                "type": "item"
              },
              {
                "key": "price1",
                "type": "value"
              },
              {
                "key": "price2",
                "type": "value"
              },
              {
                "key": "price3",
                "type": "value"
              },
              {
                "key": "result",
                "type": "value"
              }
            ]
          },
          {
            "formatCompatibility": [
              "DIRECT_CALCULATION",
              "MULTI_STEP"
            ],
            "modelCompatibility": [
              "ADDITION"
            ],
            "operandCount": 2,
            "template": "{character} buys {article1} {item1} for {price1} and {article2} {item2} for {price2}. What is the total cost?",
            "answerTemplate": "The total cost is {result}",
            "placeholders": [
              {
                "key": "character",
                "type": "character"
              },
              {
                "key": "item1",
                "type": "item"
              },
              {
                "key": "item2",
                "type": "item"
              },
              {
                "key": "price1",
                "type": "value"
              },
              {
                "key": "price2",
                "type": "value"
              },
              {
                "key": "result",
                "type": "value"
              }
            ]
          },
          {
            "formatCompatibility": [
              "DIRECT_CALCULATION"
            ],
            "modelCompatibility": [
              "SUBTRACTION",
              "CHANGE_CALCULATION"
            ],
            "template": "{character} buys {article} {item} for {price} and pays with {payment}. How much change does {character} get?",
            "answerTemplate": "{character} receives {result} in change",
            "placeholders": [
              {
                "key": "character",
                "type": "character"
              },
              {
                "key": "item",
                "type": "item"
              },
              {
                "key": "price",
                "type": "value"
              },
              {
                "key": "payment",
                "type": "value"
              },
              {
                "key": "result",
                "type": "value"
              }
            ]
          },
          {
            "formatCompatibility": [
              "DIRECT_CALCULATION"
            ],
            "modelCompatibility": [
              "MULTIPLICATION"
            ],
            "template": "{character} buys {quantity} {item} at {price} each. What is the total cost?",
            "answerTemplate": "The total cost is {result}",
            "placeholders": [
              {
                "key": "character",
                "type": "character"
              },
              {
                "key": "quantity",
                "type": "value"
              },
              {
                "key": "item",
                "type": "item"
              },
              {
                "key": "price",
                "type": "value"
              },
              {
                "key": "result",
                "type": "value"
              }
            ]
          },
          {
            "formatCompatibility": [
              "DIRECT_CALCULATION"
            ],
            "modelCompatibility": [
              "DIVISION"
            ],
            "template": "{character} has {total} to spend equally on {quantity} {item}. How much can {character} spend on each one?",
            "answerTemplate": "{character} can spend {result} on each {item}",
            "placeholders": [
              {
                "key": "character",
                "type": "character"
              },
              {
                "key": "total",
                "type": "value"
              },
              {
                "key": "quantity",
                "type": "value"
              },
              {
                "key": "item",
                "type": "item"
              },
              {
                "key": "result",
                "type": "value"
              }
            ]
          },
          {
            "formatCompatibility": [
              "DIRECT_CALCULATION",
              "COMPARISON",
              "ESTIMATION",
              "MULTI_STEP"
            ],
            "template": "{character} goes to the shop and buys {items}. How much does {character} spend in total?",
            "answerTemplate": "{character} spends {result} in total",
            "placeholders": [
              {
                "key": "character",
                "type": "character"
              },
              {
                "key": "items",
                "type": "item_list"
              },
              {
                "key": "result",
                "type": "value"
              }
            ]
          },
          {
            "formatCompatibility": [
              "ESTIMATION"
            ],
            "template": "Estimate: If {character} buys {items}, about how much will it cost?",
            "answerTemplate": "It will cost approximately {result}",
            "placeholders": [
              {
                "key": "character",
                "type": "character"
              },
              {
                "key": "items",
                "type": "item_list"
              },
              {
                "key": "result",
                "type": "value"
              }
            ]
          },
          {
            "formatCompatibility": [
              "VALIDATION"
            ],
            "template": "{character} calculated that {items} costs {amount}. Is this correct?",
            "answerTemplate": "{validation_result}",
            "placeholders": [
              {
                "key": "character",
                "type": "character"
              },
              {
                "key": "items",
                "type": "item_list"
              },
              {
                "key": "amount",
                "type": "value"
              },
              {
                "key": "validation_result",
                "type": "boolean"
              }
            ]
          }
        ]
      },
      "distractors": [
        {
          "value": 178,
          "displayText": "178",
          "strategy": "WRONG_OPERATION",
          "reasoning": "Added instead of subtracting"
        },
        {
          "value": 2.7800000000000002,
          "displayText": "2.78",
          "strategy": "CLOSE_VALUE",
          "reasoning": "Off by 1"
        },
        {
          "value": 0.78,
          "displayText": "0.78",
          "strategy": "CLOSE_VALUE",
          "reasoning": "Off by 1"
        }
      ],
      "enhancementStatus": {
        "level": "partial",
        "requestedFormat": "DIRECT_CALCULATION",
        "actualFormat": "DIRECT_CALCULATION",
        "featuresActive": [
          "enhanced_distractors",
          "rich_scenarios",
          "cognitive_load",
          "advanced_formats"
        ],
        "featuresPending": [],
        "isFullyEnhanced": true
      },
      "mathOutput": {
        "operation": "SUBTRACTION",
        "subtrahend": 0.22,
        "minuend": 2,
        "result": 1.78
      },
      "generationTime": 0,
      "questionId": "q_1759232463522_zau47dxh9",
      "generationSetup": {
        "controller_used": "DIRECT_CALCULATIONController",
        "format_requested": "DIRECT_CALCULATION",
        "format_actual": "DIRECT_CALCULATION",
        "scenario_theme": "SHOPPING",
        "scenario_id": "shop-002-realistic-general",
        "scenario_selection_method": "default",
        "distractor_strategies": [
          "WRONG_OPERATION",
          "CLOSE_VALUE",
          "CLOSE_VALUE"
        ],
        "distractor_count": 3,
        "theme_variety": false,
        "format_variety": false,
        "enhancement_level": "partial",
        "features_active": [
          "enhanced_distractors",
          "rich_scenarios",
          "cognitive_load",
          "advanced_formats"
        ],
        "features_pending": [],
        "generation_time_ms": 0
      }
    },
    {
      "text": "Logan buys an apple for 41p and pays with £2. How much change does Logan get?",
      "options": [
        {
          "text": "£1.59",
          "value": 1.59,
          "index": 0
        },
        {
          "text": "3.59",
          "value": 3.59,
          "index": 1
        },
        {
          "text": "154",
          "value": 154,
          "index": 2
        },
        {
          "text": "0.59",
          "value": 0.5900000000000001,
          "index": 3
        }
      ],
      "correctIndex": 0,
      "format": "DIRECT_CALCULATION",
      "difficulty": {
        "year": 3,
        "subLevel": 3,
        "displayName": "3.3",
        "cognitiveLoad": 40
      },
      "cognitiveLoad": 40,
      "curriculumTags": [
        "3N1c",
        "3N1d"
      ],
      "scenario": {
        "id": "shop-002-realistic-general",
        "theme": "SHOPPING",
        "setting": {
          "location": "local shop",
          "timeContext": "after school",
          "atmosphere": "friendly"
        },
        "characters": [
          {
            "name": "Logan",
            "role": "student"
          }
        ],
        "items": [
          {
            "name": "apple",
            "category": "FOOD_DRINK",
            "typicalValue": {
              "min": 0.2,
              "max": 0.5,
              "typical": 0.35,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "banana",
            "category": "FOOD_DRINK",
            "typicalValue": {
              "min": 0.15,
              "max": 0.4,
              "typical": 0.25,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "sandwich",
            "category": "FOOD_DRINK",
            "typicalValue": {
              "min": 2.5,
              "max": 6,
              "typical": 4,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "drink",
            "category": "FOOD_DRINK",
            "typicalValue": {
              "min": 0.8,
              "max": 2.5,
              "typical": 1.5,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "cake",
            "category": "FOOD_DRINK",
            "typicalValue": {
              "min": 1.5,
              "max": 4,
              "typical": 2.5,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "biscuit",
            "category": "FOOD_DRINK",
            "typicalValue": {
              "min": 0.8,
              "max": 2,
              "typical": 1.2,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "sweet",
            "category": "FOOD_DRINK",
            "typicalValue": {
              "min": 0.1,
              "max": 1,
              "typical": 0.5,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "chocolate",
            "category": "FOOD_DRINK",
            "typicalValue": {
              "min": 0.6,
              "max": 3,
              "typical": 1.5,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "pen",
            "category": "SCHOOL_SUPPLIES",
            "typicalValue": {
              "min": 0.5,
              "max": 2,
              "typical": 1,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "pencil",
            "category": "SCHOOL_SUPPLIES",
            "typicalValue": {
              "min": 0.2,
              "max": 1,
              "typical": 0.5,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "ruler",
            "category": "SCHOOL_SUPPLIES",
            "typicalValue": {
              "min": 0.8,
              "max": 2.5,
              "typical": 1.5,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "notebook",
            "category": "SCHOOL_SUPPLIES",
            "typicalValue": {
              "min": 1,
              "max": 4,
              "typical": 2,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "eraser",
            "category": "SCHOOL_SUPPLIES",
            "typicalValue": {
              "min": 0.3,
              "max": 1.5,
              "typical": 0.75,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "book",
            "category": "BOOKS_MEDIA",
            "typicalValue": {
              "min": 3,
              "max": 15,
              "typical": 8,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "comic",
            "category": "BOOKS_MEDIA",
            "typicalValue": {
              "min": 2,
              "max": 5,
              "typical": 3,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "magazine",
            "category": "BOOKS_MEDIA",
            "typicalValue": {
              "min": 2.5,
              "max": 6,
              "typical": 4,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "toy",
            "category": "TOYS_GAMES",
            "typicalValue": {
              "min": 5,
              "max": 25,
              "typical": 12,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "game",
            "category": "TOYS_GAMES",
            "typicalValue": {
              "min": 8,
              "max": 60,
              "typical": 25,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "puzzle",
            "category": "TOYS_GAMES",
            "typicalValue": {
              "min": 5,
              "max": 20,
              "typical": 12,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "sticker",
            "category": "TOYS_GAMES",
            "typicalValue": {
              "min": 0.2,
              "max": 2,
              "typical": 0.8,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "badge",
            "category": "TOYS_GAMES",
            "typicalValue": {
              "min": 0.5,
              "max": 3,
              "typical": 1.5,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "poster",
            "category": "BOOKS_MEDIA",
            "typicalValue": {
              "min": 2,
              "max": 8,
              "typical": 4,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          },
          {
            "name": "card",
            "category": "BOOKS_MEDIA",
            "typicalValue": {
              "min": 0.5,
              "max": 4,
              "typical": 2,
              "distribution": "normal"
            },
            "unit": "£",
            "attributes": {
              "quality": "standard"
            }
          }
        ],
        "culturalElements": [
          {
            "type": "currency",
            "value": "£",
            "explanation": "British pounds"
          },
          {
            "type": "location",
            "value": "UK local shop",
            "explanation": "Typical British corner shop"
          }
        ],
        "realWorldConnection": "Everyday shopping with realistic UK prices",
        "yearAppropriate": [
          1,
          2,
          3,
          4,
          5,
          6
        ],
        "templates": [
          {
            "formatCompatibility": [
              "DIRECT_CALCULATION",
              "MULTI_STEP"
            ],
            "modelCompatibility": [
              "ADDITION"
            ],
            "operandCount": 3,
            "template": "{character} buys {article1} {item1} for {price1}, {article2} {item2} for {price2}, and {article3} {item3} for {price3}. What is the total cost?",
            "answerTemplate": "The total cost is {result}",
            "placeholders": [
              {
                "key": "character",
                "type": "character"
              },
              {
                "key": "item1",
                "type": "item"
              },
              {
                "key": "item2",
                "type": "item"
              },
              {
                "key": "item3",
                "type": "item"
              },
              {
                "key": "price1",
                "type": "value"
              },
              {
                "key": "price2",
                "type": "value"
              },
              {
                "key": "price3",
                "type": "value"
              },
              {
                "key": "result",
                "type": "value"
              }
            ]
          },
          {
            "formatCompatibility": [
              "DIRECT_CALCULATION",
              "MULTI_STEP"
            ],
            "modelCompatibility": [
              "ADDITION"
            ],
            "operandCount": 2,
            "template": "{character} buys {article1} {item1} for {price1} and {article2} {item2} for {price2}. What is the total cost?",
            "answerTemplate": "The total cost is {result}",
            "placeholders": [
              {
                "key": "character",
                "type": "character"
              },
              {
                "key": "item1",
                "type": "item"
              },
              {
                "key": "item2",
                "type": "item"
              },
              {
                "key": "price1",
                "type": "value"
              },
              {
                "key": "price2",
                "type": "value"
              },
              {
                "key": "result",
                "type": "value"
              }
            ]
          },
          {
            "formatCompatibility": [
              "DIRECT_CALCULATION"
            ],
            "modelCompatibility": [
              "SUBTRACTION",
              "CHANGE_CALCULATION"
            ],
            "template": "{character} buys {article} {item} for {price} and pays with {payment}. How much change does {character} get?",
            "answerTemplate": "{character} receives {result} in change",
            "placeholders": [
              {
                "key": "character",
                "type": "character"
              },
              {
                "key": "item",
                "type": "item"
              },
              {
                "key": "price",
                "type": "value"
              },
              {
                "key": "payment",
                "type": "value"
              },
              {
                "key": "result",
                "type": "value"
              }
            ]
          },
          {
            "formatCompatibility": [
              "DIRECT_CALCULATION"
            ],
            "modelCompatibility": [
              "MULTIPLICATION"
            ],
            "template": "{character} buys {quantity} {item} at {price} each. What is the total cost?",
            "answerTemplate": "The total cost is {result}",
            "placeholders": [
              {
                "key": "character",
                "type": "character"
              },
              {
                "key": "quantity",
                "type": "value"
              },
              {
                "key": "item",
                "type": "item"
              },
              {
                "key": "price",
                "type": "value"
              },
              {
                "key": "result",
                "type": "value"
              }
            ]
          },
          {
            "formatCompatibility": [
              "DIRECT_CALCULATION"
            ],
            "modelCompatibility": [
              "DIVISION"
            ],
            "template": "{character} has {total} to spend equally on {quantity} {item}. How much can {character} spend on each one?",
            "answerTemplate": "{character} can spend {result} on each {item}",
            "placeholders": [
              {
                "key": "character",
                "type": "character"
              },
              {
                "key": "total",
                "type": "value"
              },
              {
                "key": "quantity",
                "type": "value"
              },
              {
                "key": "item",
                "type": "item"
              },
              {
                "key": "result",
                "type": "value"
              }
            ]
          },
          {
            "formatCompatibility": [
              "DIRECT_CALCULATION",
              "COMPARISON",
              "ESTIMATION",
              "MULTI_STEP"
            ],
            "template": "{character} goes to the shop and buys {items}. How much does {character} spend in total?",
            "answerTemplate": "{character} spends {result} in total",
            "placeholders": [
              {
                "key": "character",
                "type": "character"
              },
              {
                "key": "items",
                "type": "item_list"
              },
              {
                "key": "result",
                "type": "value"
              }
            ]
          },
          {
            "formatCompatibility": [
              "ESTIMATION"
            ],
            "template": "Estimate: If {character} buys {items}, about how much will it cost?",
            "answerTemplate": "It will cost approximately {result}",
            "placeholders": [
              {
                "key": "character",
                "type": "character"
              },
              {
                "key": "items",
                "type": "item_list"
              },
              {
                "key": "result",
                "type": "value"
              }
            ]
          },
          {
            "formatCompatibility": [
              "VALIDATION"
            ],
            "template": "{character} calculated that {items} costs {amount}. Is this correct?",
            "answerTemplate": "{validation_result}",
            "placeholders": [
              {
                "key": "character",
                "type": "character"
              },
              {
                "key": "items",
                "type": "item_list"
              },
              {
                "key": "amount",
                "type": "value"
              },
              {
                "key": "validation_result",
                "type": "boolean"
              }
            ]
          }
        ]
      },
      "distractors": [
        {
          "value": 154,
          "displayText": "154",
          "strategy": "WRONG_OPERATION",
          "reasoning": "Added instead of subtracting"
        },
        {
          "value": 0.5900000000000001,
          "displayText": "0.59",
          "strategy": "CLOSE_VALUE",
          "reasoning": "Off by 1"
        },
        {
          "value": 3.59,
          "displayText": "3.59",
          "strategy": "CLOSE_VALUE",
          "reasoning": "Off by 2"
        }
      ],
      "enhancementStatus": {
        "level": "partial",
        "requestedFormat": "DIRECT_CALCULATION",
        "actualFormat": "DIRECT_CALCULATION",
        "featuresActive": [
          "enhanced_distractors",
          "rich_scenarios",
          "cognitive_load",
          "advanced_formats"
        ],
        "featuresPending": [],
        "isFullyEnhanced": true
      },
      "mathOutput": {
        "operation": "SUBTRACTION",
        "subtrahend": 0.41,
        "minuend": 2,
        "result": 1.59
      },
      "generationTime": 0,
      "questionId": "q_1759232463522_2ldwkwz6l",
      "generationSetup": {
        "controller_used": "DIRECT_CALCULATIONController",
        "format_requested": "DIRECT_CALCULATION",
        "format_actual": "DIRECT_CALCULATION",
        "scenario_theme": "SHOPPING",
        "scenario_id": "shop-002-realistic-general",
        "scenario_selection_method": "default",
        "distractor_strategies": [
          "WRONG_OPERATION",
          "CLOSE_VALUE",
          "CLOSE_VALUE"
        ],
        "distractor_count": 3,
        "theme_variety": false,
        "format_variety": false,
        "enhancement_level": "partial",
        "features_active": [
          "enhanced_distractors",
          "rich_scenarios",
          "cognitive_load",
          "advanced_formats"
        ],
        "features_pending": [],
        "generation_time_ms": 0
      }
    }
  ],
  "metadata": {
    "format": "DIRECT_CALCULATION",
    "cognitive_load": 40,
    "curriculum_alignment": [
      "3N1c",
      "3N1d"
    ],
    "difficulty": "3.3",
    "scenario_theme": "SHOPPING",
    "distractor_strategies": [],
    "generation_time_ms": 1,
    "enhancement_status": "partial",
    "format_used": "DIRECT_CALCULATION",
    "features_active": [
      "enhanced_distractors",
      "rich_scenarios",
      "cognitive_load",
      "advanced_formats"
    ],
    "features_pending": [],
    "api_version": "2.0"
  },
  "batch_info": {
    "total_questions": 5,
    "avg_generation_time": 0.2,
    "success_rate": 1
  }
}

--- API TEST SUITE COMPLETE ---
