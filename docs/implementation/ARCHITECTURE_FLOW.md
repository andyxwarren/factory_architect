# Factory Architect: Visual Architecture Flow Chart
## Question Generation System Overview

**Document Version:** 1.0  
**Last Updated:** September 5, 2025  

---

## Executive Summary

This document provides a comprehensive visual mapping of how Factory Architect's mathematical models are orchestrated to generate educational questions. The system follows a **two-engine architecture** that separates mathematical computation from narrative storytelling.

---

## ğŸ—ï¸ High-Level Architecture Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   USER REQUEST  â”‚ â”€â”€â”€â–¶â”‚  API ENDPOINT    â”‚ â”€â”€â”€â–¶â”‚  FINAL QUESTION â”‚
â”‚                 â”‚    â”‚  /api/generate   â”‚    â”‚  WITH ANSWER    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚                       â–²
         â”‚                       â–¼                       â”‚
         â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
         â”‚              â”‚  ORCHESTRATION   â”‚              â”‚
         â”‚              â”‚     LAYER        â”‚              â”‚
         â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
         â”‚                       â”‚                       â”‚
         â”‚                       â–¼                       â”‚
         â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
         â”‚              â”‚   MATH ENGINE    â”‚              â”‚
         â”‚              â”‚   (Pure Logic)   â”‚              â”‚
         â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
         â”‚                       â”‚                       â”‚
         â”‚                       â–¼                       â”‚
         â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
         â”‚              â”‚   STORY ENGINE   â”‚              â”‚
         â”‚              â”‚ (Narrative Wrap) â”‚              â”‚
         â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
         â”‚                       â”‚                       â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Detailed System Flow Diagram

### Phase 1: Request Processing
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    API REQUEST PROCESSING                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  User/Test Interface                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                         â”‚
â”‚  â”‚   POST Request  â”‚ â”€â”€â”€â”€â”€â”€â”                                 â”‚
â”‚  â”‚   {             â”‚       â”‚                                 â”‚
â”‚  â”‚   model_id,     â”‚       â”‚                                 â”‚
â”‚  â”‚   year_level,   â”‚       â–¼                                 â”‚
â”‚  â”‚   context_type, â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚   difficulty_   â”‚  â”‚  VALIDATION     â”‚                   â”‚
â”‚  â”‚   params        â”‚  â”‚  - Check model  â”‚                   â”‚
â”‚  â”‚   }             â”‚  â”‚    exists       â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  - Validate     â”‚                   â”‚
â”‚                       â”‚    parameters   â”‚                   â”‚
â”‚                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                â”‚                            â”‚
â”‚                                â–¼                            â”‚
â”‚                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚                       â”‚   ROUTE TO      â”‚                   â”‚
â”‚                       â”‚  MATH ENGINE    â”‚                   â”‚
â”‚                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Phase 2: Math Engine Processing
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      MATH ENGINE LAYER                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚  MODEL REGISTRY â”‚           â”‚ DIFFICULTY      â”‚             â”‚
â”‚  â”‚  [18 Models]    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ PRESET SYSTEM   â”‚             â”‚
â”‚  â”‚                 â”‚           â”‚                 â”‚             â”‚
â”‚  â”‚ â€¢ ADDITION      â”‚           â”‚ Year 1-6        â”‚             â”‚
â”‚  â”‚ â€¢ SUBTRACTION   â”‚           â”‚ Parameters      â”‚             â”‚
â”‚  â”‚ â€¢ MULTIPLICATIONâ”‚           â”‚ â€¢ max_value     â”‚             â”‚
â”‚  â”‚ â€¢ DIVISION      â”‚           â”‚ â€¢ decimal_placesâ”‚             â”‚
â”‚  â”‚ â€¢ PERCENTAGE    â”‚           â”‚ â€¢ min_value     â”‚             â”‚
â”‚  â”‚ â€¢ FRACTION      â”‚           â”‚ â€¢ operations    â”‚             â”‚
â”‚  â”‚ â€¢ ... (13 more) â”‚           â”‚                 â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚           â”‚                            â”‚                       â”‚
â”‚           â–¼                            â–¼                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚          INDIVIDUAL MODEL EXECUTION          â”‚               â”‚
â”‚  â”‚                                             â”‚               â”‚
â”‚  â”‚  Example: ADDITION Model                    â”‚               â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚               â”‚
â”‚  â”‚  â”‚ 1. Generate random operands         â”‚    â”‚               â”‚
â”‚  â”‚  â”‚ 2. Apply year-level constraints     â”‚    â”‚               â”‚
â”‚  â”‚  â”‚ 3. Perform mathematical operation   â”‚    â”‚               â”‚
â”‚  â”‚  â”‚ 4. Format outputs (decimal, whole)  â”‚    â”‚               â”‚
â”‚  â”‚  â”‚ 5. Create structured result object  â”‚    â”‚               â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                           â”‚                                    â”‚
â”‚                           â–¼                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚          MATH OUTPUT STRUCTURE              â”‚               â”‚
â”‚  â”‚                                             â”‚               â”‚
â”‚  â”‚  {                                          â”‚               â”‚
â”‚  â”‚    operation: "ADDITION",                   â”‚               â”‚
â”‚  â”‚    operands: [12, 8],                       â”‚               â”‚
â”‚  â”‚    result: 20,                              â”‚               â”‚
â”‚  â”‚    decimal_formatted: {                     â”‚               â”‚
â”‚  â”‚      operands: ["12.00", "8.00"],           â”‚               â”‚
â”‚  â”‚      result: "20.00"                        â”‚               â”‚
â”‚  â”‚    },                                       â”‚               â”‚
â”‚  â”‚    difficulty_level: 3,                     â”‚               â”‚
â”‚  â”‚    working: [...steps...]                   â”‚               â”‚
â”‚  â”‚  }                                          â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Phase 3: Story Engine Processing
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      STORY ENGINE LAYER                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  Math Output           Context Generator                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚  â”‚ Pure Numbers    â”‚â”€â”€â–¶â”‚  MONEY CONTEXT  â”‚                      â”‚
â”‚  â”‚ & Operations    â”‚   â”‚                 â”‚                      â”‚
â”‚  â”‚                 â”‚   â”‚ â€¢ Random person â”‚                      â”‚
â”‚  â”‚ result: 20      â”‚   â”‚ â€¢ Shop scenario â”‚                      â”‚
â”‚  â”‚ operands:[12,8] â”‚   â”‚ â€¢ Item types    â”‚                      â”‚
â”‚  â”‚ operation: ADD  â”‚   â”‚ â€¢ Currency: Â£   â”‚                      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚          â”‚                       â”‚                              â”‚
â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚
â”‚                      â–¼                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚          STORY ENGINE PROCESSOR             â”‚                â”‚
â”‚  â”‚                                             â”‚                â”‚
â”‚  â”‚  1. Match Operation to Template             â”‚                â”‚
â”‚  â”‚     - isAdditionOutput() â”€â”€â–¶ Template A    â”‚                â”‚
â”‚  â”‚     - isSubtractionOutput() â”€â”€â–¶ Template B â”‚                â”‚
â”‚  â”‚     - etc.                                  â”‚                â”‚
â”‚  â”‚                                             â”‚                â”‚
â”‚  â”‚  2. Inject Context Variables                â”‚                â”‚
â”‚  â”‚     - Replace {person} with "Sarah"         â”‚                â”‚
â”‚  â”‚     - Replace {items} with ["apple","pen"]  â”‚                â”‚
â”‚  â”‚     - Format money with Â£ symbol            â”‚                â”‚
â”‚  â”‚                                             â”‚                â”‚
â”‚  â”‚  3. Generate Question Text                  â”‚                â”‚
â”‚  â”‚  4. Generate Answer Text                    â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                      â”‚                                          â”‚
â”‚                      â–¼                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚            STORY OUTPUT                     â”‚                â”‚
â”‚  â”‚                                             â”‚                â”‚
â”‚  â”‚  Question: "Sarah goes to the shop and     â”‚                â”‚
â”‚  â”‚  buys an apple for Â£12.00 and a pen for    â”‚                â”‚
â”‚  â”‚  Â£8.00. How much does Sarah spend in       â”‚                â”‚
â”‚  â”‚  total?"                                    â”‚                â”‚
â”‚  â”‚                                             â”‚                â”‚
â”‚  â”‚  Answer: "Â£20.00"                           â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Phase 4: Response Assembly
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    RESPONSE ASSEMBLY                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                â”‚
â”‚  Story Output + Math Output + Metadata                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚ question:   â”‚ â”‚ math_output:â”‚ â”‚ metadata:   â”‚              â”‚
â”‚  â”‚ "Sarah..."  â”‚ â”‚ {operands,  â”‚ â”‚ {model_id,  â”‚              â”‚
â”‚  â”‚             â”‚ â”‚  result,    â”‚ â”‚  year_level,â”‚              â”‚
â”‚  â”‚ answer:     â”‚ â”‚  working}   â”‚ â”‚  timestamp} â”‚              â”‚
â”‚  â”‚ "Â£20.00"    â”‚ â”‚             â”‚ â”‚             â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                                â”‚                              â”‚
â”‚                                â–¼                              â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚              â”‚        FINAL JSON RESPONSE          â”‚          â”‚
â”‚              â”‚                                     â”‚          â”‚
â”‚              â”‚  {                                  â”‚          â”‚
â”‚              â”‚    "question": "Sarah goes to...",  â”‚          â”‚
â”‚              â”‚    "answer": "Â£20.00",              â”‚          â”‚
â”‚              â”‚    "math_output": {...},            â”‚          â”‚
â”‚              â”‚    "context": {...},                â”‚          â”‚
â”‚              â”‚    "metadata": {...}                â”‚          â”‚
â”‚              â”‚  }                                  â”‚          â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                â”‚                              â”‚
â”‚                                â–¼                              â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚              â”‚       RETURN TO USER/UI             â”‚          â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Component Interaction Map

### File System Mapping
```
ğŸ“ Factory Architect Root
â”‚
â”œâ”€â”€ ğŸŒ API Layer (app/api/generate/route.ts)
â”‚   â”‚
â”‚   â”œâ”€â”€â–¶ ğŸ§® Math Engine (lib/math-engine/)
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“‹ index.ts (Model Registry & Orchestrator)
â”‚   â”‚   â”‚   â”œâ”€â”€ mathModels{} â”€â”€â–¶ 18 Model Instances
â”‚   â”‚   â”‚   â”œâ”€â”€ getModel() â”€â”€â–¶ Retrieve Specific Model
â”‚   â”‚   â”‚   â””â”€â”€ generateMathQuestion() â”€â”€â–¶ Execute Model
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“ models/ (Individual Model Files)
â”‚   â”‚   â”‚   â”œâ”€â”€ addition.model.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ subtraction.model.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ multiplication.model.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ division.model.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ ... (14 more models)
â”‚   â”‚   â”‚   â””â”€â”€ money-scaling.model.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ ğŸ“Š difficulty.ts (Year-Level Presets)
â”‚   â”‚
â”‚   â””â”€â”€â–¶ ğŸ“š Story Engine (lib/story-engine/)
â”‚       â”‚
â”‚       â”œâ”€â”€ ğŸ“ story.engine.ts (Main Story Processor)
â”‚       â”‚   â”œâ”€â”€ generateQuestion() â”€â”€â–¶ Text Generation
â”‚       â”‚   â”œâ”€â”€ generateAnswer() â”€â”€â–¶ Answer Formatting
â”‚       â”‚   â””â”€â”€ Operation Type Matching â”€â”€â–¶ Template Selection
â”‚       â”‚
â”‚       â””â”€â”€ ğŸ“ contexts/ (Story Context Generators)
â”‚           â””â”€â”€ money.context.ts â”€â”€â–¶ Money Scenarios
â”‚
â”œâ”€â”€ ğŸ§ª Testing Interface (app/test/page.tsx)
â”‚   â”œâ”€â”€ Model Selection UI
â”‚   â”œâ”€â”€ Parameter Controls
â”‚   â”œâ”€â”€ Real-time Generation
â”‚   â””â”€â”€ Question Preview
â”‚
â”œâ”€â”€ ğŸ“Š Status Tracking (lib/models/model-status.ts)
â”‚   â””â”€â”€ MODEL_STATUS_REGISTRY â”€â”€â–¶ Completion Tracking
â”‚
â””â”€â”€ ğŸ¯ Curriculum Integration (lib/curriculum/)
    â”œâ”€â”€ curriculum-parser.ts â”€â”€â–¶ UK Curriculum Data
    â”œâ”€â”€ curriculum-model-mapping.ts â”€â”€â–¶ Curriculum â†” Model Links
    â””â”€â”€ national_curriculum_framework.json â”€â”€â–¶ Raw Curriculum Data
```

---

## âš™ï¸ Individual Model Architecture

### Model Structure Pattern
All 18 mathematical models follow this standardized interface:

```typescript
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    INDIVIDUAL MODEL STRUCTURE                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  export class ExampleModel implements MathModel {               â”‚
â”‚                                                                 â”‚
â”‚    // 1. DIFFICULTY PARAMETERS                                  â”‚
â”‚    getDefaultParams(year: number) {                             â”‚
â”‚      return DifficultyPresets.getPreset('EXAMPLE', year);       â”‚
â”‚    }                                                            â”‚
â”‚                                                                 â”‚
â”‚    // 2. CORE GENERATION LOGIC                                  â”‚
â”‚    generate(params: ExampleParams): ExampleOutput {             â”‚
â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚      â”‚  Step 1: Generate Random Values        â”‚               â”‚
â”‚      â”‚  - Use params.max_value                 â”‚               â”‚
â”‚      â”‚  - Apply year-level constraints         â”‚               â”‚
â”‚      â”‚  - Ensure educational appropriateness   â”‚               â”‚
â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                            â”‚                                   â”‚
â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚      â”‚  Step 2: Perform Mathematics            â”‚               â”‚
â”‚      â”‚  - Execute core operation               â”‚               â”‚
â”‚      â”‚  - Handle edge cases                    â”‚               â”‚
â”‚      â”‚  - Generate working steps               â”‚               â”‚
â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                            â”‚                                   â”‚
â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚      â”‚  Step 3: Format Outputs                 â”‚               â”‚
â”‚      â”‚  - Create decimal representations       â”‚               â”‚
â”‚      â”‚  - Generate multiple answer formats     â”‚               â”‚
â”‚      â”‚  - Structure return object              â”‚               â”‚
â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                            â”‚                                   â”‚
â”‚                            â–¼                                   â”‚
â”‚      return {                                                  â”‚
â”‚        operation: 'EXAMPLE',                                   â”‚
â”‚        inputs: [...],                                          â”‚
â”‚        result: number,                                         â”‚
â”‚        decimal_formatted: {...},                               â”‚
â”‚        working: [...],                                         â”‚
â”‚        difficulty_level: number                                â”‚
â”‚      };                                                        â”‚
â”‚    }                                                           â”‚
â”‚  }                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Example Model Flow: ADDITION
```
INPUT PARAMETERS          PROCESSING STEPS              OUTPUT STRUCTURE
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ {               â”‚       â”‚ 1. Generate     â”‚          â”‚ {               â”‚
â”‚   max_value: 50,â”‚  â”€â”€â”€â”€â–¶â”‚    Random Nums  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚   operation:    â”‚
â”‚   min_value: 1, â”‚       â”‚    [12, 8]      â”‚          â”‚   "ADDITION",   â”‚
â”‚   decimal_      â”‚       â”‚                 â”‚          â”‚   operands:     â”‚
â”‚   places: 0,    â”‚       â”‚ 2. Add Numbers  â”‚          â”‚   [12, 8],      â”‚
â”‚   operands: 2   â”‚       â”‚    12 + 8 = 20  â”‚          â”‚   result: 20,   â”‚
â”‚ }               â”‚       â”‚                 â”‚          â”‚   working: [    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚ 3. Format       â”‚          â”‚     "12 + 8",   â”‚
                          â”‚    "12.00" +    â”‚          â”‚     "= 20"      â”‚
                          â”‚    "8.00" =     â”‚          â”‚   ],            â”‚
                          â”‚    "20.00"      â”‚          â”‚   decimal_      â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚   formatted: {  â”‚
                                                       â”‚     operands:   â”‚
                                                       â”‚     ["12.00",   â”‚
                                                       â”‚      "8.00"],   â”‚
                                                       â”‚     result:     â”‚
                                                       â”‚     "20.00"     â”‚
                                                       â”‚   }             â”‚
                                                       â”‚ }               â”‚
                                                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ­ Story Engine Template System

### Template Matching Logic
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    STORY TEMPLATE SELECTION                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  Math Output Analysis:                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚  â”‚ operation:      â”‚ â”€â”€â”€â”€â–¶â”‚ Template Router â”‚                  â”‚
â”‚  â”‚ "ADDITION"      â”‚      â”‚                 â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚ if isAddition() â”‚                  â”‚
â”‚                           â”‚   return        â”‚                  â”‚
â”‚                           â”‚   generateAdd   â”‚                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚   Question()    â”‚                  â”‚
â”‚  â”‚ context:        â”‚ â”€â”€â”€â”€â–¶â”‚                 â”‚                  â”‚
â”‚  â”‚ {               â”‚      â”‚ Templates:      â”‚                  â”‚
â”‚  â”‚   unit_type:    â”‚      â”‚ â€¢ Shopping      â”‚                  â”‚
â”‚  â”‚   "currency",   â”‚      â”‚ â€¢ Generic Math  â”‚                  â”‚
â”‚  â”‚   person:       â”‚      â”‚ â€¢ Measurement   â”‚                  â”‚
â”‚  â”‚   "Sarah"       â”‚      â”‚ â€¢ Time-based    â”‚                  â”‚
â”‚  â”‚ }               â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚                           â”‚
â”‚                                    â–¼                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚           TEMPLATE EXECUTION                â”‚               â”‚
â”‚  â”‚                                             â”‚               â”‚
â”‚  â”‚  Currency + Addition = Shopping Template:   â”‚               â”‚
â”‚  â”‚                                             â”‚               â”‚
â”‚  â”‚  `${person} goes to the shop and buys      â”‚               â”‚
â”‚  â”‚   ${purchases.join(', ')}. How much does   â”‚               â”‚
â”‚  â”‚   ${person} spend in total?`               â”‚               â”‚
â”‚  â”‚                                             â”‚               â”‚
â”‚  â”‚  Variable Substitution:                     â”‚               â”‚
â”‚  â”‚  â€¢ person â”€â”€â–¶ "Sarah"                       â”‚               â”‚
â”‚  â”‚  â€¢ purchases â”€â”€â–¶ ["apple for Â£12", "pen    â”‚               â”‚
â”‚  â”‚                   for Â£8"]                  â”‚               â”‚
â”‚  â”‚                                             â”‚               â”‚
â”‚  â”‚  Result:                                    â”‚               â”‚
â”‚  â”‚  "Sarah goes to the shop and buys an       â”‚               â”‚
â”‚  â”‚   apple for Â£12.00 and a pen for Â£8.00.    â”‚               â”‚
â”‚  â”‚   How much does Sarah spend in total?"      â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Context Generation System
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     CONTEXT GENERATION                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  MoneyContextGenerator.generate("ADDITION"):                    â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚  â”‚ Random Elements â”‚    â”‚  Context Object â”‚                    â”‚
â”‚  â”‚                 â”‚    â”‚                 â”‚                    â”‚
â”‚  â”‚ â€¢ Person: from  â”‚â”€â”€â”€â–¶â”‚ {               â”‚                    â”‚
â”‚  â”‚   ["Sarah",     â”‚    â”‚   unit_type:    â”‚                    â”‚
â”‚  â”‚    "Tom",       â”‚    â”‚   "currency",   â”‚                    â”‚
â”‚  â”‚    "Emma"]      â”‚    â”‚   unit_symbol:  â”‚                    â”‚
â”‚  â”‚                 â”‚    â”‚   "Â£",          â”‚                    â”‚
â”‚  â”‚ â€¢ Items: from   â”‚    â”‚   person:       â”‚                    â”‚
â”‚  â”‚   ["apple",     â”‚    â”‚   "Sarah",      â”‚                    â”‚
â”‚  â”‚    "pen",       â”‚    â”‚   item_         â”‚                    â”‚
â”‚  â”‚    "book"]      â”‚    â”‚   descriptors:  â”‚                    â”‚
â”‚  â”‚                 â”‚    â”‚   ["apple",     â”‚                    â”‚
â”‚  â”‚ â€¢ Scenario:     â”‚    â”‚    "pen"],      â”‚                    â”‚
â”‚  â”‚   "shopping"    â”‚    â”‚   scenario_     â”‚                    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚   type:         â”‚                    â”‚
â”‚                         â”‚   "shopping"    â”‚                    â”‚
â”‚                         â”‚ }               â”‚                    â”‚
â”‚                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ Testing and Development Flow

### Web Interface Integration (`/test`)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      TESTING INTERFACE                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  User Interaction:                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚  â”‚ 1. Select Model â”‚â”€â”€â”€â–¶â”‚ 2. Choose Year  â”‚                    â”‚
â”‚  â”‚   "ADDITION"    â”‚    â”‚    Level: 4     â”‚                    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚           â”‚                       â”‚                            â”‚
â”‚           â–¼                       â–¼                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚  â”‚ 3. Adjust       â”‚    â”‚ 4. Generate     â”‚                    â”‚
â”‚  â”‚   Parameters    â”‚â”€â”€â”€â–¶â”‚   Question      â”‚                    â”‚
â”‚  â”‚   max_value: 50 â”‚    â”‚                 â”‚                    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚                                   â”‚                            â”‚
â”‚                                   â–¼                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚           API CALL TO /api/generate         â”‚               â”‚
â”‚  â”‚                                             â”‚               â”‚
â”‚  â”‚  POST {                                     â”‚               â”‚
â”‚  â”‚    model_id: "ADDITION",                    â”‚               â”‚
â”‚  â”‚    year_level: 4,                           â”‚               â”‚
â”‚  â”‚    difficulty_params: {                     â”‚               â”‚
â”‚  â”‚      max_value: 50,                         â”‚               â”‚
â”‚  â”‚      min_value: 1,                          â”‚               â”‚
â”‚  â”‚      decimal_places: 0                      â”‚               â”‚
â”‚  â”‚    },                                       â”‚               â”‚
â”‚  â”‚    context_type: "money"                    â”‚               â”‚
â”‚  â”‚  }                                          â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                   â”‚                            â”‚
â”‚                                   â–¼                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚              UI DISPLAY                     â”‚               â”‚
â”‚  â”‚                                             â”‚               â”‚
â”‚  â”‚  Question: "Sarah goes to the shop..."      â”‚               â”‚
â”‚  â”‚  Answer: "Â£20.00" (Hidden until revealed)   â”‚               â”‚
â”‚  â”‚  Debug Info: Math output, context, timing   â”‚               â”‚
â”‚  â”‚  History: Previous 5 generated questions    â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ Model Status Integration

### Registry-Based Status Tracking
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MODEL STATUS SYSTEM                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  MODEL_STATUS_REGISTRY (lib/models/model-status.ts):           â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚  â”‚ ADDITION: {     â”‚    â”‚ Status Icons:   â”‚                    â”‚
â”‚  â”‚   status:       â”‚â”€â”€â”€â–¶â”‚ âœ… COMPLETE     â”‚                    â”‚
â”‚  â”‚   "complete",   â”‚    â”‚ ğŸš§ WIP          â”‚                    â”‚
â”‚  â”‚   years: [1-6], â”‚    â”‚ âŒ BROKEN       â”‚                    â”‚
â”‚  â”‚   curriculum:   â”‚    â”‚ ğŸ“‹ PLANNED      â”‚                    â”‚
â”‚  â”‚   [...areas]    â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚  â”‚ }               â”‚                                           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚           â”‚             â”‚ Testing UI      â”‚                    â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ Shows status    â”‚                    â”‚
â”‚                         â”‚ per model       â”‚                    â”‚
â”‚                         â”‚ Color coding    â”‚                    â”‚
â”‚                         â”‚ Issue tracking  â”‚                    â”‚
â”‚                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚                                                                 â”‚
â”‚  Integration Points:                                            â”‚
â”‚  â€¢ Test Interface â”€â”€â–¶ Filters by status                        â”‚
â”‚  â€¢ API Validation â”€â”€â–¶ Blocks broken models (optional)          â”‚
â”‚  â€¢ Documentation â”€â”€â–¶ Auto-generates status reports             â”‚
â”‚  â€¢ CI/CD Pipeline â”€â”€â–¶ Tracks completion progress               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸš€ Curriculum Integration Flow

### UK National Curriculum Mapping
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CURRICULUM INTEGRATION                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  Data Flow:                                                     â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚  â”‚ Raw Curriculum  â”‚â”€â”€â”€â–¶â”‚ Curriculum      â”‚                    â”‚
â”‚  â”‚ JSON Data       â”‚    â”‚ Parser          â”‚                    â”‚
â”‚  â”‚                 â”‚    â”‚                 â”‚                    â”‚
â”‚  â”‚ 174 distinct    â”‚    â”‚ â€¢ getStrands()  â”‚                    â”‚
â”‚  â”‚ requirements    â”‚    â”‚ â€¢ getSubstrands â”‚                    â”‚
â”‚  â”‚ across 9        â”‚    â”‚ â€¢ getYearContentâ”‚                    â”‚
â”‚  â”‚ strands         â”‚    â”‚ â€¢ searchBy      â”‚                    â”‚
â”‚  â”‚                 â”‚    â”‚   Keywords()    â”‚                    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚                                   â”‚                            â”‚
â”‚                                   â–¼                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚  â”‚ Model-Curriculumâ”‚â”€â”€â”€â–¶â”‚ Test Interface  â”‚                    â”‚
â”‚  â”‚ Mapping         â”‚    â”‚ Curriculum Mode â”‚                    â”‚
â”‚  â”‚                 â”‚    â”‚                 â”‚                    â”‚
â”‚  â”‚ â€¢ Direct maps   â”‚    â”‚ 1. Select       â”‚                    â”‚
â”‚  â”‚ â€¢ Keyword maps  â”‚    â”‚    Strand       â”‚                    â”‚
â”‚  â”‚ â€¢ Suggested     â”‚    â”‚ 2. Pick         â”‚                    â”‚
â”‚  â”‚   models per    â”‚    â”‚    Substrand    â”‚                    â”‚
â”‚  â”‚   curriculum    â”‚    â”‚ 3. Choose Year  â”‚                    â”‚
â”‚  â”‚   area          â”‚    â”‚ 4. Get suggestedâ”‚                    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    models       â”‚                    â”‚
â”‚                         â”‚ 5. Generate     â”‚                    â”‚
â”‚                         â”‚    aligned      â”‚                    â”‚
â”‚                         â”‚    questions    â”‚                    â”‚
â”‚                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ Development and Extension Guidelines

### Adding a New Model
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    NEW MODEL CREATION FLOW                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  Step 1: Create Model File                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ lib/math-engine/models/your-model.model.ts                 â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚ â€¢ Implement MathModel interface                             â”‚ â”‚
â”‚  â”‚ â€¢ Define parameter types                                    â”‚ â”‚
â”‚  â”‚ â€¢ Create generate() method                                  â”‚ â”‚
â”‚  â”‚ â€¢ Add getDefaultParams() method                             â”‚ â”‚
â”‚  â”‚ â€¢ Follow naming conventions                                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                â”‚                                â”‚
â”‚                                â–¼                                â”‚
â”‚  Step 2: Register Model                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ lib/math-engine/index.ts                                    â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚ â€¢ Import your model                                         â”‚ â”‚
â”‚  â”‚ â€¢ Add to mathModels registry                                â”‚ â”‚
â”‚  â”‚ â€¢ Export model class                                        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                â”‚                                â”‚
â”‚                                â–¼                                â”‚
â”‚  Step 3: Add Story Templates                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ lib/story-engine/story.engine.ts                            â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚ â€¢ Add operation detection                                   â”‚ â”‚
â”‚  â”‚ â€¢ Create question generation method                         â”‚ â”‚
â”‚  â”‚ â€¢ Create answer generation method                           â”‚ â”‚
â”‚  â”‚ â€¢ Handle different context types                            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                â”‚                                â”‚
â”‚                                â–¼                                â”‚
â”‚  Step 4: Update Status Registry                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ lib/models/model-status.ts                                  â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚ â€¢ Add model entry to MODEL_STATUS_REGISTRY                  â”‚ â”‚
â”‚  â”‚ â€¢ Define curriculum areas                                   â”‚ â”‚
â”‚  â”‚ â€¢ Set initial status (WIP)                                  â”‚ â”‚
â”‚  â”‚ â€¢ Add supported years                                       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                â”‚                                â”‚
â”‚                                â–¼                                â”‚
â”‚  Step 5: Test and Validate                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Use /test interface to:                                     â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚ â€¢ Test model generation                                     â”‚ â”‚
â”‚  â”‚ â€¢ Validate parameters                                       â”‚ â”‚
â”‚  â”‚ â€¢ Check question quality                                    â”‚ â”‚
â”‚  â”‚ â€¢ Verify curriculum alignment                               â”‚ â”‚
â”‚  â”‚ â€¢ Update status to COMPLETE                                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“‹ Key Integration Points Summary

| **Component** | **File** | **Primary Function** | **Integration** |
|---------------|----------|---------------------|-----------------|
| **API Layer** | `app/api/generate/route.ts` | Request handling | Orchestrates entire flow |
| **Math Engine** | `lib/math-engine/index.ts` | Model registry | Routes to specific models |
| **Individual Models** | `lib/math-engine/models/*.ts` | Number generation | Pure mathematical logic |
| **Story Engine** | `lib/story-engine/story.engine.ts` | Text generation | Wraps math in narratives |
| **Context System** | `lib/story-engine/contexts/*.ts` | Scenario creation | Provides story variables |
| **Test Interface** | `app/test/page.tsx` | Development UI | Real-time model testing |
| **Status Registry** | `lib/models/model-status.ts` | Completion tracking | Progress monitoring |
| **Curriculum Data** | `context/national_curriculum_framework.json` | UK standards | Educational alignment |
| **Curriculum Parser** | `lib/curriculum/curriculum-parser.ts` | Data processing | Structured access to standards |
| **Curriculum Mapping** | `lib/curriculum/curriculum-model-mapping.ts` | Model suggestions | Links models to standards |

---

## ğŸ¯ Quick Navigation Links

- **API Endpoint:** [`app/api/generate/route.ts`](app/api/generate/route.ts)
- **Math Engine:** [`lib/math-engine/index.ts`](lib/math-engine/index.ts)  
- **Story Engine:** [`lib/story-engine/story.engine.ts`](lib/story-engine/story.engine.ts)
- **Test Interface:** [`app/test/page.tsx`](app/test/page.tsx)
- **Model Registry:** [`lib/models/model-status.ts`](lib/models/model-status.ts)
- **Implementation Guide:** [`FACTORY_MODEL_IMPLEMENTATION_GUIDE.md`](FACTORY_MODEL_IMPLEMENTATION_GUIDE.md)

---

*This flow chart provides a complete technical overview of how Factory Architect's modular architecture creates contextual mathematical questions through the separation of mathematical logic and narrative storytelling.*